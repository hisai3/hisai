<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>一条咸鱼</title>
  
  
  <link href="https://hisai3.github.io/hisai3.github.io/atom.xml" rel="self"/>
  
  <link href="https://hisai3.github.io/hisai3.github.io/"/>
  <updated>2023-02-03T07:10:36.290Z</updated>
  <id>https://hisai3.github.io/hisai3.github.io/</id>
  
  <author>
    <name>一条咸鱼</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>大文件上传</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/02/03/%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/02/03/%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</id>
    <published>2023-02-03T06:31:31.000Z</published>
    <updated>2023-02-03T07:10:36.290Z</updated>
    
    <content type="html"><![CDATA[<h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><p>服务端需要负责接受这些切片，并在接收到所有切片后<code>合并</code>切片</p><p>这里又引伸出两个问题</p><ol><li>何时合并切片，即切片什么时候传输完成</li><li>如何合并切片</li></ol><p>第一个问题需要前端进行配合，前端在每个切片中都携带切片最大数量的信息，当服务端接受到这个数量的切片时自动合并，也可以额外发一个请求主动通知服务端进行切片的合并</p><p>第二个问题，具体如何合并切片呢？这里可以使用 nodejs 的 读写流（readStream&#x2F;writeStream），将所有切片的流传输到最终文件的流里</p><p><code>talk is cheap,show me the code</code>，接着我们用代码实现上面的思路</p><h2 id="前端部分"><a href="#前端部分" class="headerlink" title="前端部分"></a>前端部分</h2><p>前端使用 Vue 作为开发框架，对界面没有太大要求，原生也可以，考虑到美观使用 element-ui 作为 UI 框架</p><h3 id="上传控件"><a href="#上传控件" class="headerlink" title="上传控件"></a>上传控件</h3><p>首先创建选择文件的控件，监听 change 事件以及上传按钮</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;handleFileChange&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleUpload&quot;</span>&gt;</span>上传<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">container</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">file</span>: <span class="literal">null</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">     <span class="title function_">handleFileChange</span>(<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> [file] = e.<span class="property">target</span>.<span class="property">files</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (!file) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="variable language_">this</span>.<span class="property">$data</span>, <span class="variable language_">this</span>.<span class="property">$options</span>.<span class="title function_">data</span>());</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span> = file;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2020/1/7/16f7ff98adb6bcdd?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><h3 id="请求逻辑"><a href="#请求逻辑" class="headerlink" title="请求逻辑"></a>请求逻辑</h3><p>考虑到通用性，这里没有用第三方的请求库，而是用原生 XMLHttpRequest 做一层简单的封装来发请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">request</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">      url,</span></span><br><span class="line"><span class="params">      method = <span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="params">      data,</span></span><br><span class="line"><span class="params">      headers = &#123;&#125;,</span></span><br><span class="line"><span class="params">      requestList</span></span><br><span class="line"><span class="params">    &#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(method, url);</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(headers).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span></span><br><span class="line">          xhr.<span class="title function_">setRequestHeader</span>(key, headers[key])</span><br><span class="line">        );</span><br><span class="line">        xhr.<span class="title function_">send</span>(data);</span><br><span class="line">        xhr.<span class="property">onload</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">resolve</span>(&#123;</span><br><span class="line">            <span class="attr">data</span>: e.<span class="property">target</span>.<span class="property">response</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="上传切片"><a href="#上传切片" class="headerlink" title="上传切片"></a>上传切片</h3><p>接着实现比较重要的上传功能，上传需要做两件事</p><ul><li>对文件进行切片</li><li>将切片传输给服务端</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;handleFileChange&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleUpload&quot;</span>&gt;</span>上传<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+ <span class="keyword">const</span> <span class="variable constant_">SIZE</span> = <span class="number">10</span> * <span class="number">1024</span> * <span class="number">1024</span>; <span class="comment">// 切片大小</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">container</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">file</span>: <span class="literal">null</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;，</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+   <span class="attr">data</span>: []</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">request</span>(<span class="params"></span>) &#123;&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleFileChange</span>(<span class="params"></span>) &#123;&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    <span class="comment">// 生成文件切片</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    <span class="title function_">createFileChunk</span>(<span class="params">file, size = SIZE</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+     <span class="keyword">const</span> fileChunkList = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">let</span> cur = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">while</span> (cur &lt; file.<span class="property">size</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        fileChunkList.<span class="title function_">push</span>(&#123; <span class="attr">file</span>: file.<span class="title function_">slice</span>(cur, cur + size) &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        cur += size;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">return</span> fileChunkList;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+   <span class="comment">// 上传切片</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    <span class="keyword">async</span> <span class="title function_">uploadChunks</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">const</span> requestList = <span class="variable language_">this</span>.<span class="property">data</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        .<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; chunk，hash &#125;</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          formData.<span class="title function_">append</span>(<span class="string">&quot;chunk&quot;</span>, chunk);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          formData.<span class="title function_">append</span>(<span class="string">&quot;hash&quot;</span>, hash);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          formData.<span class="title function_">append</span>(<span class="string">&quot;filename&quot;</span>, <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          <span class="keyword">return</span> &#123; formData &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        .<span class="title function_">map</span>(<span class="keyword">async</span> (&#123; formData &#125;) =&gt;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          <span class="variable language_">this</span>.<span class="title function_">request</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+            <span class="attr">url</span>: <span class="string">&quot;http://localhost:3000&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+            <span class="attr">data</span>: formData</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+          &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        );</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(requestList); <span class="comment">// 并发切片</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">const</span> fileChunkList = <span class="variable language_">this</span>.<span class="title function_">createFileChunk</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="variable language_">this</span>.<span class="property">data</span> = fileChunkList.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; file &#125;，index</span>) =&gt;</span> (&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        <span class="attr">chunk</span>: file,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+        <span class="attr">hash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span> + <span class="string">&quot;-&quot;</span> + index <span class="comment">// 文件名 + 数组下标</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      &#125;));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">+    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>当点击上传按钮时，调用 <code>createFileChunk</code> 将文件切片，切片数量通过文件大小控制，这里设置 10MB，也就是说 100 MB 的文件会被分成 10 个切片</p><p>createFileChunk 内使用 while 循环和 slice 方法将切片放入 <code>fileChunkList</code> 数组中返回</p><p>在生成文件切片时，需要给每个切片一个标识作为 hash，这里暂时使用<code>文件名 + 下标</code>，这样后端可以知道当前切片是第几个切片，用于之后的合并切片</p><p>随后调用 <code>uploadChunks</code> 上传所有的文件切片，将文件切片，切片 hash，以及文件名放入 FormData 中，再调用上一步的 <code>request</code> 函数返回一个 proimise，最后调用 Promise.all 并发上传所有的切片</p><h3 id="发送合并请求"><a href="#发送合并请求" class="headerlink" title="发送合并请求"></a>发送合并请求</h3><p>这里使用整体思路中提到的第二种合并切片的方式，即前端主动通知服务端进行合并，所以前端还需要额外发请求，服务端接受到这个请求时主动合并切片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; @change=&quot;handleFileChange&quot; /&gt;</span><br><span class="line">    &lt;el-button @click=&quot;handleUpload&quot;&gt;上传&lt;/el-button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data: () =&gt; (&#123;</span><br><span class="line">    container: &#123;</span><br><span class="line">      file: null</span><br><span class="line">    &#125;,</span><br><span class="line">    data: []</span><br><span class="line">  &#125;),</span><br><span class="line">  methods: &#123;</span><br><span class="line">    request() &#123;&#125;,</span><br><span class="line">    handleFileChange() &#123;&#125;,</span><br><span class="line">    createFileChunk() &#123;&#125;,</span><br><span class="line">    // 上传切片，同时过滤已上传的切片</span><br><span class="line">    async uploadChunks() &#123;</span><br><span class="line">      const requestList = this.data</span><br><span class="line">        .map((&#123; chunk，hash &#125;) =&gt; &#123;</span><br><span class="line">          const formData = new FormData();</span><br><span class="line">          formData.append(&quot;chunk&quot;, chunk);</span><br><span class="line">          formData.append(&quot;hash&quot;, hash);</span><br><span class="line">          formData.append(&quot;filename&quot;, this.container.file.name);</span><br><span class="line">          return &#123; formData &#125;;</span><br><span class="line">        &#125;)</span><br><span class="line">        .map(async (&#123; formData &#125;) =&gt;</span><br><span class="line">          this.request(&#123;</span><br><span class="line">            url: &quot;http://localhost:3000&quot;,</span><br><span class="line">            data: formData</span><br><span class="line">          &#125;)</span><br><span class="line">        );</span><br><span class="line">      await Promise.all(requestList);</span><br><span class="line">+      // 合并切片</span><br><span class="line">+     await this.mergeRequest();</span><br><span class="line">    &#125;,</span><br><span class="line">+    async mergeRequest() &#123;</span><br><span class="line">+      await this.request(&#123;</span><br><span class="line">+        url: &quot;http://localhost:3000/merge&quot;,</span><br><span class="line">+        headers: &#123;</span><br><span class="line">+          &quot;content-type&quot;: &quot;application/json&quot;</span><br><span class="line">+        &#125;,</span><br><span class="line">+        data: JSON.stringify(&#123;</span><br><span class="line">+          filename: this.container.file.name</span><br><span class="line">+        &#125;)</span><br><span class="line">+      &#125;);</span><br><span class="line">+    &#125;,    </span><br><span class="line">    async handleUpload() &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="服务端部分"><a href="#服务端部分" class="headerlink" title="服务端部分"></a>服务端部分</h2><p>简单使用 http 模块搭建服务端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const http = require(&quot;http&quot;);</span><br><span class="line">const server = http.createServer();</span><br><span class="line"></span><br><span class="line">server.on(&quot;request&quot;, async (req, res) =&gt; &#123;</span><br><span class="line">  res.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</span><br><span class="line">  res.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;*&quot;);</span><br><span class="line">  if (req.method === &quot;OPTIONS&quot;) &#123;</span><br><span class="line">    res.status = 200;</span><br><span class="line">    res.end();</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(3000, () =&gt; console.log(&quot;正在监听 3000 端口&quot;));</span><br></pre></td></tr></table></figure><h3 id="接受切片"><a href="#接受切片" class="headerlink" title="接受切片"></a>接受切片</h3><p>使用 <code>multiparty</code> 包处理前端传来的 FormData</p><p>在 multiparty.parse 的回调中，files 参数保存了 FormData 中文件，fields 参数保存了 FormData 中非文件的字段</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fse = <span class="built_in">require</span>(<span class="string">&quot;fs-extra&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> multiparty = <span class="built_in">require</span>(<span class="string">&quot;multiparty&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>();</span><br><span class="line">+ <span class="keyword">const</span> <span class="variable constant_">UPLOAD_DIR</span> = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;target&quot;</span>); <span class="comment">// 大文件存储目录</span></span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;OPTIONS&quot;</span>) &#123;</span><br><span class="line">    res.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">    res.<span class="title function_">end</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">+  <span class="keyword">const</span> multipart = <span class="keyword">new</span> multiparty.<span class="title class_">Form</span>();</span><br><span class="line"></span><br><span class="line">+  multipart.<span class="title function_">parse</span>(req, <span class="keyword">async</span> (err, fields, files) =&gt; &#123;</span><br><span class="line">+    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">+      <span class="keyword">return</span>;</span><br><span class="line">+    &#125;</span><br><span class="line">+    <span class="keyword">const</span> [chunk] = files.<span class="property">chunk</span>;</span><br><span class="line">+    <span class="keyword">const</span> [hash] = fields.<span class="property">hash</span>;</span><br><span class="line">+    <span class="keyword">const</span> [filename] = fields.<span class="property">filename</span>;</span><br><span class="line">+    <span class="keyword">const</span> chunkDir = path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, filename);</span><br><span class="line"></span><br><span class="line">+   <span class="comment">// 切片目录不存在，创建切片目录</span></span><br><span class="line">+    <span class="keyword">if</span> (!fse.<span class="title function_">existsSync</span>(chunkDir)) &#123;</span><br><span class="line">+      <span class="keyword">await</span> fse.<span class="title function_">mkdirs</span>(chunkDir);</span><br><span class="line">+    &#125;</span><br><span class="line"></span><br><span class="line">+      <span class="comment">// fs-extra 专用方法，类似 fs.rename 并且跨平台</span></span><br><span class="line">+      <span class="comment">// fs-extra 的 rename 方法 windows 平台会有权限问题</span></span><br><span class="line">+      <span class="comment">// https://github.com/meteor/meteor/issues/7852#issuecomment-255767835</span></span><br><span class="line">+      <span class="keyword">await</span> fse.<span class="title function_">move</span>(chunk.<span class="property">path</span>, <span class="string">`<span class="subst">$&#123;chunkDir&#125;</span>/<span class="subst">$&#123;hash&#125;</span>`</span>);</span><br><span class="line">+    res.<span class="title function_">end</span>(<span class="string">&quot;received file chunk&quot;</span>);</span><br><span class="line">+  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在监听 3000 端口&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2020/1/11/16f905fb6a626f47?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image-20200110215559194"></p><p>查看 multiparty 处理后的 chunk 对象，path 是存储临时文件的路径，size 是临时文件大小，在 multiparty 文档中提到可以使用 fs.rename(由于我用的是 fs-extra，它的 rename 方法 windows 平台权限问题，所以换成了 fse.move) 移动临时文件，即移动文件切片</p><p>在接受文件切片时，需要先创建存储切片的文件夹，由于前端在发送每个切片时额外携带了唯一值 hash，所以以 hash 作为文件名，将切片从临时路径移动切片文件夹中，最后的结果如下</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f83c3caac8eb65?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><h3 id="合并切片"><a href="#合并切片" class="headerlink" title="合并切片"></a>合并切片</h3><p>在接收到前端发送的合并请求后，服务端将文件夹下的所有切片进行合并</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fse = <span class="built_in">require</span>(<span class="string">&quot;fs-extra&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPLOAD_DIR</span> = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;target&quot;</span>); <span class="comment">// 大文件存储目录</span></span><br><span class="line"></span><br><span class="line">+ <span class="keyword">const</span> <span class="title function_">resolvePost</span> = req =&gt;</span><br><span class="line">+   <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">+     <span class="keyword">let</span> chunk = <span class="string">&quot;&quot;</span>;</span><br><span class="line">+     req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">+       chunk += data;</span><br><span class="line">+     &#125;);</span><br><span class="line">+     req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">+       <span class="title function_">resolve</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(chunk));</span><br><span class="line">+     &#125;);</span><br><span class="line">+   &#125;);</span><br><span class="line"></span><br><span class="line">+ <span class="keyword">const</span> <span class="title function_">pipeStream</span> = (<span class="params">path, writeStream</span>) =&gt;</span><br><span class="line">+  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">+    <span class="keyword">const</span> readStream = fse.<span class="title function_">createReadStream</span>(path);</span><br><span class="line">+    readStream.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">+      fse.<span class="title function_">unlinkSync</span>(path);</span><br><span class="line">+      <span class="title function_">resolve</span>();</span><br><span class="line">+    &#125;);</span><br><span class="line">+    readStream.<span class="title function_">pipe</span>(writeStream);</span><br><span class="line">+  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 合并切片</span></span><br><span class="line">+ <span class="keyword">const</span> <span class="title function_">mergeFileChunk</span> = <span class="keyword">async</span> (<span class="params">filePath, filename, size</span>) =&gt; &#123;</span><br><span class="line">+  <span class="keyword">const</span> chunkDir = path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, filename);</span><br><span class="line">+  <span class="keyword">const</span> chunkPaths = <span class="keyword">await</span> fse.<span class="title function_">readdir</span>(chunkDir);</span><br><span class="line">+  <span class="comment">// 根据切片下标进行排序</span></span><br><span class="line">+  <span class="comment">// 否则直接读取目录的获得的顺序可能会错乱</span></span><br><span class="line">+  chunkPaths.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>)[<span class="number">1</span>] - b.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">+  <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">+    chunkPaths.<span class="title function_">map</span>(<span class="function">(<span class="params">chunkPath, index</span>) =&gt;</span></span><br><span class="line">+      <span class="title function_">pipeStream</span>(</span><br><span class="line">+        path.<span class="title function_">resolve</span>(chunkDir, chunkPath),</span><br><span class="line">+        <span class="comment">// 指定位置创建可写流</span></span><br><span class="line">+        fse.<span class="title function_">createWriteStream</span>(filePath, &#123;</span><br><span class="line">+          <span class="attr">start</span>: index * size,</span><br><span class="line">+          <span class="attr">end</span>: (index + <span class="number">1</span>) * size</span><br><span class="line">+        &#125;)</span><br><span class="line">+      )</span><br><span class="line">+    )</span><br><span class="line">+  );</span><br><span class="line">+  fse.<span class="title function_">rmdirSync</span>(chunkDir); <span class="comment">// 合并后删除保存切片的目录</span></span><br><span class="line">+&#125;;</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;OPTIONS&quot;</span>) &#123;</span><br><span class="line">    res.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">    res.<span class="title function_">end</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">+   <span class="keyword">if</span> (req.<span class="property">url</span> === <span class="string">&quot;/merge&quot;</span>) &#123;</span><br><span class="line">+     <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">resolvePost</span>(req);</span><br><span class="line">+     <span class="keyword">const</span> &#123; filename,size &#125; = data;</span><br><span class="line">+     <span class="keyword">const</span> filePath = path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, <span class="string">`<span class="subst">$&#123;filename&#125;</span>`</span>);</span><br><span class="line">+     <span class="keyword">await</span> <span class="title function_">mergeFileChunk</span>(filePath, filename);</span><br><span class="line">+     res.<span class="title function_">end</span>(</span><br><span class="line">+       <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">+         <span class="attr">code</span>: <span class="number">0</span>,</span><br><span class="line">+         <span class="attr">message</span>: <span class="string">&quot;file merged success&quot;</span></span><br><span class="line">+       &#125;)</span><br><span class="line">+     );</span><br><span class="line">+   &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在监听 3000 端口&quot;</span>));</span><br></pre></td></tr></table></figure><p>由于前端在发送合并请求时会携带文件名，服务端根据文件名可以找到上一步创建的切片文件夹</p><p>接着使用 fs.createWriteStream 创建一个可写流，可写流文件名就是<strong>切片文件夹名 + 后缀名</strong>组合而成</p><p>随后遍历整个切片文件夹，将切片通过 fs.createReadStream 创建可读流，传输合并到目标文件中</p><p>值得注意的是每次可读流都会传输到可写流的指定位置，这是通过 createWriteStream 的第二个参数 start&#x2F;end 控制的，目的是能够并发合并多个可读流到可写流中，这样即使流的顺序不同也能传输到正确的位置，所以这里还需要让前端在请求的时候多提供一个 size 参数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">async</span> <span class="title function_">mergeRequest</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">request</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;http://localhost:3000/merge&quot;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">          <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">data</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">+         <span class="attr">size</span>: <span class="variable constant_">SIZE</span>,</span><br><span class="line">          <span class="attr">filename</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2020/1/22/16fccc5d950c2275?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>其实也可以等上一个切片合并完后再合并下个切片，这样就不需要指定位置，但传输速度会降低，所以使用了并发合并的手段，接着只要保证每次合并完成后删除这个切片，等所有切片都合并完毕后最后删除切片文件夹即可</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f8414c7fae1c1f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>至此一个简单的大文件上传就完成了，接下来我们再此基础上扩展一些额外的功能</p><h2 id="显示上传进度条"><a href="#显示上传进度条" class="headerlink" title="显示上传进度条"></a>显示上传进度条</h2><p>上传进度分两种，一个是每个切片的上传进度，另一个是整个文件的上传进度，而整个文件的上传进度是基于每个切片上传进度计算而来，所以我们先实现切片的上传进度</p><h3 id="切片进度条"><a href="#切片进度条" class="headerlink" title="切片进度条"></a>切片进度条</h3><p>XMLHttpRequest 原生支持上传进度的监听，只需要监听 upload.onprogress 即可，我们在原来的 request 基础上传入 onProgress 参数，给 XMLHttpRequest 注册监听事件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// xhr</span></span><br><span class="line">    <span class="title function_">request</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">      url,</span></span><br><span class="line"><span class="params">      method = <span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="params">      data,</span></span><br><span class="line"><span class="params">      headers = &#123;&#125;,</span></span><br><span class="line"><span class="params">+      onProgress = e =&gt; e,</span></span><br><span class="line"><span class="params">      requestList</span></span><br><span class="line"><span class="params">    &#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">+       xhr.<span class="property">upload</span>.<span class="property">onprogress</span> = onProgress;</span><br><span class="line">        xhr.<span class="title function_">open</span>(method, url);</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(headers).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span></span><br><span class="line">          xhr.<span class="title function_">setRequestHeader</span>(key, headers[key])</span><br><span class="line">        );</span><br><span class="line">        xhr.<span class="title function_">send</span>(data);</span><br><span class="line">        xhr.<span class="property">onload</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">resolve</span>(&#123;</span><br><span class="line">            <span class="attr">data</span>: e.<span class="property">target</span>.<span class="property">response</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>由于每个切片都需要触发独立的监听事件，所以还需要一个工厂函数，根据传入的切片返回不同的监听函数</p><p>在原先的前端上传逻辑中新增监听函数部分</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">// 上传切片，同时过滤已上传的切片</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">uploadChunks</span>(<span class="params">uploadedList = []</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> requestList = <span class="variable language_">this</span>.<span class="property">data</span></span><br><span class="line">+       .<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; chunk,hash,index &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;chunk&quot;</span>, chunk);</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;hash&quot;</span>, hash);</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;filename&quot;</span>, <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>);</span><br><span class="line">+         <span class="keyword">return</span> &#123; formData,index &#125;;</span><br><span class="line">        &#125;)</span><br><span class="line">+       .<span class="title function_">map</span>(<span class="keyword">async</span> (&#123; formData,index &#125;) =&gt;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;http://localhost:3000&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: formData，</span><br><span class="line">+           <span class="attr">onProgress</span>: <span class="variable language_">this</span>.<span class="title function_">createProgressHandler</span>(<span class="variable language_">this</span>.<span class="property">data</span>[index]),</span><br><span class="line">          &#125;)</span><br><span class="line">        );</span><br><span class="line">      <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(requestList);</span><br><span class="line">       <span class="comment">// 合并切片</span></span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">mergeRequest</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">const</span> fileChunkList = <span class="variable language_">this</span>.<span class="title function_">createFileChunk</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span> = fileChunkList.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; file &#125;，index</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">chunk</span>: file,</span><br><span class="line">+       index,</span><br><span class="line">        <span class="attr">hash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span> + <span class="string">&quot;-&quot;</span> + index</span><br><span class="line">+       <span class="attr">percentage</span>:<span class="number">0</span></span><br><span class="line">      &#125;));</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>();</span><br><span class="line">    &#125;    </span><br><span class="line">+   <span class="title function_">createProgressHandler</span>(<span class="params">item</span>) &#123;</span><br><span class="line">+      <span class="keyword">return</span> <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">+        item.<span class="property">percentage</span> = <span class="built_in">parseInt</span>(<span class="title class_">String</span>((e.<span class="property">loaded</span> / e.<span class="property">total</span>) * <span class="number">100</span>));</span><br><span class="line">+      &#125;;</span><br><span class="line">+    &#125;</span><br></pre></td></tr></table></figure><p>每个切片在上传时都会通过监听函数更新 data 数组对应元素的 percentage 属性，之后把将 data 数组放到视图中展示即可</p><h3 id="文件进度条"><a href="#文件进度条" class="headerlink" title="文件进度条"></a>文件进度条</h3><p>将每个切片已上传的部分累加，除以整个文件的大小，就能得出当前文件的上传进度，所以这里使用 Vue 计算属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attr">computed</span>: &#123;</span><br><span class="line">      <span class="title function_">uploadPercentage</span>(<span class="params"></span>) &#123;</span><br><span class="line">         <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span> || !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">length</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">         <span class="keyword">const</span> loaded = <span class="variable language_">this</span>.<span class="property">data</span></span><br><span class="line">           .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">size</span> * item.<span class="property">percentage</span>)</span><br><span class="line">           .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, cur</span>) =&gt;</span> acc + cur);</span><br><span class="line">         <span class="keyword">return</span> <span class="built_in">parseInt</span>((loaded / <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">size</span>).<span class="title function_">toFixed</span>(<span class="number">2</span>));</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终视图如下</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f84ad6b4848423?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><h1 id="断点续传"><a href="#断点续传" class="headerlink" title="断点续传"></a>断点续传</h1><p>断点续传的原理在于前端&#x2F;服务端需要<code>记住</code>已上传的切片，这样下次上传就可以跳过之前已上传的部分，有两种方案实现记忆的功能</p><ul><li>前端使用 localStorage 记录已上传的切片 hash</li><li>服务端保存已上传的切片 hash，前端每次上传前向服务端获取已上传的切片</li></ul><p>第一种是前端的解决方案，第二种是服务端，而前端方案有一个缺陷，如果换了个浏览器就失去了记忆的效果，所以这里选取后者</p><h2 id="生成-hash"><a href="#生成-hash" class="headerlink" title="生成 hash"></a>生成 hash</h2><p>无论是前端还是服务端，都必须要生成文件和切片的 hash，<code>之前我们使用文件名 + 切片下标作为切片 hash</code>，这样做文件名一旦修改就失去了效果，而事实上只要文件内容不变，hash 就不应该变化，所以正确的做法是<code>根据文件内容生成 hash</code>，所以我们修改一下 hash 的生成规则</p><p>这里用到另一个库 <code>spark-md5</code>，它可以根据文件内容计算出文件的 hash 值，另外考虑到如果上传一个超大文件，读取文件内容计算 hash 是非常耗费时间的，并且会<code>引起 UI 的阻塞</code>，导致页面假死状态，所以我们使用 web-worker 在 worker 线程计算 hash，这样用户仍可以在主界面正常的交互</p><p>由于实例化 web-worker 时，参数是一个 js 文件路径且不能跨域，所以我们单独创建一个 hash.js 文件放在 public 目录下，另外在 worker 中也是不允许访问 dom 的，但它提供了<code>importScripts</code> 函数用于导入外部脚本，通过它导入 spark-md5</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /public/hash.js</span></span><br><span class="line">self.<span class="title function_">importScripts</span>(<span class="string">&quot;/spark-md5.min.js&quot;</span>); <span class="comment">// 导入脚本</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成文件 hash</span></span><br><span class="line">self.<span class="property">onmessage</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; fileChunkList &#125; = e.<span class="property">data</span>;</span><br><span class="line">  <span class="keyword">const</span> spark = <span class="keyword">new</span> self.<span class="property">SparkMD5</span>.<span class="title class_">ArrayBuffer</span>();</span><br><span class="line">  <span class="keyword">let</span> percentage = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">loadNext</span> = index =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">    reader.<span class="title function_">readAsArrayBuffer</span>(fileChunkList[index].<span class="property">file</span>);</span><br><span class="line">    reader.<span class="property">onload</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">      count++;</span><br><span class="line">      spark.<span class="title function_">append</span>(e.<span class="property">target</span>.<span class="property">result</span>);</span><br><span class="line">      <span class="keyword">if</span> (count === fileChunkList.<span class="property">length</span>) &#123;</span><br><span class="line">        self.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">          <span class="attr">percentage</span>: <span class="number">100</span>,</span><br><span class="line">          <span class="attr">hash</span>: spark.<span class="title function_">end</span>()</span><br><span class="line">        &#125;);</span><br><span class="line">        self.<span class="title function_">close</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        percentage += <span class="number">100</span> / fileChunkList.<span class="property">length</span>;</span><br><span class="line">        self.<span class="title function_">postMessage</span>(&#123;</span><br><span class="line">          percentage</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 递归计算下一个切片</span></span><br><span class="line">        <span class="title function_">loadNext</span>(count);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">loadNext</span>(<span class="number">0</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在 worker 线程中，接受文件切片 fileChunkList，利用 FileReader 读取每个切片的 ArrayBuffer 并不断传入 spark-md5 中，每计算完一个切片通过 postMessage 向主线程发送一个进度事件，全部完成后将最终的 hash 发送给主线程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark-md5 需要根据所有切片才能算出一个 hash 值，不能直接将整个文件放入计算，否则即使不同文件也会有相同的 hash，具体可以看官方文档</span><br></pre></td></tr></table></figure><p><a href="https://www.npmjs.com/package/spark-md5">spark-md5</a></p><p>接着编写主线程与 worker 线程通讯的逻辑</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">+   <span class="comment">// 生成文件 hash（web-worker）</span></span><br><span class="line">+    <span class="title function_">calculateHash</span>(<span class="params">fileChunkList</span>) &#123;</span><br><span class="line">+      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">+       <span class="comment">// 添加 worker 属性</span></span><br><span class="line">+        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">worker</span> = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&quot;/hash.js&quot;</span>);</span><br><span class="line">+        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">worker</span>.<span class="title function_">postMessage</span>(&#123; fileChunkList &#125;);</span><br><span class="line">+        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">worker</span>.<span class="property">onmessage</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">+          <span class="keyword">const</span> &#123; percentage, hash &#125; = e.<span class="property">data</span>;</span><br><span class="line">+          <span class="variable language_">this</span>.<span class="property">hashPercentage</span> = percentage;</span><br><span class="line">+          <span class="keyword">if</span> (hash) &#123;</span><br><span class="line">+            <span class="title function_">resolve</span>(hash);</span><br><span class="line">+          &#125;</span><br><span class="line">+        &#125;;</span><br><span class="line">+      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">const</span> fileChunkList = <span class="variable language_">this</span>.<span class="title function_">createFileChunk</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>);</span><br><span class="line">+     <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">calculateHash</span>(fileChunkList);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span> = fileChunkList.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; file &#125;，index</span>) =&gt;</span> (&#123;</span><br><span class="line">+       <span class="attr">fileHash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span>,</span><br><span class="line">        <span class="attr">chunk</span>: file,</span><br><span class="line">        <span class="attr">hash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span> + <span class="string">&quot;-&quot;</span> + index, <span class="comment">// 文件名 + 数组下标</span></span><br><span class="line">        <span class="attr">percentage</span>:<span class="number">0</span></span><br><span class="line">      &#125;));</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>();</span><br><span class="line">    &#125;   </span><br></pre></td></tr></table></figure><p>主线程使用 <code>postMessage</code> 给 worker 线程传入所有切片 fileChunkList，并监听 worker 线程发出的 postMessage 事件拿到文件 hash</p><p>加上显示计算 hash 的进度条，看起来像这样</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f84ae4f233e891?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>至此前端需要将之前用文件名作为 hash 的地方改写为 workder 返回的这个 hash</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f84b3bba953304?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>服务端则使用 hash 作为切片文件夹名，hash + 下标作为切片名，hash + 扩展名作为文件名，没有新增的逻辑</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f84b50117e4db2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f84b33bbceaa48?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><h2 id="文件秒传"><a href="#文件秒传" class="headerlink" title="文件秒传"></a>文件秒传</h2><p>在实现断点续传前先简单介绍一下文件秒传</p><p>所谓的文件秒传，即在服务端已经存在了上传的资源，所以当用户<code>再次上传</code>时会直接提示上传成功</p><p>文件秒传需要依赖上一步生成的 hash，即在<code>上传前</code>，先计算出文件 hash，并把 hash 发送给服务端进行验证，由于 hash 的唯一性，所以一旦服务端能找到 hash 相同的文件，则直接返回上传成功的信息即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">+    <span class="keyword">async</span> <span class="title function_">verifyUpload</span>(<span class="params">filename, fileHash</span>) &#123;</span><br><span class="line">+       <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">request</span>(&#123;</span><br><span class="line">+         <span class="attr">url</span>: <span class="string">&quot;http://localhost:3000/verify&quot;</span>,</span><br><span class="line">+         <span class="attr">headers</span>: &#123;</span><br><span class="line">+           <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">+         &#125;,</span><br><span class="line">+         <span class="attr">data</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">+           filename,</span><br><span class="line">+           fileHash</span><br><span class="line">+         &#125;)</span><br><span class="line">+       &#125;);</span><br><span class="line">+       <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data);</span><br><span class="line">+     &#125;,</span><br><span class="line">   <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">const</span> fileChunkList = <span class="variable language_">this</span>.<span class="title function_">createFileChunk</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">calculateHash</span>(fileChunkList);</span><br><span class="line">+     <span class="keyword">const</span> &#123; shouldUpload &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">verifyUpload</span>(</span><br><span class="line">+       <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>,</span><br><span class="line">+       <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span></span><br><span class="line">+     );</span><br><span class="line">+     <span class="keyword">if</span> (!shouldUpload) &#123;</span><br><span class="line">+       <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;秒传：上传成功&quot;</span>);</span><br><span class="line">+       <span class="keyword">return</span>;</span><br><span class="line">+    &#125;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">data</span> = fileChunkList.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; file &#125;, index</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">fileHash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span>,</span><br><span class="line">        index,</span><br><span class="line">        <span class="attr">hash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> + <span class="string">&quot;-&quot;</span> + index,</span><br><span class="line">        <span class="attr">chunk</span>: file,</span><br><span class="line">        <span class="attr">percentage</span>: <span class="number">0</span></span><br><span class="line">      &#125;));</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>();</span><br><span class="line">    &#125;   </span><br></pre></td></tr></table></figure><p>秒传其实就是给用户看的障眼法，实质上根本没有上传</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/9/16f890e5967106c6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image-20200109143511277"></p><p>:)</p><p>服务端的逻辑非常简单，新增一个验证接口，验证文件是否存在即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="keyword">const</span> <span class="title function_">extractExt</span> = filename =&gt;</span><br><span class="line">+  filename.<span class="title function_">slice</span>(filename.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>), filename.<span class="property">length</span>); <span class="comment">// 提取后缀名</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPLOAD_DIR</span> = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;target&quot;</span>); <span class="comment">// 大文件存储目录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">resolvePost</span> = req =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> chunk = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      chunk += data;</span><br><span class="line">    &#125;);</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(chunk));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">url</span> === <span class="string">&quot;/verify&quot;</span>) &#123;</span><br><span class="line">+    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">resolvePost</span>(req);</span><br><span class="line">+    <span class="keyword">const</span> &#123; fileHash, filename &#125; = data;</span><br><span class="line">+    <span class="keyword">const</span> ext = <span class="title function_">extractExt</span>(filename);</span><br><span class="line">+    <span class="keyword">const</span> filePath = path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, <span class="string">`<span class="subst">$&#123;fileHash&#125;</span><span class="subst">$&#123;ext&#125;</span>`</span>);</span><br><span class="line">+    <span class="keyword">if</span> (fse.<span class="title function_">existsSync</span>(filePath)) &#123;</span><br><span class="line">+      res.<span class="title function_">end</span>(</span><br><span class="line">+        <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">+          <span class="attr">shouldUpload</span>: <span class="literal">false</span></span><br><span class="line">+        &#125;)</span><br><span class="line">+      );</span><br><span class="line">+    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">+      res.<span class="title function_">end</span>(</span><br><span class="line">+        <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">+          <span class="attr">shouldUpload</span>: <span class="literal">true</span></span><br><span class="line">+        &#125;)</span><br><span class="line">+      );</span><br><span class="line">+    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在监听 3000 端口&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="暂停上传"><a href="#暂停上传" class="headerlink" title="暂停上传"></a>暂停上传</h2><p>讲完了生成 hash 和文件秒传，回到断点续传</p><p>断点续传顾名思义即断点 + 续传，所以我们第一步先实现“断点”，也就是暂停上传</p><p>原理是使用 XMLHttpRequest 的 <code>abort</code> 方法，可以取消一个 xhr 请求的发送，为此我们需要将上传每个切片的 xhr 对象保存起来，我们再改造一下 request 方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">   <span class="title function_">request</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">      url,</span></span><br><span class="line"><span class="params">      method = <span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="params">      data,</span></span><br><span class="line"><span class="params">      headers = &#123;&#125;,</span></span><br><span class="line"><span class="params">      onProgress = e =&gt; e,</span></span><br><span class="line"><span class="params">+     requestList</span></span><br><span class="line"><span class="params">    &#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="property">upload</span>.<span class="property">onprogress</span> = onProgress;</span><br><span class="line">        xhr.<span class="title function_">open</span>(method, url);</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(headers).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span></span><br><span class="line">          xhr.<span class="title function_">setRequestHeader</span>(key, headers[key])</span><br><span class="line">        );</span><br><span class="line">        xhr.<span class="title function_">send</span>(data);</span><br><span class="line">        xhr.<span class="property">onload</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">+          <span class="comment">// 将请求成功的 xhr 从列表中删除</span></span><br><span class="line">+          <span class="keyword">if</span> (requestList) &#123;</span><br><span class="line">+            <span class="keyword">const</span> xhrIndex = requestList.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item === xhr);</span><br><span class="line">+            requestList.<span class="title function_">splice</span>(xhrIndex, <span class="number">1</span>);</span><br><span class="line">+          &#125;</span><br><span class="line">          <span class="title function_">resolve</span>(&#123;</span><br><span class="line">            <span class="attr">data</span>: e.<span class="property">target</span>.<span class="property">response</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">+        <span class="comment">// 暴露当前 xhr 给外部</span></span><br><span class="line">+        requestList?.<span class="title function_">push</span>(xhr);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>这样在上传切片时传入 requestList 数组作为参数，request 方法就会将所有的 xhr 保存在数组中了</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f8563491ea7793?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>每当一个切片上传成功时，将对应的 xhr 从 requestList 中删除，所以 requestList 中只保存<code>正在上传切片的 xhr</code></p><p>之后新建一个暂停按钮，当点击按钮时，调用保存在 requestList 中 xhr 的 abort 方法，即取消并清空所有正在上传的切片</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="title function_">handlePause</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">requestList</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">xhr</span> =&gt;</span> xhr?.<span class="title function_">abort</span>());</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">requestList</span> = [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2020/1/9/16f890e598dd6afb?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image-20200109143737924"></p><p>点击暂停按钮可以看到 xhr 都被取消了</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/8/16f85644dc27459e?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><h2 id="恢复上传"><a href="#恢复上传" class="headerlink" title="恢复上传"></a>恢复上传</h2><p>之前在介绍断点续传的时提到使用第二种服务端存储的方式实现续传</p><p>由于当文件切片上传后，服务端会建立一个文件夹存储所有上传的切片，所以每次前端上传前可以调用一个接口，服务端将已上传的切片的切片名返回，前端再跳过这些已经上传切片，这样就实现了“续传”的效果</p><p>而这个接口可以和之前秒传的验证接口合并，前端每次上传前发送一个验证的请求，返回两种结果</p><ul><li>服务端已存在该文件，不需要再次上传</li><li>服务端不存在该文件或者已上传部分文件切片，通知前端进行上传，并把<strong>已上传</strong>的文件切片返回给前端</li></ul><p>所以我们改造一下之前文件秒传的服务端验证接口</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">extractExt</span> = filename =&gt;</span><br><span class="line">  filename.<span class="title function_">slice</span>(filename.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>), filename.<span class="property">length</span>); <span class="comment">// 提取后缀名</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">UPLOAD_DIR</span> = path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;target&quot;</span>); <span class="comment">// 大文件存储目录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">resolvePost</span> = req =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> chunk = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      chunk += data;</span><br><span class="line">    &#125;);</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(chunk));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">+  <span class="comment">// 返回已经上传切片名列表</span></span><br><span class="line">+ <span class="keyword">const</span> <span class="title function_">createUploadedList</span> = <span class="keyword">async</span> fileHash =&gt;</span><br><span class="line">+   fse.<span class="title function_">existsSync</span>(path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, fileHash))</span><br><span class="line">+    ? <span class="keyword">await</span> fse.<span class="title function_">readdir</span>(path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, fileHash))</span><br><span class="line">+    : [];</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">url</span> === <span class="string">&quot;/verify&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">resolvePost</span>(req);</span><br><span class="line">    <span class="keyword">const</span> &#123; fileHash, filename &#125; = data;</span><br><span class="line">    <span class="keyword">const</span> ext = <span class="title function_">extractExt</span>(filename);</span><br><span class="line">    <span class="keyword">const</span> filePath = path.<span class="title function_">resolve</span>(<span class="variable constant_">UPLOAD_DIR</span>, <span class="string">`<span class="subst">$&#123;fileHash&#125;</span><span class="subst">$&#123;ext&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">if</span> (fse.<span class="title function_">existsSync</span>(filePath)) &#123;</span><br><span class="line">      res.<span class="title function_">end</span>(</span><br><span class="line">        <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">          <span class="attr">shouldUpload</span>: <span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">      );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">end</span>(</span><br><span class="line">        <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">          <span class="attr">shouldUpload</span>: <span class="literal">true</span>，</span><br><span class="line">+         <span class="attr">uploadedList</span>: <span class="keyword">await</span> <span class="title function_">createUploadedList</span>(fileHash)</span><br><span class="line">        &#125;)</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在监听 3000 端口&quot;</span>));</span><br></pre></td></tr></table></figure><p>接着回到前端，前端有两个地方需要调用验证的接口</p><ul><li>点击上传时，检查是否需要上传和已上传的切片</li><li>点击暂停后的恢复上传，返回已上传的切片</li></ul><p>新增恢复按钮并改造原来上传切片的逻辑</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;file&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        @<span class="attr">change</span>=<span class="string">&quot;handleFileChange&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleUpload&quot;</span>&gt;</span>上传<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handlePause&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;isPaused&quot;</span>&gt;</span>暂停<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">+      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleResume&quot;</span> <span class="attr">v-else</span>&gt;</span>恢复<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      //...</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">+   <span class="keyword">async</span> <span class="title function_">handleResume</span>(<span class="params"></span>) &#123;</span><br><span class="line">+      <span class="keyword">const</span> &#123; uploadedList &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">verifyUpload</span>(</span><br><span class="line">+        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>,</span><br><span class="line">+        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span></span><br><span class="line">+      );</span><br><span class="line">+      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>(uploadedList);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">const</span> fileChunkList = <span class="variable language_">this</span>.<span class="title function_">createFileChunk</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">calculateHash</span>(fileChunkList);</span><br><span class="line"></span><br><span class="line">+     <span class="keyword">const</span> &#123; shouldUpload, uploadedList &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">verifyUpload</span>(</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>,</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span></span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">if</span> (!shouldUpload) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;秒传：上传成功&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span> = fileChunkList.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; file &#125;, index</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">fileHash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span>,</span><br><span class="line">        index,</span><br><span class="line">        <span class="attr">hash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> + <span class="string">&quot;-&quot;</span> + index,</span><br><span class="line">        <span class="attr">chunk</span>: file，</span><br><span class="line">        <span class="attr">percentage</span>: <span class="number">0</span></span><br><span class="line">      &#125;));</span><br><span class="line"></span><br><span class="line">+      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>(uploadedList);</span><br><span class="line">    &#125;,</span><br><span class="line">   <span class="comment">// 上传切片，同时过滤已上传的切片</span></span><br><span class="line">+   <span class="keyword">async</span> <span class="title function_">uploadChunks</span>(<span class="params">uploadedList = []</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> requestList = <span class="variable language_">this</span>.<span class="property">data</span></span><br><span class="line">+        .<span class="title function_">filter</span>(<span class="function">(<span class="params">&#123; hash &#125;</span>) =&gt;</span> !uploadedList.<span class="title function_">includes</span>(hash))</span><br><span class="line">        .<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; chunk, hash, index &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;chunk&quot;</span>, chunk);</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;hash&quot;</span>, hash);</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;filename&quot;</span>, <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>);</span><br><span class="line">          formData.<span class="title function_">append</span>(<span class="string">&quot;fileHash&quot;</span>, <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span>);</span><br><span class="line">          <span class="keyword">return</span> &#123; formData, index &#125;;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">map</span>(<span class="keyword">async</span> (&#123; formData, index &#125;) =&gt;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">request</span>(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&quot;http://localhost:3000&quot;</span>,</span><br><span class="line">            <span class="attr">data</span>: formData,</span><br><span class="line">            <span class="attr">onProgress</span>: <span class="variable language_">this</span>.<span class="title function_">createProgressHandler</span>(<span class="variable language_">this</span>.<span class="property">data</span>[index]),</span><br><span class="line">            <span class="attr">requestList</span>: <span class="variable language_">this</span>.<span class="property">requestList</span></span><br><span class="line">          &#125;)</span><br><span class="line">        );</span><br><span class="line">      <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(requestList);</span><br><span class="line">      <span class="comment">// 之前上传的切片数量 + 本次上传的切片数量 = 所有切片数量时</span></span><br><span class="line">      <span class="comment">// 合并切片</span></span><br><span class="line">+      <span class="keyword">if</span> (uploadedList.<span class="property">length</span> + requestList.<span class="property">length</span> === <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">length</span>) &#123;</span><br><span class="line">         <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">mergeRequest</span>();</span><br><span class="line">+      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2020/1/9/16f890e598de0946?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image-20200109144331326"></p><p>这里给原来上传切片的函数新增 uploadedList 参数，即上图中服务端返回的切片名列表，通过 filter 过滤掉已上传的切片，并且由于新增了已上传的部分，所以之前合并接口的触发条件做了一些改动</p><p>到这里断点续传的功能基本完成了</p><h2 id="进度条改进"><a href="#进度条改进" class="headerlink" title="进度条改进"></a>进度条改进</h2><p>虽然实现了断点续传，但还需要修改一下进度条的显示规则，否则在暂停上传&#x2F;接收到已上传切片时的进度条会出现偏差</p><h3 id="切片进度条-1"><a href="#切片进度条-1" class="headerlink" title="切片进度条"></a>切片进度条</h3><p>由于在点击上传&#x2F;恢复上传时，会调用验证接口返回已上传的切片，所以需要将已上传切片的进度变成 100%</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">async</span> <span class="title function_">handleUpload</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="keyword">const</span> fileChunkList = <span class="variable language_">this</span>.<span class="title function_">createFileChunk</span>(<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">calculateHash</span>(fileChunkList);</span><br><span class="line">      <span class="keyword">const</span> &#123; shouldUpload, uploadedList &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">verifyUpload</span>(</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">name</span>,</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span></span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">if</span> (!shouldUpload) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;秒传：上传成功&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span> = fileChunkList.<span class="title function_">map</span>(<span class="function">(<span class="params">&#123; file &#125;, index</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">fileHash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span>,</span><br><span class="line">        index,</span><br><span class="line">        <span class="attr">hash</span>: <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">hash</span> + <span class="string">&quot;-&quot;</span> + index,</span><br><span class="line">        <span class="attr">chunk</span>: file,</span><br><span class="line">+       <span class="attr">percentage</span>: uploadedList.<span class="title function_">includes</span>(index) ? <span class="number">100</span> : <span class="number">0</span></span><br><span class="line">      &#125;));</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">uploadChunks</span>(uploadedList);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>uploadedList 会返回已上传的切片，在遍历所有切片时判断当前切片是否在已上传列表里即可</p><h3 id="文件进度条-1"><a href="#文件进度条-1" class="headerlink" title="文件进度条"></a>文件进度条</h3><p>之前说到文件进度条是一个计算属性，根据所有切片的上传进度计算而来，这就遇到了一个问题</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/9/16f8845dcca1427c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>点击暂停会取消并清空切片的 xhr 请求，此时如果已经上传了一部分，就会发现文件进度条有<code>倒退</code>的现象</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/9/16f884633f3acfd9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>当点击恢复时，由于重新创建了 xhr 导致切片进度清零，所以总进度条就会倒退</p><p>解决方案是创建一个“假”的进度条，这个假进度条基于文件进度条，但只会停止和增加，然后给用户展示这个假的进度条</p><p>这里我们使用 Vue 的监听属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">  <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">+    <span class="attr">fakeUploadPercentage</span>: <span class="number">0</span></span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">uploadPercentage</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span> || !<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">length</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">const</span> loaded = <span class="variable language_">this</span>.<span class="property">data</span></span><br><span class="line">        .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">size</span> * item.<span class="property">percentage</span>)</span><br><span class="line">        .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, cur</span>) =&gt;</span> acc + cur);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">parseInt</span>((loaded / <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">file</span>.<span class="property">size</span>).<span class="title function_">toFixed</span>(<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="attr">watch</span>: &#123;</span><br><span class="line">+    <span class="title function_">uploadPercentage</span>(<span class="params">now</span>) &#123;</span><br><span class="line">+      <span class="keyword">if</span> (now &gt; <span class="variable language_">this</span>.<span class="property">fakeUploadPercentage</span>) &#123;</span><br><span class="line">+        <span class="variable language_">this</span>.<span class="property">fakeUploadPercentage</span> = now;</span><br><span class="line">+      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>当 uploadPercentage 即真的文件进度条增加时，fakeUploadPercentage 也增加，一旦文件进度条后退，假的进度条只需停止即可</p><p>至此一个大文件上传 + 断点续传的解决方案就完成了</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>大文件上传</p><ul><li>前端上传大文件时使用 Blob.prototype.slice 将文件切片，并发上传多个切片，最后发送一个合并的请求通知服务端合并切片</li><li>服务端接收切片并存储，收到合并请求后使用流将切片合并到最终文件</li><li>原生 XMLHttpRequest 的 upload.onprogress 对切片上传进度的监听</li><li>使用 Vue 计算属性根据每个切片的进度算出整个文件的上传进度</li></ul><p>断点续传</p><ul><li>使用 spark-md5 根据文件内容算出文件 hash</li><li>通过 hash 可以判断服务端是否已经上传该文件，从而直接提示用户上传成功（秒传）</li><li>通过 XMLHttpRequest 的 abort 方法暂停切片的上传</li><li>上传前服务端返回已经上传的切片名，前端跳过这些切片的上传</li></ul><hr><p><strong>原文来自<a href="https://juejin.cn/post/6844904046436843527">yeyan1996</a></strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;服务端&quot;&gt;&lt;a href=&quot;#服务端&quot; class=&quot;headerlink&quot; title=&quot;服务端&quot;&gt;&lt;/a&gt;服务端&lt;/h3&gt;&lt;p&gt;服务端需要负责接受这些切片，并在接收到所有切片后&lt;code&gt;合并&lt;/code&gt;切片&lt;/p&gt;
&lt;p&gt;这里又引伸出两个问题&lt;/p&gt;
&lt;o</summary>
      
    
    
    
    <category term="小功能" scheme="https://hisai3.github.io/hisai3.github.io/categories/%E5%B0%8F%E5%8A%9F%E8%83%BD/"/>
    
    
    <category term="javascript" scheme="https://hisai3.github.io/hisai3.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>dependencies和devDependencies的区别</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/31/dependencies%E5%92%8CdevDependencies%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/31/dependencies%E5%92%8CdevDependencies%E7%9A%84%E5%8C%BA%E5%88%AB/</id>
    <published>2023-01-31T03:21:31.000Z</published>
    <updated>2023-02-03T06:05:04.579Z</updated>
    
    <content type="html"><![CDATA[<ul><li>dependencies：项目依赖。在编码阶段和呈现页面阶段都需要的，也就是说，项目依赖即在开发环境中，又在生产环境中。如js框架vue、页面路由vue-router，各种ui框架antd、element-ui、vant等。</li><li>devDependencies: 开发依赖。仅仅在写代码过程中需要使用，比如css预处理器、vue-cli脚手架、eslint之类。</li><li>后面部分为–save -dev 的情况会使得下载的插件放在package.json文件的devDpendencies对象里面</li><li>后面部分为–save的情况会使得下载的插件放在package.json文件的dependencies对象里面</li></ul><p>区别</p><ul><li>devDependencies下的依赖包，只是我们在本地或开发坏境下运行代码所依赖的，若发到线上，其实就不需要devDependencies下的所有依赖包；(比如各种loader，babel全家桶及各种webpack的插件等)只用于开发环境，不用于生产环境，因此不需要打包；</li><li>dependencies是我们线上(生产坏境)下所要依赖的包，比如vue，我们线上时必须要使用的，所以要放在dependencies下；dependencies依赖的包不仅开发环境能使用，生产环境也能使用</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;dependencies：项目依赖。在编码阶段和呈现页面阶段都需要的，也就是说，项目依赖即在开发环境中，又在生产环境中。如js框架vue、页面路由vue-router，各种ui框架antd、element-ui、vant等。&lt;/li&gt;
&lt;li&gt;devDepend</summary>
      
    
    
    
    
    <category term="npm" scheme="https://hisai3.github.io/hisai3.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>自定义组件库，本地调试 + 发布到npm</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/31/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E5%BA%93%EF%BC%8C%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%20+%20%E5%8F%91%E5%B8%83%E5%88%B0npm/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/31/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E5%BA%93%EF%BC%8C%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%20+%20%E5%8F%91%E5%B8%83%E5%88%B0npm/</id>
    <published>2023-01-31T02:21:31.000Z</published>
    <updated>2023-01-31T06:05:26.692Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、-建立一个用来打包编译的工程plugin-generator-system"><a href="#一、-建立一个用来打包编译的工程plugin-generator-system" class="headerlink" title="一、 建立一个用来打包编译的工程plugin-generator-system"></a>一、 建立一个用来打包编译的工程plugin-generator-system</h2><ol><li><strong>安装脚手架</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save vue-cli</span><br></pre></td></tr></table></figure><ol start="2"><li><p>新建 <strong>plugin-generator-system</strong> 文件夹</p></li><li><p><strong>初始化工程</strong></p></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack-simple</span><br></pre></td></tr></table></figure><p>生成的工程目录如下：</p><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/simple-init-mulu.png" alt="simple-init-mulu"></p><ol start="4"><li>安装依赖</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i</span><br></pre></td></tr></table></figure><h2 id="二、新建一个组件，并修改相关配置"><a href="#二、新建一个组件，并修改相关配置" class="headerlink" title="二、新建一个组件，并修改相关配置"></a>二、新建一个组件，并修改相关配置</h2><p>在 <strong>src</strong> 下新建 <strong>hello.vue</strong> 和 <strong>index.js</strong> </p><p><code>hello.vue</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;hello-template&quot;&gt;</span><br><span class="line">    hello world, this is plugin pack, user is &#123;&#123; user &#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;hello&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    user: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.hello-template &#123;</span><br><span class="line">  color: chocolate;</span><br><span class="line">  font-size: medium;</span><br><span class="line">  font-family: Consolas;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><code>index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Hello</span> <span class="keyword">from</span> <span class="string">&#x27;./hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> components = &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">Vue, options</span>) &#123;</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;hzHello&#x27;</span>, <span class="title class_">Hello</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">Vue</span>) &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">Vue</span>.<span class="title function_">use</span>(components)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> components</span><br></pre></td></tr></table></figure><p>修改<strong>package.json</strong>和<strong>webpack.config.js</strong>文件</p><p><code>package.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;plugin-generator-system&quot;</span><span class="punctuation">,</span> <span class="comment">// 发布的模块名称，发布线上后，可以通过npm install xx来引用该模块，一般Vue组件以vue-开头</span></span><br><span class="line"><span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.1&quot;</span><span class="punctuation">,</span> <span class="comment">// 更新时需要修改版本号</span></span><br><span class="line"><span class="attr">&quot;private&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// 打包后的入口文件，若不配置，则在其他项目中就无法使用import xx from &#x27;包名&#x27;来引入组件，只能以包名作为起点来指定相对路径</span></span><br><span class="line"><span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dist/hz-components-ui.min.js&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="attr">&quot;files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;dist&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;hz-compontents&quot;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p><code>webpack.config.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">entry</span>: <span class="string">&#x27;./src/lib/index.js&#x27;</span>,</span><br><span class="line"><span class="attr">output</span>: &#123;</span><br><span class="line">   <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./dist&#x27;</span>),</span><br><span class="line">   <span class="attr">publicPath</span>: <span class="string">&#x27;/dist/&#x27;</span>,</span><br><span class="line">   <span class="attr">filename</span>: <span class="string">&#x27;hz-components-ui.min.js&#x27;</span>, <span class="comment">// 生成的文件名</span></span><br><span class="line">   <span class="attr">library</span>: <span class="string">&#x27;hzComponentsUi&#x27;</span>, <span class="comment">// 指定使用require时的模块名，此处就是require(&#x27;helloWord&#x27;)</span></span><br><span class="line">   <span class="attr">libraryTarget</span>: <span class="string">&#x27;umd&#x27;</span>, <span class="comment">// 指定不同的umd代码</span></span><br><span class="line">   <span class="attr">umdNamedDefine</span>: <span class="literal">true</span> <span class="comment">// 对umd的构建过程中的amd模块进行命名</span></span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure><h2 id="三、-编译打包输出"><a href="#三、-编译打包输出" class="headerlink" title="三、 编译打包输出"></a>三、 编译打包输出</h2><ol><li><p><strong>npm run build</strong></p></li><li><p><strong>npm pack</strong></p></li></ol><p>结果如下：</p><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/simple-init-build.png" alt="simple-init-build"></p><h2 id="四、-在其他项目中使用上一步输出的包plugin-generator-system-1-0-0-tgz"><a href="#四、-在其他项目中使用上一步输出的包plugin-generator-system-1-0-0-tgz" class="headerlink" title="四、 在其他项目中使用上一步输出的包plugin-generator-system-1.0.0.tgz"></a>四、 在其他项目中使用上一步输出的包plugin-generator-system-1.0.0.tgz</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i F:\Code\plugin-generator-system\plugin-generator-system-1.0.0.tgz</span><br></pre></td></tr></table></figure><p>安装成功后，<strong>node_modules</strong>和<strong>package.js</strong>会发生改变：</p><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/simple-init-plugin.png" alt="simple-init-plugin"></p><ol><li>main.js中引入</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> components <span class="keyword">from</span> <span class="string">&#x27;plugin-generator-system&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(components)</span><br></pre></td></tr></table></figure><ol start="2"><li>页面中使用</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hz-hello</span> <span class="attr">user</span>=<span class="string">&quot;hahahaha&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">hz-hello</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="五、-最后的效果"><a href="#五、-最后的效果" class="headerlink" title="五、 最后的效果"></a>五、 最后的效果</h2><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/simple-init-res.png" alt="simple-init-res"></p><h2 id="六-本地开发调式组件"><a href="#六-本地开发调式组件" class="headerlink" title="六. 本地开发调式组件"></a>六. 本地开发调式组件</h2><p>修改<strong>webpack.config</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将组件打包配置抽离</span></span><br><span class="line"><span class="keyword">const</span> proConfig = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/lib/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./dist&#x27;</span>),</span><br><span class="line">    <span class="attr">publicPath</span>: <span class="string">&#x27;/dist/&#x27;</span>,</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;hz-components-ui.min.js&#x27;</span>,</span><br><span class="line">    <span class="attr">library</span>: <span class="string">&#x27;hzComponentsUi&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;umd&#x27;</span>,</span><br><span class="line">    <span class="attr">umdNamedDefine</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据环境使用</span></span><br><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    ...<span class="variable language_">module</span>.<span class="property">exports</span>,</span><br><span class="line">    ...proConfig</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="七、-发布到npm"><a href="#七、-发布到npm" class="headerlink" title="七、 发布到npm"></a>七、 发布到npm</h2><ol><li><strong>新建文件 .npmignore 写入一些不必要上传的文件名称</strong></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">node_modules/</span><br><span class="line">examples/</span><br><span class="line">public/</span><br><span class="line">packages/</span><br><span class="line">vue.config.js</span><br><span class="line">babel.config.js</span><br><span class="line">*.map</span><br><span class="line">*.html</span><br><span class="line"> </span><br><span class="line"># local env files</span><br><span class="line">.env.local</span><br><span class="line">.env.*.local</span><br><span class="line"> </span><br><span class="line"># Log files</span><br><span class="line">npm-debug.log*</span><br><span class="line">yarn-debug.log*</span><br><span class="line">yarn-error.log*</span><br><span class="line"> </span><br><span class="line"># Editor directories and files</span><br><span class="line">.idea</span><br><span class="line">.vscode</span><br><span class="line">*.suo</span><br><span class="line">*.ntvs*</span><br><span class="line">*.njsproj</span><br><span class="line">*.sln</span><br><span class="line">*.sw*</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>打包编译</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>确认npm镜像 是否为发布 <a href="https://registry.npmjs.org/">https://registry.npmjs.org/</a></strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm get registry</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npmjs.org/</span><br></pre></td></tr></table></figure><p>淘宝镜像 <a href="http://registry.npm.taobao.org/">http://registry.npm.taobao.org/</a> </p><ol start="4"><li><strong>登录npm</strong></li></ol><blockquote><p>登录时需要邮箱验证</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm login</span><br></pre></td></tr></table></figure><ol start="5"><li><strong>发布</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish</span><br></pre></td></tr></table></figure><h2 id="八、-发布报错"><a href="#八、-发布报错" class="headerlink" title="八、 发布报错"></a>八、 发布报错</h2><ul><li><strong>原因：包重名</strong></li></ul><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/simple-init-npmerror.png" alt="simple-init-npmerror"></p><ul><li><strong>解决 ：</strong></li></ul><p>修改 <strong>package.json</strong> 重新 <code>npm publish</code> 即可</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cus-components&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><ul><li>之后即可在项目中正常使用 <code> npm install cus-components</code> 下载使用组件</li></ul><div class="note warning flat"><p><strong>(注意要引入时的包名也要修改)</strong> </p></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、-建立一个用来打包编译的工程plugin-generator-system&quot;&gt;&lt;a href=&quot;#一、-建立一个用来打包编译的工程plugin-generator-system&quot; class=&quot;headerlink&quot; title=&quot;一、 建立一个用来打包编译的</summary>
      
    
    
    
    <category term="webpack" scheme="https://hisai3.github.io/hisai3.github.io/categories/webpack/"/>
    
    
    <category term="webpack" scheme="https://hisai3.github.io/hisai3.github.io/tags/webpack/"/>
    
    <category term="vue" scheme="https://hisai3.github.io/hisai3.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>HEXO 搭建博客</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/HEXO%20%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/HEXO%20%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/</id>
    <published>2023-01-14T06:55:31.000Z</published>
    <updated>2023-02-03T06:06:32.542Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Butterfly主题修改"><a href="#Butterfly主题修改" class="headerlink" title="Butterfly主题修改"></a><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly主题</a>修改</h3><ol><li>在目录<code>theme</code>中下载 <a href="https://hexo.io/themes/">hexo主题</a>  <a href="https://zhuanlan.zhihu.com/p/491537945">推荐主题</a></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/jerryc127/hexo-theme-butterfly.git</span><br></pre></td></tr></table></figure><ol start="2"><li>修改站点配置文件<code>_config.yml</code>, 把主题修改为 <code>hexo-theme-butterfly</code> 安装的主题文件名（注意theme: 要有空格隔开）</li></ol><p>更改主题后启动服务器，界面显如下字符:</p><p><code>extends includes/layout.pug block content include includes/recent-posts.pug include includes/partial</code></p><p><strong>执行如下命令</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-renderer-jade hexo-generator-feed hexo-generator-sitemap hexo-browsersync hexo-generator-archive</span><br></pre></td></tr></table></figure><p>清除缓存</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br></pre></td></tr></table></figure><p>生成静态文件即可</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><h3 id="配置修改"><a href="#配置修改" class="headerlink" title="配置修改"></a>配置修改</h3><ul><li><p><a href="https://sanshui.vip/2022/12/06/butterfly%E4%B8%BB%E9%A2%98%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE3/">三水个人博客-自定义样式</a></p></li><li><p><a href="https://www.guole.fun/posts/butterfly-custom/#%E6%96%87%E7%AB%A0%E7%B4%A0%E6%9D%90">Guo Le-自定义样式</a></p></li><li><p><a href="https://blog.csdn.net/qq_38157825/article/details/112783083">Butterfly主题安装文档(三)之主题配置2</a></p></li></ul><p><strong>网页背景渐变</strong> 可以直接在配置文件 <code>hexo-theme-butterfly</code> 中设置 <code>background </code> </p><ul><li>纯渐变</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(</span><br><span class="line">    <span class="number">0deg</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">247</span>, <span class="number">149</span>, <span class="number">51</span>, <span class="number">0.1</span>) <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">243</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">0.1</span>) <span class="number">15%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">239</span>, <span class="number">78</span>, <span class="number">123</span>, <span class="number">0.1</span>) <span class="number">30%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">161</span>, <span class="number">102</span>, <span class="number">171</span>, <span class="number">0.1</span>) <span class="number">44%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">80</span>, <span class="number">115</span>, <span class="number">184</span>, <span class="number">0.1</span>) <span class="number">58%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">16</span>, <span class="number">152</span>, <span class="number">173</span>, <span class="number">0.1</span>) <span class="number">72%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">7</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">0.1</span>) <span class="number">86%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">109</span>, <span class="number">186</span>, <span class="number">130</span>, <span class="number">0.1</span>) <span class="number">100%</span></span><br><span class="line">  );</span><br></pre></td></tr></table></figure><ul><li>背景加渐变</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;https://ae01.alicdn.com/kf/H5662031fbf344418aa2c8bf74c68826eV.png&#x27;</span>),</span><br><span class="line">    <span class="built_in">-moz-linear-gradient</span>(<span class="number">45deg</span>, <span class="number">#6dd0f2</span> <span class="number">15%</span>, <span class="number">#f59abe</span> <span class="number">85%</span>);</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;https://ae01.alicdn.com/kf/H5662031fbf344418aa2c8bf74c68826eV.png&#x27;</span>),</span><br><span class="line">    <span class="built_in">-webkit-linear-gradient</span>(<span class="number">45deg</span>, <span class="number">#6dd0f2</span> <span class="number">15%</span>, <span class="number">#f59abe</span> <span class="number">85%</span>);</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;https://ae01.alicdn.com/kf/H5662031fbf344418aa2c8bf74c68826eV.png&#x27;</span>),</span><br><span class="line">    <span class="built_in">-ms-linear-gradient</span>(<span class="number">45deg</span>, <span class="number">#6dd0f2</span> <span class="number">15%</span>, <span class="number">#f59abe</span> <span class="number">85%</span>);</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;https://ae01.alicdn.com/kf/H5662031fbf344418aa2c8bf74c68826eV.png&#x27;</span>),</span><br><span class="line">    <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, <span class="number">#6dd0f2</span> <span class="number">15%</span>, <span class="number">#f59abe</span> <span class="number">85%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;https://ae01.alicdn.com/kf/H18a4b998752a4ae68b8e85d432a5aef0l.png&#x27;</span>),</span><br><span class="line">    <span class="built_in">linear-gradient</span>(</span><br><span class="line">      <span class="number">60deg</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">165</span>, <span class="number">150</span>, <span class="number">0.5</span>) <span class="number">5%</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">228</span>, <span class="number">255</span>, <span class="number">0.35</span>)</span><br><span class="line">    ),</span><br><span class="line">    <span class="built_in">url</span>(<span class="string">&#x27;https://ae01.alicdn.com/kf/H21b5f6b8496141a1979a33666e1074d9x.jpg&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="自定义样式"><a href="#自定义样式" class="headerlink" title="自定义样式"></a>自定义样式</h3><h4 id="新建-custom-css-放在-public-css-文件中-网上都是放到主题包中的-source-css-但没法打包到-public-中"><a href="#新建-custom-css-放在-public-css-文件中-网上都是放到主题包中的-source-css-但没法打包到-public-中" class="headerlink" title="新建 custom.css  放在 public/css 文件中 !! (网上都是放到主题包中的 source/css, 但没法打包到 public 中)"></a>新建 <code>custom.css</code>  放在 <code>public/css</code> 文件中 !! (<strong>网上都是放到主题包中的 <code>source/css</code>, 但没法打包到 <code>public</code> 中</strong>)</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.layout_post</span> &gt; <span class="selector-id">#post</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#aside_content</span> <span class="selector-class">.card-widget</span>,</span><br><span class="line"><span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span>,</span><br><span class="line"><span class="selector-class">.layout_page</span>&gt;<span class="selector-tag">div</span><span class="selector-pseudo">:first</span>-child<span class="selector-pseudo">:not</span>(<span class="selector-class">.recent-posts</span>),</span><br><span class="line"><span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#page</span>,</span><br><span class="line"><span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#post</span>,</span><br><span class="line"><span class="selector-class">.read-mode</span> <span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#post</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--card-bg</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.8</span>);</span><br><span class="line">  <span class="attr">--card-hover-box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">8px</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">7</span>,<span class="number">17</span>,<span class="number">27</span>,<span class="number">0.2</span>);</span><br><span class="line">  <span class="attr">--guole-main</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> &#123;</span><br><span class="line">  <span class="attr">--card-bg</span>: <span class="built_in">rgba</span>(<span class="number">13</span>,<span class="number">13</span>,<span class="number">13</span>,<span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#footer</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h1</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ef50a8</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h2</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fb7061</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h3</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffbf00</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h4</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#a9e000</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h5</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#57c850</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h6</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#5ec1e0</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h2</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h3</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h4</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h5</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h6</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">animation</span>: ccc <span class="number">1.6s</span> linear infinite;</span><br><span class="line">  <span class="attribute">animation</span>: ccc <span class="number">1.6s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 代码块样式 */</span></span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">7px</span>;</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">10px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">144</span>,<span class="number">164</span>,<span class="number">174</span>,<span class="number">0.4</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">10px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">144</span>,<span class="number">164</span>,<span class="number">174</span>,<span class="number">0.4</span>);</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span> <span class="selector-class">.highlight-tools</span> <span class="selector-class">.code-lang</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">75px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span> <span class="selector-class">.highlight-tools</span> <span class="selector-class">.expand</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span> <span class="selector-class">.highlight-tools</span> <span class="selector-class">.expand</span> ~ <span class="selector-class">.copy-button</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">2.1em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#article-container</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span> <span class="selector-class">.highlight-tools</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fc625d</span>;</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">20px</span> <span class="number">0</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0</span> <span class="number">#35cd4b</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">20px</span> <span class="number">0</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0</span> <span class="number">#35cd4b</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 目录-当前节点 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-id">#card-toc</span> <span class="selector-class">.toc-content</span> <span class="selector-class">.toc-link</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--guole-main);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-moz-keyframes</span> ccc &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> ccc &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-o-keyframes</span> ccc &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> ccc &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">1turn</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在 <code>hexo-theme-butterfly.yml</code>  中 <code>inject</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/hisai/css/custom.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h4 id="解决-custom-css-无法自动打包到-public中"><a href="#解决-custom-css-无法自动打包到-public中" class="headerlink" title="解决 custom.css 无法自动打包到 public中"></a>解决 <code>custom.css</code> 无法自动打包到 <code>public</code>中</h4><ul><li>新建 <code>themes\hexo-theme-butterfly\source\css\custom.styl</code></li><li>将 <code>custom.css</code> 转 <code>custom.styl</code>   <a href="https://www.zhangxinxu.com/jq/stylus/keyframes.php">css转stylus在线工具</a> (转换可能不太准，要确认一下<a href="https://www.stylus-lang.cn/docs/keyframes.html">stylus语法</a>) </li><li>在 <code>source\css\index</code> 中加上  @import ‘custom’</li><li>可以不用在 inject</li></ul><p>转换后的样式 <code>custom.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文章页背景</span></span><br><span class="line"><span class="selector-class">.layout_post</span></span><br><span class="line">  &amp; &gt; <span class="selector-id">#post</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">8</span>)</span><br><span class="line"><span class="comment">// 所有页面背景</span></span><br><span class="line"><span class="selector-id">#aside_content</span> <span class="selector-class">.card-widget</span>,</span><br><span class="line">#recent-posts&gt;<span class="selector-class">.recent-post-item</span>,</span><br><span class="line">.layout_page&gt;<span class="selector-tag">div</span><span class="selector-pseudo">:first-child</span><span class="selector-pseudo">:not</span>(.recent-posts),</span><br><span class="line">.layout_post&gt;<span class="selector-id">#page</span>,</span><br><span class="line">.layout_post&gt;<span class="selector-id">#post</span>,</span><br><span class="line"><span class="selector-class">.read-mode</span> .layout_post&gt;<span class="selector-id">#post</span></span><br><span class="line">  <span class="attribute">background</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 侧边卡片的透明度</span></span><br><span class="line"><span class="selector-pseudo">:root</span></span><br><span class="line">  <span class="attr">--card-bg</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">8</span>)</span><br><span class="line">  <span class="attr">--card-hover-box-shadow</span> <span class="number">0</span> <span class="number">3px</span> <span class="number">8px</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">7</span>, <span class="number">17</span>, <span class="number">27</span>, <span class="number">0.2</span>)</span><br><span class="line">  <span class="attr">--guole-main</span> <span class="number">#49b1f5</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span></span><br><span class="line">  <span class="attr">--card-bg</span> <span class="built_in">rgba</span>(<span class="number">13</span>, <span class="number">13</span>, <span class="number">13</span>, .<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页脚透明</span></span><br><span class="line"><span class="selector-id">#footer</span></span><br><span class="line">  <span class="attribute">background</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文章页H1-H6图标样式效果</span></span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h1</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ef50a8</span> ;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h2</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fb7061</span> ;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h3</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffbf00</span> ;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h4</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#a9e000</span> ;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h5</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#57c850</span> ;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line"><span class="selector-id">#content-inner</span><span class="selector-class">.layout</span> <span class="selector-tag">h6</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#5ec1e0</span> ;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">1.55rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">0.23rem</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 小风车旋转</span></span><br><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h2</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h3</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h4</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h5</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">h6</span><span class="selector-pseudo">::before</span></span><br><span class="line">  -webkit-<span class="attribute">animation</span> ccc <span class="number">1.6s</span> linear infinite</span><br><span class="line">  <span class="attribute">animation</span> ccc <span class="number">1.6s</span> linear infinite</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 代码块样式 */</span></span><br><span class="line"><span class="selector-id">#article-container</span></span><br><span class="line">  <span class="selector-tag">figure</span></span><br><span class="line">    &amp;<span class="selector-class">.highlight</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">7px</span></span><br><span class="line">      -webkit-<span class="attribute">box-shadow</span> <span class="number">0</span> <span class="number">5px</span> <span class="number">10px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">144</span>, <span class="number">164</span>, <span class="number">174</span>, .<span class="number">4</span>)</span><br><span class="line">      <span class="attribute">box-shadow</span> <span class="number">0</span> <span class="number">5px</span> <span class="number">10px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">144</span>, <span class="number">164</span>, <span class="number">174</span>, .<span class="number">4</span>)</span><br><span class="line">      -webkit-<span class="attribute">transform</span> <span class="built_in">translateZ</span>(<span class="number">0</span>)</span><br><span class="line">      <span class="selector-class">.highlight-tools</span></span><br><span class="line">        <span class="selector-class">.code-lang</span></span><br><span class="line">          <span class="attribute">left</span> <span class="number">75px</span></span><br><span class="line">        <span class="selector-class">.expand</span></span><br><span class="line">          <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">          &amp; ~ <span class="selector-class">.copy-button</span></span><br><span class="line">            <span class="attribute">right</span> <span class="number">2.1em</span></span><br><span class="line">        <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">          <span class="attribute">position</span> absolute</span><br><span class="line">          <span class="attribute">left</span> <span class="number">14px</span></span><br><span class="line">          <span class="attribute">width</span> <span class="number">12px</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">12px</span></span><br><span class="line">          <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">          <span class="attribute">background</span> <span class="number">#fc625d</span></span><br><span class="line">          -webkit-<span class="attribute">box-shadow</span> <span class="number">20px</span> <span class="number">0</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0</span> <span class="number">#35cd4b</span></span><br><span class="line">          <span class="attribute">box-shadow</span> <span class="number">20px</span> <span class="number">0</span> <span class="number">#fdbc40</span>, <span class="number">40px</span> <span class="number">0</span> <span class="number">#35cd4b</span></span><br><span class="line">          <span class="attribute">content</span> <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="comment">/* 目录-当前节点 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span></span><br><span class="line">  <span class="selector-id">#card-toc</span></span><br><span class="line">    <span class="selector-class">.toc-content</span></span><br><span class="line">      <span class="selector-class">.toc-link</span></span><br><span class="line">        &amp;<span class="selector-class">.active</span></span><br><span class="line">          <span class="attribute">background-color</span> <span class="built_in">var</span>(--guole-main)</span><br><span class="line">          <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line"><span class="comment">/* 不需要前缀 keyframes放最后 否则打包之后的css有问题 */</span></span><br><span class="line"><span class="keyword">@keyframes</span> ccc</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> <span class="built_in">rotate</span>(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">rotate</span>(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">100%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> <span class="built_in">rotate</span>(-<span class="number">1turn</span>)</span><br><span class="line">    <span class="attribute">transform</span> <span class="built_in">rotate</span>(-<span class="number">1turn</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="页面（写作）"><a href="#页面（写作）" class="headerlink" title="页面（写作）"></a>页面（写作）</h3><h4 id="新建-标签-和分类-页面"><a href="#新建-标签-和分类-页面" class="headerlink" title="新建 标签 和分类 页面"></a>新建 <strong>标签</strong> 和<strong>分类</strong> 页面</h4><ul><li>只要在 source 文件夹下新建.md文件，并且文章前面按如下格式表明所属分类和标签就行：</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">自学编程成功概率有多少可能</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2017-05-26 19:57:47</span></span><br><span class="line"><span class="attr">tags:</span> [<span class="string">编程</span>,<span class="string">感悟</span>]</span><br><span class="line"><span class="attr">categories:</span> <span class="string">技术</span> </span><br></pre></td></tr></table></figure><ul><li>先根目录输入命令 <code>hexo new page categories</code> 会自动新建 categorier 文件夹并生成一个index.md文件，里面的代码为：</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019-01-30 23:10:51</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">categories</span> <span class="comment"># 手动添加 否则侧边栏的个人信息中的分类进入页面没有内容</span></span><br></pre></td></tr></table></figure><p>同理，「标签」也一样 <code>hexo new page tags</code> 生成 tags 文件夹，其中会自动生成一个index.md文件,代码为：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019-01-30 23:14:51</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">tags</span> <span class="comment"># 手动添加 否则侧边栏的个人信息中的标签进入页面没有内容</span></span><br></pre></td></tr></table></figure><ul><li>然后 我们发表文章使用「tags」「categories」只需在文章开头添加如下代码：</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">利用GitHub和HEXO免费搭建个人博客高级</span> <span class="string">美化篇</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019-01-29 22:58:56</span></span><br><span class="line"><span class="attr">tags:</span> [<span class="string">hexo建站</span>,<span class="string">hexo部署</span>,<span class="string">github部署</span>,<span class="string">个人博客</span>]      <span class="comment">#添加的标签</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">hexo博客</span>                              <span class="comment">#添加的分类</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><h4 id="gitee防盗链图片无法显示"><a href="#gitee防盗链图片无法显示" class="headerlink" title="gitee防盗链图片无法显示"></a>gitee防盗链图片无法显示</h4><p><strong>添加标签只能针对img  背景图还是不能  只能换个云服务做图床</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;referrer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no-referrer&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">referrer</span>=<span class="string">&quot;no-referrer|origin|unsafe-url&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;item.src&#125;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/zzcyeah/p/anti-leech.html">防盗链</a></p><p><strong>① 图片少量时，可以将图片统一放在<font color="red"><code>source/images</code></font>文件夹中，通过<code>![替代文字](/images/image.jpg)</code>来访问。</strong></p><p><strong>② 打开站点配置文件，设置<code>post_asset_folder</code>为<code>true</code>。运行<code>npm install hexo-asset-image –save</code>，安装上传图片的插件。安装完成后，再运行<code>hexo new xxx</code>来生成md文件时，<code>/source/_posts</code>文件夹内除了<code>xxx.md</code>文件还有一个同名的文件夹，这个文件夹用来存放博文中用到的图片，引用图片时通过正常语法<code>![替代文字](xxx.png)</code>引用。</strong></p><h4 id="报错-Context-Dump"><a href="#报错-Context-Dump" class="headerlink" title="报错 Context Dump"></a>报错 Context Dump</h4><p>因为文章中出现里写了<code>&#123;&#123;&#125;&#125;</code> <a href="https://so.csdn.net/so/search?q=hexo&spm=1001.2101.3001.7020">hexo</a> 的文章渲染使用的是 <code>Nunjucks</code> ，因为在使用<code>mathjax</code>公式，造成了<code>&#123; &#123;</code>重叠，而它会在生成文章时将那几个大括号识别成自己的语法，这样就会报错。</p><p><strong>用空格隔开就好</strong>；</p><h4 id="hexo语法"><a href="#hexo语法" class="headerlink" title="hexo语法"></a>hexo语法</h4><h5 id="带颜色的引用"><a href="#带颜色的引用" class="headerlink" title="带颜色的引用"></a>带颜色的引用</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note class_name %&#125; 文字内容 (md class_name supported) &#123;% endnote %&#125;</span><br><span class="line">&#123;% note primary %&#125; 文字内容 (md primary supported) &#123;% endnote %&#125;</span><br><span class="line">&#123;% note default %&#125; 文字内容 (md default supported) &#123;% endnote %&#125;</span><br><span class="line">&#123;% note success %&#125; 文字内容 (md success supported) &#123;% endnote %&#125;</span><br><span class="line">&#123;% note info %&#125; 文字内容 (md info supported) &#123;% endnote %&#125;</span><br><span class="line">&#123;% note warning %&#125; 文字内容 (md warning supported) &#123;% endnote %&#125;</span><br><span class="line">&#123;% note danger %&#125; 文字内容 (md danger supported) &#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p><strong>展示效果</strong></p><div class="note class_name flat"><p>文字内容 (md class_name supported) </p></div><div class="note primary flat"><p>文字内容 (md primary supported) </p></div><div class="note default flat"><p>文字内容 (md default supported) </p></div><div class="note success flat"><p>文字内容 (md success supported) </p></div><div class="note info flat"><p>文字内容 (md info supported) </p></div><div class="note warning flat"><p>文字内容 (md warning supported) </p></div><div class="note danger flat"><p>文字内容 (md danger supported) </p></div><h5 id="图标-可以在Font-Awesome官网查找ICO图标，然后通过class方法添加。"><a href="#图标-可以在Font-Awesome官网查找ICO图标，然后通过class方法添加。" class="headerlink" title="图标 可以在Font Awesome官网查找ICO图标，然后通过class方法添加。"></a>图标 <strong>可以在<a href="https://fontawesome.com/v4.7.0/icons/">Font Awesome官网</a>查找ICO图标，然后通过class方法添加。</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=&quot;fa fa-pencil&quot;&gt;&lt;/i&gt; 铅笔</span><br><span class="line">&lt;i class=&quot;fa fa-cloud-upload&quot;&gt;&lt;/i&gt; 上传</span><br><span class="line">&lt;i class=&quot;fa fa-download&quot;&gt;&lt;/i&gt; 下载</span><br><span class="line">&lt;i class=&quot;fa fa-download fa-lg&quot;&gt;&lt;/i&gt; 下载变大 33%</span><br><span class="line">&lt;i class=&quot;fa fa-download fa-2x&quot;&gt;&lt;/i&gt; 下载两倍大</span><br></pre></td></tr></table></figure><p><strong>展示效果</strong></p><p><i class="fa fa-pencil"></i> 铅笔</p><p><i class="fa fa-cloud-upload"></i> 上传</p><p><i class="fa fa-download"></i> 下载</p><p><i class="fa fa-download fa-lg"></i> 下载变大 33%</p><p><i class="fa fa-download fa-2x"></i> 下载两倍大</p><h5 id="设置文字颜色"><a href="#设置文字颜色" class="headerlink" title="设置文字颜色"></a>设置文字颜色</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;font color=&quot;red&quot;&gt;&lt;big&gt;测试内容&lt;/big&gt;&lt;/font&gt;</span><br><span class="line">&lt;font color=&quot;#0000FF&quot;&gt;测试内容&lt;/font&gt;</span><br><span class="line">&lt;span style=&#x27;padding: 1px 4px;color:#26c6da;background-color: rgba(77,208,225,.08);border-radius:4px&#x27;&gt;蓝绿色？&lt;/span&gt;</span><br><span class="line">&lt;span style=&#x27;padding: 1px 4px;color:#ff502c;background-color: #fff5f5;border-radius:4px&#x27;&gt;红色&lt;/span&gt;</span><br></pre></td></tr></table></figure><p><strong>展示效果</strong></p><p><font color="red"><big>测试内容</big></font></p><p><font color="#0000FF">测试内容</font></p><p><span style='padding: 1px 4px;color:#26c6da;background-color: rgba(77,208,225,.08);border-radius:4px'>蓝绿色？</span></p><p><span style='padding: 1px 4px;color:#ff502c;background-color: #fff5f5;border-radius:4px'>红色</span></p><h5 id="居中和右对齐"><a href="#居中和右对齐" class="headerlink" title="居中和右对齐"></a>居中和右对齐</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;center&gt;内容居中&lt;/center&gt;</span><br><span class="line">&lt;div style=&quot;text-align:right&quot;&gt;内容右对齐&lt;/div&gt;</span><br><span class="line">&lt;div align=&quot;left&quot;&gt; 左对齐！&lt;/div&gt;</span><br><span class="line">&lt;div align=&quot;center&quot;&gt;居中对齐！&lt;/div&gt;</span><br><span class="line">&lt;div align=&quot;right&quot;&gt;右对齐！&lt;/div&gt;</span><br><span class="line">&lt;div align=&quot;justify &quot;&gt;伸展行 文字间隔！&lt;/div&gt;</span><br></pre></td></tr></table></figure><p><strong>展示效果</strong></p><center>内容居中</center><div style="text-align:right">内容右对齐</div><div align="left"> 左对齐！</div><div align="center">居中对齐！</div><div align="right">右对齐！</div><div align="justify ">伸展行 文字间隔！</div><h5 id="选项卡"><a href="#选项卡" class="headerlink" title="选项卡"></a>选项卡</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs 选项卡, 2 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**这是选项卡 1** 呵呵哈哈哈哈哈哈</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**这是选项卡 2** 额。。。</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**这是选项卡 3** 哇，你找到我了！</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p><strong>展示效果</strong></p><div class="tabs" id="选项卡"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#选项卡-1">选项卡 1</button></li><li class="tab active"><button type="button" data-href="#选项卡-2">选项卡 2</button></li><li class="tab"><button type="button" data-href="#选项卡-3">选项卡 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="选项卡-1"><p><strong>这是选项卡 1</strong> 呵呵哈哈哈哈哈哈</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="选项卡-2"><p><strong>这是选项卡 2</strong> 额。。。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="选项卡-3"><p><strong>这是选项卡 3</strong> 哇，你找到我了！</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="引入-codepen"><a href="#引入-codepen" class="headerlink" title="引入 codepen"></a>引入 codepen</h4><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/codepen1.png" alt="codepen1"></p><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/codepen2.png" alt="codepen2"></p><p class="codepen" data-height="300" data-default-tab="result" data-slug-hash="JjBwzQE" data-editable="true" data-user="hisai3" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/hisai3/pen/JjBwzQE">  自动运行</a> by hisai3 (<a href="https://codepen.io/hisai3">@hisai3</a>)  on <a href="https://codepen.io">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p><a href="https://hexo.io/zh-cn/docs/github-pages">部署  github + hexo</a></p><h4 id="一、github-创建仓库-（部署之后访问-https-username-github-io-仓库名-）"><a href="#一、github-创建仓库-（部署之后访问-https-username-github-io-仓库名-）" class="headerlink" title="一、github 创建仓库 （部署之后访问 https://username.github.io/仓库名/）"></a>一、<code>github</code> 创建仓库 （<strong>部署之后访问</strong> <a href="https://username.github.io/%E4%BB%93%E5%BA%93%E5%90%8D/%EF%BC%89">https://username.github.io/仓库名/）</a></h4><blockquote><p>github 提交超时 使用ssh</p></blockquote><ul><li><strong>ssh-keygen -t rsa -C “邮箱”</strong></li></ul><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/gen-sshkey.png" alt="shhkey-gen"></p><ul><li><strong>cat ~&#x2F;.ssh&#x2F;id_rsa.pub</strong>  获取sshkey</li></ul><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/get-sshkey.png" alt="shhkey-get"></p><ul><li>github添加sshkey</li></ul><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/github-sshkey.png" alt="github-sshkey"></p><h4 id="二、修改-github-pages"><a href="#二、修改-github-pages" class="headerlink" title="二、修改 github pages"></a>二、修改 <code>github pages</code></h4><p><img src="https://gitee.com/hisai/image-bed/raw/master/hexo-blog/github-pages.png" alt="github-pages"></p><h4 id="三、修改配置文件-config-yml"><a href="#三、修改配置文件-config-yml" class="headerlink" title="三、修改配置文件 _config.yml"></a>三、修改配置文件 <code>_config.yml</code></h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">&#x27;git&#x27;</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:username/hisai.git</span> </span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># root 自己加 否则访问时报错, css或js样式无法显示</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://username.github.io/username.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br></pre></td></tr></table></figure><h4 id="四、部署提交"><a href="#四、部署提交" class="headerlink" title="四、部署提交"></a>四、部署提交</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清缓存 (修改配置 或者 页面不刷新使用)</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">构建public</span></span><br><span class="line">hexo g</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">发布</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p><strong>部署之后需要等待一下 刷新</strong></p><h3 id="theme主题备份上传失败"><a href="#theme主题备份上传失败" class="headerlink" title="theme主题备份上传失败"></a>theme主题备份上传失败</h3><p>现象： 讲整个博客项目提交到git上，发现主题包只剩下一个空文件夹</p><p>解决：</p><ol><li>将主题包中的 .git 文件移出，放置桌面</li><li>清缓存 git rm –cached themes&#x2F;主题包名</li><li>重新执行 git 提交代码命令</li><li>最后将 .git 文件放回主题包中</li></ol><p>可以先复制一份用于blog, 需要更新就先pull再跟复制的合并，否则每次都要重复上面的操作</p><h3 id="批量添加文章头部"><a href="#批量添加文章头部" class="headerlink" title="批量添加文章头部"></a>批量添加文章头部</h3><h4 id="1、将脚本放到需要处理的文件夹中执行即可"><a href="#1、将脚本放到需要处理的文件夹中执行即可" class="headerlink" title="1、将脚本放到需要处理的文件夹中执行即可"></a>1、将脚本放到需要处理的文件夹中执行即可</h4><h4 id="2、规则以当前文章的路径上一级为分类和标签"><a href="#2、规则以当前文章的路径上一级为分类和标签" class="headerlink" title="2、规则以当前文章的路径上一级为分类和标签"></a>2、规则以当前文章的路径上一级为分类和标签</h4><blockquote><p>当前文章路径：…..&#x2F;Vue&#x2F;指令.md</p><p>title: 指令</p><p>categories: Vue </p><p>tags: Vue </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> join = path.<span class="property">join</span></span><br><span class="line"><span class="keyword">const</span> regx = <span class="regexp">/\.md$/</span></span><br><span class="line"><span class="keyword">let</span> url = <span class="title function_">join</span>(__dirname, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isFold</span> = fileName =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> !fs.<span class="title function_">lstatSync</span>(fileName).<span class="title function_">isFile</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFoldName</span> (str) &#123;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">substring</span>(str.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;\\&quot;</span>) + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cates = []</span><br><span class="line"><span class="keyword">const</span> tree = &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDirs</span> (_path) &#123;</span><br><span class="line">  <span class="keyword">const</span> paths = fs.<span class="title function_">readdirSync</span>(_path)</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function"><span class="params">fileName</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> p = <span class="title function_">join</span>(_path, fileName)</span><br><span class="line">      <span class="keyword">const</span> check = <span class="title function_">isFold</span>(p)</span><br><span class="line">      <span class="keyword">if</span> (check) &#123;</span><br><span class="line">        cates.<span class="title function_">push</span>(fileName)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> data = &#123;</span><br><span class="line">        <span class="attr">parent</span>: _path,</span><br><span class="line">        <span class="attr">parentName</span>: check ? <span class="string">&#x27;&#x27;</span> : <span class="title function_">getFoldName</span>(_path),</span><br><span class="line">        <span class="attr">path</span>: p,</span><br><span class="line">        <span class="attr">fileName</span>: fileName.<span class="title function_">substring</span>(<span class="number">0</span>, fileName.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>)),</span><br><span class="line">        <span class="attr">ext</span>: check ? <span class="string">&#x27;&#x27;</span> : fileName.<span class="title function_">substring</span>(fileName.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>)),</span><br><span class="line">        <span class="attr">isFold</span>: check</span><br><span class="line">      &#125;</span><br><span class="line">      tree[p] = data</span><br><span class="line">      <span class="keyword">return</span> data</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">if</span> (paths &amp;&amp; paths.<span class="property">length</span>) &#123;</span><br><span class="line">    paths.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">isFold</span>)</span><br><span class="line">      .<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">getDirs</span>(item.<span class="property">path</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getDirs</span>(url)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getTime</span> () &#123;</span><br><span class="line">  <span class="keyword">var</span> time = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  <span class="keyword">var</span> Y = time.<span class="title function_">getFullYear</span>();</span><br><span class="line">  <span class="keyword">var</span> M = time.<span class="title function_">getMonth</span>();</span><br><span class="line">  M = (M + <span class="number">1</span>) &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + (M + <span class="number">1</span>) : (M + <span class="number">1</span>);  <span class="comment">//这里月份加1的原因是因为月份是从0开始的，0-11月，加1让月份从1-12月区间。</span></span><br><span class="line">  <span class="keyword">var</span> d = time.<span class="title function_">getDate</span>();</span><br><span class="line">  d = d &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + d : d;</span><br><span class="line">  <span class="keyword">var</span> h = time.<span class="title function_">getHours</span>();</span><br><span class="line">  h = h &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + h : h;</span><br><span class="line">  <span class="keyword">var</span> m = time.<span class="title function_">getMinutes</span>();</span><br><span class="line">  m = m &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + m : m;</span><br><span class="line">  <span class="keyword">var</span> s = time.<span class="title function_">getSeconds</span>();</span><br><span class="line">  s = m &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + m : m;</span><br><span class="line">  <span class="keyword">return</span> Y + <span class="string">&quot;-&quot;</span> + M + <span class="string">&quot;-&quot;</span> + d + <span class="string">&quot; &quot;</span> + h + <span class="string">&quot;:&quot;</span> + m + <span class="string">&quot;:&quot;</span> + s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> tree) &#123;</span><br><span class="line">  <span class="keyword">const</span> d = tree[key]</span><br><span class="line">  <span class="keyword">if</span> (!d.<span class="property">isFold</span> &amp;&amp; regx.<span class="title function_">test</span>(d.<span class="property">ext</span>)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> data = fs.<span class="title function_">readFileSync</span>(d.<span class="property">path</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> str = <span class="string">`</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">title: <span class="subst">$&#123;d.fileName&#125;</span></span></span><br><span class="line"><span class="string">date: <span class="subst">$&#123;getTime()&#125;</span></span></span><br><span class="line"><span class="string">description: <span class="subst">$&#123;d.fileName&#125;</span></span></span><br><span class="line"><span class="string">categories: <span class="subst">$&#123;d.parentName&#125;</span></span></span><br><span class="line"><span class="string">tags: [<span class="subst">$&#123;d.parentName&#125;</span>]</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="subst">$&#123;data&#125;</span></span></span><br><span class="line"><span class="string">      `</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;readdirSync&#x27;</span>, str);</span><br><span class="line">      fs.<span class="title function_">writeFile</span>(d.<span class="property">path</span>, str, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;write ok&#x27;</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;readdirSync----error&#x27;</span>, err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">HEXO + github 搭建博客的一些注意事项</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Echarts</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Echarts/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Echarts/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-03-07T06:46:46.068Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://echarts.apache.org/examples/zh/editor.html?c=line-simple">复制代码查看</a></p><h4 id="柱状图-bar"><a href="#柱状图-bar" class="headerlink" title="柱状图 bar"></a>柱状图 bar</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> option = &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attr">legend</span>: &#123;</span><br><span class="line">      <span class="attr">data</span>: [<span class="string">&#x27;访客数&#x27;</span>] <span class="comment">// 图例 需要在series中的数据有对应的 name === &#x27;访客数&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">  <span class="attr">xAxis</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: [<span class="string">&#x27;董事局&#x27;</span>, <span class="string">&#x27;360事项&#x27;</span>, <span class="string">&#x27;经营班子&#x27;</span>, <span class="string">&#x27;费用发包&#x27;</span>, <span class="string">&#x27;职能事项&#x27;</span>, <span class="string">&#x27;节点类&#x27;</span>, <span class="string">&#x27;对账类&#x27;</span>, <span class="string">&#x27;其它&#x27;</span>],</span><br><span class="line">    <span class="attr">axisLabel</span>: &#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">      <span class="attr">interval</span>: <span class="number">0</span>, <span class="comment">// x轴刻度过多间隔 interval 显示</span></span><br><span class="line">      <span class="attr">rotate</span>: <span class="number">40</span> <span class="comment">// 倾斜</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">yAxis</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">    <span class="attr">max</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">axisLabel</span>: &#123;</span><br><span class="line">      <span class="attr">formatter</span>: <span class="string">&#x27;&#123;value&#125;%&#x27;</span> <span class="comment">// 自定义y轴文字</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">axisTick</span>: &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span> <span class="comment">// 不显示坐标轴刻度 xy同理</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">axisLine</span>: &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span> <span class="comment">// 不显示坐标轴线 xy同理</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">splitLine</span>: &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 是否显示y轴的栅格线 横向</span></span><br><span class="line">      <span class="attr">lineStyle</span>: &#123; <span class="comment">// y轴的栅格线样式</span></span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#e0e6f1&#x27;</span>,</span><br><span class="line">        <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;solid&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">axisLabel</span>: &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span> <span class="comment">// 不显示坐标轴上的文字 xy同理</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">grid</span>: &#123; <span class="comment">// 图表中间网格大小 （调整图表是否盛满盒子）</span></span><br><span class="line">    <span class="attr">left</span>: <span class="string">&#x27;10%&#x27;</span>,</span><br><span class="line">    <span class="attr">right</span>: <span class="string">&#x27;5%&#x27;</span>,</span><br><span class="line">    <span class="attr">bottom</span>: <span class="string">&#x27;30px&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="string">&#x27;80%&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">tooltip</span>: &#123; <span class="comment">// 鼠标移入显示的提示内容</span></span><br><span class="line">    <span class="attr">trigger</span>: <span class="string">&#x27;item&#x27;</span>,</span><br><span class="line">    <span class="attr">axisPointer</span>: &#123;  <span class="comment">// 坐标轴指示器，坐标轴触发有效</span></span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;shadow&#x27;</span> <span class="comment">// 默认为直线，可选为：&#x27;line&#x27; 或&#x27;shadow&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">backgroundColor</span>:<span class="string">&quot;rgba(255, 255, 255, 0.93)&quot;</span>,<span class="comment">//弹窗背景色</span></span><br><span class="line">    <span class="attr">extraCssText</span>:<span class="string">&#x27;box-shadow:0 0 0&#x27;</span>,<span class="comment">//设置弹窗的阴影</span></span><br><span class="line">    <span class="attr">borderColor</span>: <span class="string">&#x27;#eee&#x27;</span>,</span><br><span class="line">    <span class="attr">borderWidth</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="title function_">formatter</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="comment">// data 当前鼠标指向的series中data的值, 单个柱子是对象, 多个是数组</span></span><br><span class="line">        <span class="comment">// color 对应柱子颜色</span></span><br><span class="line">        <span class="comment">// seriesName 对应柱子名称</span></span><br><span class="line">        <span class="comment">// data 对应柱子的value</span></span><br><span class="line">        <span class="comment">// axisValue 对x轴名称</span></span><br><span class="line">        <span class="comment">// marker 对应柱子的图例点样式</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;span&gt;自定义内容&lt;/span&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// dataZoom: &#123; // x 轴可拖拽</span></span><br><span class="line">  <span class="comment">//   startValue: xAxis[xAxis.length - 10], // 滑块的开始值 对应x轴的值 控制滑块大小同时控制x轴一次性展示多少个</span></span><br><span class="line">  <span class="comment">//   endValue: xAxis[xAxis.length - 1], // 滑块的结束值 对应x轴的值</span></span><br><span class="line">  <span class="comment">//   zoomLock: true, // 锁定 可能版本不同，会不生效</span></span><br><span class="line">  <span class="comment">//   width: 15, // 滚动条的宽度</span></span><br><span class="line">  <span class="comment">//   height: 15, // 滚动条的高度</span></span><br><span class="line">  <span class="comment">//   left: 100, // 滚动条的左侧偏移</span></span><br><span class="line">  <span class="comment">//   right: 100 // 滚动条的右侧偏移</span></span><br><span class="line">  <span class="comment">// &#125;,</span></span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;访客数&#x27;</span>, <span class="comment">// 对应 legend 图例</span></span><br><span class="line">      <span class="attr">data</span>: [],</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">      <span class="attr">emphasis</span>: &#123;</span><br><span class="line">        <span class="attr">focus</span>: <span class="string">&#x27;series&#x27;</span> <span class="comment">// 需要v5.0以上 当有series中有多个的数据的时候, 鼠标移入柱子会隐藏其他的柱子</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">barWidth</span>: <span class="number">25</span>, <span class="comment">// 柱子宽度</span></span><br><span class="line">      <span class="attr">label</span>: &#123; <span class="comment">// 柱子上方的提示内容</span></span><br><span class="line">        <span class="attr">formatter</span>: <span class="string">&#x27;&#123;c&#125;%&#x27;</span>, <span class="comment">// 自定义内容</span></span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>, <span class="comment">// 开启显示</span></span><br><span class="line">        <span class="attr">position</span>: <span class="string">&#x27;top&#x27;</span>, <span class="comment">// 在上方显示</span></span><br><span class="line">        <span class="attr">distance</span>: <span class="number">5</span>, <span class="comment">// 距离图形元素的距离。当 position 为字符描述值（如 &#x27;top&#x27;、&#x27;insideRight&#x27;）时候有效。</span></span><br><span class="line">        <span class="attr">verticalAlign</span>: <span class="string">&#x27;middle&#x27;</span>,</span><br><span class="line">        <span class="attr">textStyle</span>: &#123;</span><br><span class="line">          <span class="comment">// 数值样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">          <span class="attr">fontSize</span>: <span class="number">12</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="DataZoom-数据过多滑动展示-完整配置"><a href="#DataZoom-数据过多滑动展示-完整配置" class="headerlink" title="DataZoom(数据过多滑动展示) 完整配置"></a>DataZoom(数据过多滑动展示) 完整配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">dataZoom=[                                        <span class="comment">//区域缩放</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="string">&#x27;dataZoomX&#x27;</span>,</span><br><span class="line">        <span class="attr">show</span>:<span class="literal">true</span>,                             　 <span class="comment">//是否显示 组件。如果设置为 false，不会显示，但是数据过滤的功能还存在。</span></span><br><span class="line">        <span class="attr">backgroundColor</span>:<span class="string">&quot;rgba(47,69,84,0)&quot;</span>,  　　 <span class="comment">//组件的背景颜色</span></span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;slider&#x27;</span>,                          <span class="comment">//slider表示有滑动块的，inside表示内置的</span></span><br><span class="line">        <span class="attr">dataBackground</span>:&#123;                         <span class="comment">//数据阴影的样式。</span></span><br><span class="line">            <span class="attr">lineStyle</span>:mylineStyle,               <span class="comment">//阴影的线条样式</span></span><br><span class="line">            <span class="attr">areaStyle</span>:myareaStyle,               <span class="comment">//阴影的填充样式</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">fillerColor</span>:<span class="string">&quot;rgba(167,183,204,0.4)&quot;</span>,     <span class="comment">//选中范围的填充颜色。</span></span><br><span class="line">        <span class="attr">borderColor</span>:<span class="string">&quot;#ddd&quot;</span>,                      <span class="comment">//边框颜色。</span></span><br><span class="line">        <span class="attr">filterMode</span>: <span class="string">&#x27;filter&#x27;</span>,                    <span class="comment">//&#x27;filter&#x27;：当前数据窗口外的数据，被 过滤掉。即 会 影响其他轴的数据范围。每个数据项，只要有一个维度在数据窗口外，整个数据项就会被过滤掉。</span></span><br><span class="line">        <span class="attr">xAxisIndex</span>:,                            <span class="comment">//设置 dataZoom-inside 组件控制的 x轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">yAxisIndex</span>:[,],                        <span class="comment">//设置 dataZoom-inside 组件控制的 y轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">radiusAxisIndex</span>:,                       <span class="comment">//设置 dataZoom-inside 组件控制的 radius 轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">angleAxisIndex</span>:[,],                    <span class="comment">//设置 dataZoom-inside 组件控制的 angle 轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">start</span>: ,                               <span class="comment">//数据窗口范围的起始百分比,表示30%</span></span><br><span class="line">        <span class="attr">end</span>: ,                                 <span class="comment">//数据窗口范围的结束百分比,表示70%</span></span><br><span class="line">        <span class="attr">startValue</span>:,                           <span class="comment">//数据窗口范围的起始数值</span></span><br><span class="line">        <span class="attr">endValue</span>:,                            <span class="comment">//数据窗口范围的结束数值。</span></span><br><span class="line">        <span class="attr">orient</span>:<span class="string">&quot;horizontal&quot;</span>,                     <span class="comment">//布局方式是横还是竖。不仅是布局方式，对于直角坐标系而言，也决定了，缺省情况控制横向数轴还是纵向数轴。&#x27;horizontal&#x27;：水平。&#x27;vertical&#x27;：竖直。</span></span><br><span class="line">        <span class="attr">zoomLock</span>:<span class="literal">false</span>,                          <span class="comment">//是否锁定选择区域（或叫做数据窗口）的大小。如果设置为 true 则锁定选择区域的大小，也就是说，只能平移，不能缩放。</span></span><br><span class="line">        <span class="attr">throttle</span>: <span class="number">300</span>,                            <span class="comment">//设置触发视图刷新的频率。单位为毫秒（ms）。</span></span><br><span class="line">        <span class="attr">zoomOnMouseWheel</span>:<span class="literal">true</span>,                   <span class="comment">//如何触发缩放。可选值为：true：表示不按任何功能键，鼠标滚轮能触发缩放。false：表示鼠标滚轮不能触发缩放。&#x27;shift&#x27;：表示按住 shift 和鼠标滚轮能触发缩放。&#x27;ctrl&#x27;：表示按住 ctrl 和鼠标滚轮能触发缩放。&#x27;alt&#x27;：表示按住 alt 和鼠标滚轮能触发缩放。</span></span><br><span class="line">        <span class="attr">moveOnMouseMove</span>:<span class="literal">true</span>,                    <span class="comment">//如何触发数据窗口平移。true：表示不按任何功能键，鼠标移动能触发数据窗口平移。false：表示鼠标滚轮不能触发缩放。&#x27;shift&#x27;：表示按住 shift 和鼠标移动能触发数据窗口平移。&#x27;ctrl&#x27;：表示按住 ctrl 和鼠标移动能触发数据窗口平移。&#x27;alt&#x27;：表示按住 alt 和鼠标移动能触发数据窗口平移。</span></span><br><span class="line">        <span class="attr">left</span>:<span class="string">&quot;center&quot;</span>,                           <span class="comment">//组件离容器左侧的距离,&#x27;left&#x27;, &#x27;center&#x27;, &#x27;right&#x27;,&#x27;20%&#x27;</span></span><br><span class="line">        <span class="attr">top</span>:<span class="string">&quot;top&quot;</span>,                               <span class="comment">//组件离容器上侧的距离,&#x27;top&#x27;, &#x27;middle&#x27;, &#x27;bottom&#x27;,&#x27;20%&#x27;</span></span><br><span class="line">        <span class="attr">right</span>:<span class="string">&quot;auto&quot;</span>,                            <span class="comment">//组件离容器右侧的距离,&#x27;20%&#x27;</span></span><br><span class="line">        <span class="attr">bottom</span>:<span class="string">&quot;auto&quot;</span>,                           <span class="comment">//组件离容器下侧的距离,&#x27;20%&#x27;</span></span><br><span class="line"> </span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="string">&#x27;dataZoomY&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;inside&#x27;</span>,</span><br><span class="line">        <span class="attr">filterMode</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">        <span class="attr">disabled</span>:<span class="literal">false</span>,                         <span class="comment">//是否停止组件的功能。</span></span><br><span class="line">        <span class="attr">xAxisIndex</span>:,                           <span class="comment">//设置 dataZoom-inside 组件控制的 x轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">yAxisIndex</span>:[,],                       <span class="comment">//设置 dataZoom-inside 组件控制的 y轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">radiusAxisIndex</span>:,                      <span class="comment">//设置 dataZoom-inside 组件控制的 radius 轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">angleAxisIndex</span>:[,],                   <span class="comment">//设置 dataZoom-inside 组件控制的 angle 轴,可以用数组表示多个轴</span></span><br><span class="line">        <span class="attr">start</span>: <span class="number">30</span>%,                              <span class="comment">//数据窗口范围的起始百分比,表示30%</span></span><br><span class="line">        <span class="attr">end</span>: <span class="number">70</span>%,                                <span class="comment">//数据窗口范围的结束百分比,表示70%</span></span><br><span class="line">        <span class="attr">startValue</span>:,                          <span class="comment">//数据窗口范围的起始数值</span></span><br><span class="line">        <span class="attr">endValue</span>:,                           <span class="comment">//数据窗口范围的结束数值。</span></span><br><span class="line">        <span class="attr">orient</span>:<span class="string">&quot;horizontal&quot;</span>,                    <span class="comment">//布局方式是横还是竖。不仅是布局方式，对于直角坐标系而言，也决定了，缺省情况控制横向数轴还是纵向数轴。&#x27;horizontal&#x27;：水平。&#x27;vertical&#x27;：竖直。</span></span><br><span class="line">        <span class="attr">zoomLock</span>:<span class="literal">false</span>,                         <span class="comment">//是否锁定选择区域（或叫做数据窗口）的大小。如果设置为 true 则锁定选择区域的大小，也就是说，只能平移，不能缩放。</span></span><br><span class="line">        <span class="attr">throttle</span>:,                           <span class="comment">//设置触发视图刷新的频率。单位为毫秒（ms）。</span></span><br><span class="line">        <span class="attr">zoomOnMouseWheel</span>:<span class="literal">true</span>,                  <span class="comment">//如何触发缩放。可选值为：true：表示不按任何功能键，鼠标滚轮能触发缩放。false：表示鼠标滚轮不能触发缩放。&#x27;shift&#x27;：表示按住 shift 和鼠标滚轮能触发缩放。&#x27;ctrl&#x27;：表示按住 ctrl 和鼠标滚轮能触发缩放。&#x27;alt&#x27;：表示按住 alt 和鼠标滚轮能触发缩放。</span></span><br><span class="line">        <span class="attr">moveOnMouseMove</span>:<span class="literal">true</span>,                   <span class="comment">//如何触发数据窗口平移。true：表示不按任何功能键，鼠标移动能触发数据窗口平移。false：表示鼠标滚轮不能触发缩放。&#x27;shift&#x27;：表示按住 shift 和鼠标移动能触发数据窗口平移。&#x27;ctrl&#x27;：表示按住 ctrl 和鼠标移动能触发数据窗口平移。&#x27;alt&#x27;：表示按住 alt 和鼠标移动能触发数据窗口平移。</span></span><br><span class="line">    &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h4 id="饼图-pie"><a href="#饼图-pie" class="headerlink" title="饼图 pie"></a>饼图 pie</h4><p><a href="https://echarts.apache.org/examples/zh/editor.html?c=line-simple">复制代码查看</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> optionC = &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attr">tooltip</span>: &#123;</span><br><span class="line">    <span class="attr">trigger</span>: <span class="string">&#x27;item&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123; <span class="comment">// 第一个series是中心原提示主要控制是两个series的radius</span></span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;总工单&#x27;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;pie&#x27;</span>,</span><br><span class="line">      <span class="attr">radius</span>: [<span class="number">0</span>, <span class="string">&#x27;35%&#x27;</span>],</span><br><span class="line">      <span class="attr">itemStyle</span>: &#123; <span class="comment">// 饼图中每一个饼块的样式</span></span><br><span class="line">        <span class="attr">borderWidth</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">borderColor</span>: <span class="string">&#x27;#eee&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">tooltip</span>: &#123; <span class="comment">// 移入提示</span></span><br><span class="line">        <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">hoverAnimation</span>: <span class="literal">false</span>,  <span class="comment">// 移入高亮</span></span><br><span class="line">      <span class="attr">label</span>: &#123; <span class="comment">// 饼块的提示内容</span></span><br><span class="line">        <span class="attr">normal</span>: &#123;</span><br><span class="line">          <span class="attr">position</span>: <span class="string">&#x27;inner&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">labelLine</span>: &#123; <span class="comment">// 饼块的线</span></span><br><span class="line">        <span class="attr">normal</span>: &#123;</span><br><span class="line">          <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">animation</span>: <span class="literal">false</span>,  <span class="comment">// 初始动画</span></span><br><span class="line">      <span class="attr">data</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="number">100</span>,</span><br><span class="line">          <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">            <span class="attr">normal</span>: &#123;</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&#x27;#fff&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">label</span>: &#123;</span><br><span class="line">            <span class="attr">normal</span>: &#123;</span><br><span class="line">              <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">              <span class="attr">position</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">              <span class="attr">textStyle</span>: &#123;</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&#x27;#f8f8f8&#x27;</span>,</span><br><span class="line">                <span class="attr">fontSize</span>: <span class="number">20</span></span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="comment">// formatter: &#x27;&#123;a|&#123;b&#125;&#125;\n&#123;hr|&#125;\n&#123;per|&#123;d&#125;&#125;</span></span><br><span class="line">              <span class="attr">formatter</span>: <span class="string">&#x27;&#123;name|&#123;a&#125;&#125;\n&#123;value|&#123;c&#125;&#125;&#x27;</span>,  <span class="comment">// 自定义内容</span></span><br><span class="line">              <span class="attr">rich</span>: &#123;</span><br><span class="line">                <span class="attr">name</span>: &#123;</span><br><span class="line">                  <span class="attr">color</span>: <span class="string">&#x27;#999999&#x27;</span>,</span><br><span class="line">                  <span class="attr">fontSize</span>: <span class="number">11</span>,</span><br><span class="line">                  <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">value</span>: &#123;</span><br><span class="line">                  <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">                  <span class="attr">fontSize</span>: <span class="number">14</span>,</span><br><span class="line">                  <span class="attr">fontWeight</span>: <span class="number">700</span>,</span><br><span class="line">                  <span class="attr">color</span>: <span class="string">&#x27;#000&#x27;</span>,</span><br><span class="line">                  <span class="attr">padding</span>: <span class="number">5</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">tooltip</span>: &#123; <span class="comment">// 鼠标移入显示的提示内容</span></span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&#x27;item&#x27;</span>,</span><br><span class="line">        <span class="attr">borderColor</span>: <span class="string">&#x27;#eee&#x27;</span>,</span><br><span class="line">        <span class="attr">borderWidth</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">padding</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="title function_">formatter</span>(<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="comment">// data 当前鼠标指向的series中data的值</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;span&gt;自定义内容&lt;/span&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;pie&#x27;</span>,</span><br><span class="line">      <span class="attr">radius</span>: [<span class="string">&#x27;40%&#x27;</span>, <span class="string">&#x27;60%&#x27;</span>],</span><br><span class="line">      <span class="attr">data</span>: [],</span><br><span class="line">      <span class="attr">emphasis</span>: &#123;</span><br><span class="line">        <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">          <span class="attr">shadowBlur</span>: <span class="number">10</span>,</span><br><span class="line">          <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">shadowColor</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.5)&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">label</span>: &#123;</span><br><span class="line">        <span class="attr">alignTo</span>: <span class="string">&#x27;edge&#x27;</span>, <span class="comment">// 实例： https://echarts.apache.org/examples/zh/editor.html?c=pie-labelLine-adjust</span></span><br><span class="line">        <span class="attr">minMargin</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">edgeDistance</span>: <span class="number">20</span>, <span class="comment">// </span></span><br><span class="line">        <span class="attr">lineHeight</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="comment">// formatter: &#x27;&#123;a|&#123;a&#125;&#125;&#123;abg|&#125;\n&#123;hr|&#125;\n  &#123;b|&#123;b&#125;：&#125;&#123;c&#125;  &#123;per|&#123;d&#125;%&#125;  &#x27;,</span></span><br><span class="line">        <span class="comment">// formatter: &#x27;&#123;a|&#123;b&#125;&#125;\n&#123;hr|&#125;\n&#123;per|&#123;d&#125;&#125;&#x27;,</span></span><br><span class="line">        <span class="comment">// formatter: &#x27;&#123;name|&#123;b&#125;&#125;\n&#123;time|&#123;c&#125;&#125;&#x27;,</span></span><br><span class="line">        <span class="title function_">formatter</span>(<span class="params">params</span>) &#123;</span><br><span class="line">          <span class="comment">// console.log(&#x27;params--&gt;&gt;&gt;&gt;&#x27;, params.name, params.value)</span></span><br><span class="line">          <span class="keyword">const</span> isOver = params.<span class="property">name</span> === <span class="string">&#x27;逾期未完成&#x27;</span></span><br><span class="line">          <span class="keyword">return</span> <span class="string">`&#123;<span class="subst">$&#123;isOver ? <span class="string">&#x27;ra&#x27;</span> : <span class="string">&#x27;a&#x27;</span>&#125;</span>|<span class="subst">$&#123;params.name&#125;</span>&#125;\n&#123;hr|&#125;\n&#123;<span class="subst">$&#123;isOver ? <span class="string">&#x27;rper&#x27;</span> : <span class="string">&#x27;per&#x27;</span>&#125;</span>|<span class="subst">$&#123;params.value&#125;</span>&#125;`</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">rich</span>: &#123;</span><br><span class="line">          <span class="attr">ra</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#ff0606&#x27;</span>,</span><br><span class="line">            <span class="attr">fontSize</span>: <span class="number">13</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">a</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#999999&#x27;</span>,</span><br><span class="line">            <span class="attr">fontSize</span>: <span class="number">13</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">hr</span>: &#123;</span><br><span class="line">            <span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">            <span class="attr">height</span>: <span class="number">0</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">per</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#000000&#x27;</span>,</span><br><span class="line">            <span class="attr">fontSize</span>: <span class="number">18</span>,</span><br><span class="line">            <span class="attr">fontWeight</span>: <span class="number">600</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">rper</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#ff0606&#x27;</span>,</span><br><span class="line">            <span class="attr">fontSize</span>: <span class="number">18</span>,</span><br><span class="line">            <span class="attr">fontWeight</span>: <span class="number">600</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">labelLine</span>: &#123;</span><br><span class="line">        <span class="attr">length</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">length2</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">maxSurfaceAngle</span>: <span class="number">80</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">labelLayout</span>: <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> isLeft = params.<span class="property">labelRect</span>.<span class="property">x</span> &lt; myChart.<span class="title function_">getWidth</span>() / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">const</span> points = params.<span class="property">labelLinePoints</span>;</span><br><span class="line">        <span class="comment">// Update the end point.</span></span><br><span class="line">        points[<span class="number">2</span>][<span class="number">0</span>] = isLeft</span><br><span class="line">          ? params.<span class="property">labelRect</span>.<span class="property">x</span></span><br><span class="line">          : params.<span class="property">labelRect</span>.<span class="property">x</span> + params.<span class="property">labelRect</span>.<span class="property">width</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">labelLinePoints</span>: points</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="环形进度条"><a href="#环形进度条" class="headerlink" title="环形进度条"></a>环形进度条</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">  <span class="attr">legend</span>: &#123;</span><br><span class="line">    <span class="attr">orient</span>: <span class="string">&#x27;vertical&#x27;</span>,</span><br><span class="line">    <span class="attr">x</span>: <span class="string">&#x27;left&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;访问来源&#x27;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;pie&#x27;</span>,</span><br><span class="line">      <span class="attr">radius</span>: [<span class="number">0</span>, <span class="string">&#x27;38%&#x27;</span>], </span><br><span class="line">      <span class="attr">hoverAnimation</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">label</span>: &#123;</span><br><span class="line">        <span class="attr">normal</span>: &#123;</span><br><span class="line">          <span class="attr">position</span>: <span class="string">&#x27;inner&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">labelLine</span>: &#123;</span><br><span class="line">        <span class="attr">normal</span>: &#123;</span><br><span class="line">          <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">animation</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">data</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="number">100</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="number">24</span> + <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">          <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">            <span class="attr">normal</span>: &#123;</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&#x27;#6a5acd&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">label</span>: &#123;</span><br><span class="line">            <span class="attr">normal</span>: &#123;</span><br><span class="line">              <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">              <span class="attr">position</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">              <span class="attr">textStyle</span>: &#123;</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&#x27;#f8f8f8&#x27;</span>,</span><br><span class="line">                <span class="attr">fontSize</span>: <span class="number">20</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;pie&#x27;</span>,</span><br><span class="line">      <span class="attr">radius</span>: [<span class="string">&#x27;40%&#x27;</span>, <span class="string">&#x27;43%&#x27;</span>],</span><br><span class="line">      <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">        <span class="attr">normal</span>: &#123;</span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;#6a5acd&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">labelLine</span>: &#123;</span><br><span class="line">        <span class="attr">normal</span>: &#123;</span><br><span class="line">          <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">hoverAnimation</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">animationEasing</span>: <span class="string">&#x27;cubicOut&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="number">24</span>,</span><br><span class="line">          <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">            <span class="attr">emphasis</span>: &#123;</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&#x27;#6a5acd&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">value</span>: <span class="number">100</span> - <span class="number">24</span>,</span><br><span class="line">          <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">            <span class="attr">normal</span>: &#123;</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&#x27;#d3d3d3&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Echarts 柱状图和饼图配置案例</summary>
    
    
    
    <category term="Echarts" scheme="https://hisai3.github.io/hisai3.github.io/categories/Echarts/"/>
    
    
    <category term="Echarts" scheme="https://hisai3.github.io/hisai3.github.io/tags/Echarts/"/>
    
  </entry>
  
  <entry>
    <title>Css响应式布局grid</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Css%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80grid/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Css%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80grid/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T06:38:36.858Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://zhuanlan.zhihu.com/p/69809343">一行css代码搞定响应式布局</a><br><a href="https://juejin.cn/post/6854573220306255880">掘金</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>6<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: grid;</span><br><span class="line">      <span class="attribute">grid-gap</span>: <span class="number">5px</span>;</span><br><span class="line">      <span class="comment">/* 三列固定100px宽度 */</span></span><br><span class="line">      <span class="comment">/* grid-template-columns: 100px 100px 100px; */</span></span><br><span class="line">      <span class="comment">/* 三列自适应撑满 */</span></span><br><span class="line">      <span class="comment">/* grid-template-columns: 1fr 1fr 1fr; */</span></span><br><span class="line">      <span class="comment">/* 三列固定100px宽度 */</span></span><br><span class="line">      <span class="comment">/* grid-template-columns: repeat(3, 100px); */</span></span><br><span class="line">      <span class="comment">/* auto-fit自适应数量的列固定100px宽度 */</span></span><br><span class="line">      <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fit, <span class="number">100px</span>);</span><br><span class="line">      <span class="attribute">grid-template-rows</span>: <span class="number">50px</span> <span class="number">50px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.container</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>以上可以做到flex的基础布局</p></blockquote><blockquote><p>现在，栅格将会根据容器的宽度调整其数量。它会尝试在容器中容纳尽可能多的 100px 宽的列。但如果我们将所有列硬写为 100px，我们将永远没法获得所需的弹性，因为它们很难填充整个宽度。网格通常在右侧留有空白。</p></blockquote><p><strong>minmax()</strong></p><blockquote><p>我们需要minmax()。我们将 100px 替换为 minmax(100px, 1fr)，代码如下：</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: grid;</span><br><span class="line">    <span class="attribute">grid-gap</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="built_in">repeat</span>(auto-fit, <span class="built_in">minmax</span>(<span class="number">100px</span>, <span class="number">1</span>fr));</span><br><span class="line">    <span class="attribute">grid-template-rows</span>: <span class="built_in">repeat</span>(<span class="number">2</span>, <span class="number">100px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 最终达到一个默认撑满, 当页面缩小, 元素会宽度会压缩, 最小为100px, 之后换行 */</span></span><br></pre></td></tr></table></figure><blockquote><p><code>minmax()</code>函数定义的范围大于或等于 min， 小于或等于 max。</p></blockquote><p><strong>注意:</strong> 跟<code>flex</code> + <code>minwidth</code> 的区别在于，换行后，换行的元素会<strong>撑满</strong>, 而 <code>grid</code> 的会以<strong>最小宽度</strong>存在</p>]]></content>
    
    
    <summary type="html">Css响应式布局grid</summary>
    
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/categories/css/"/>
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>JS 常用工具</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/JS%20%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/JS%20%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T06:50:47.414Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JS-常用工具"><a href="#JS-常用工具" class="headerlink" title="JS 常用工具"></a>JS 常用工具</h1><p><a href="https://juejin.cn/post/6844904090313424903">一坨校验</a></p><h3 id="时间处理"><a href="#时间处理" class="headerlink" title="时间处理"></a>时间处理</h3><h5 id="格式化时间"><a href="#格式化时间" class="headerlink" title="格式化时间"></a>格式化时间</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">formatDate</span>(<span class="params">date, fmt</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.<span class="title function_">test</span>(fmt)) &#123;</span><br><span class="line">    fmt = fmt.<span class="title function_">replace</span>(</span><br><span class="line">      <span class="title class_">RegExp</span>.<span class="property">$1</span>,</span><br><span class="line">      (date.<span class="title function_">getFullYear</span>() + <span class="string">&#x27;&#x27;</span>).<span class="title function_">substr</span>(<span class="number">4</span> - <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> o = &#123;</span><br><span class="line">    <span class="string">&#x27;M+&#x27;</span>: date.<span class="title function_">getMonth</span>() + <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;d+&#x27;</span>: date.<span class="title function_">getDate</span>(),</span><br><span class="line">    <span class="string">&#x27;h+&#x27;</span>: date.<span class="title function_">getHours</span>(),</span><br><span class="line">    <span class="string">&#x27;m+&#x27;</span>: date.<span class="title function_">getMinutes</span>(),</span><br><span class="line">    <span class="string">&#x27;s+&#x27;</span>: date.<span class="title function_">getSeconds</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`(<span class="subst">$&#123;k&#125;</span>)`</span>).<span class="title function_">test</span>(fmt)) &#123;</span><br><span class="line">      <span class="keyword">let</span> str = o[k] + <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      fmt = fmt.<span class="title function_">replace</span>(</span><br><span class="line">        <span class="title class_">RegExp</span>.<span class="property">$1</span>,</span><br><span class="line">        <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span> === <span class="number">1</span> ? str : (<span class="string">&#x27;00&#x27;</span> + str).<span class="title function_">substr</span>(str.<span class="property">length</span>)</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fmt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">formatDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(), <span class="string">&#x27;yyyy-MM-dd hh:mm:ss&#x27;</span>);</span><br><span class="line"><span class="title function_">formatDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(), <span class="string">&#x27;yyyy-MM-dd&#x27;</span>);</span><br><span class="line"><span class="title function_">formatDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(), <span class="string">&#x27;hh:mm:ss&#x27;</span>);</span><br></pre></td></tr></table></figure><h5 id="获取前x天的日期"><a href="#获取前x天的日期" class="headerlink" title="获取前x天的日期"></a>获取前x天的日期</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getDateBeforeNow</span>(<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"><span class="keyword">const</span> day = now.<span class="title function_">getDate</span>()</span><br><span class="line">    <span class="keyword">return</span> now.<span class="title function_">setDate</span>(day - val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="获取当年指定月最后一日"><a href="#获取当年指定月最后一日" class="headerlink" title="获取当年指定月最后一日"></a>获取当年指定月最后一日</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如若获取第一天 new Date(year, m - 1, 1)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getLastDate</span>(<span class="params">m</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> year = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(year, m, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="获取本周的开始、结束日期-（周一到周日）"><a href="#获取本周的开始、结束日期-（周一到周日）" class="headerlink" title="获取本周的开始、结束日期 （周一到周日）"></a>获取本周的开始、结束日期 （周一到周日）</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getWeekStartAndEnd</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">start</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">setDate</span>(now.<span class="title function_">getDate</span>() - now.<span class="title function_">getDay</span>() + <span class="number">1</span>)),</span><br><span class="line">        <span class="attr">end</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">setDate</span>(now.<span class="title function_">getDate</span>() - now.<span class="title function_">getDay</span>() + <span class="number">7</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id=""><a href="#" class="headerlink" title=""></a></h5><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><h5 id="操作URL查询参数"><a href="#操作URL查询参数" class="headerlink" title="操作URL查询参数"></a>操作URL查询参数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(location.<span class="property">search</span>.<span class="title function_">replace</span>(<span class="regexp">/\?/ig</span>, <span class="string">&quot;&quot;</span>)); </span><br><span class="line"><span class="comment">// location.search = &quot;?name=young&amp;sex=male&quot;</span></span><br><span class="line">params.<span class="title function_">has</span>(<span class="string">&quot;young&quot;</span>); <span class="comment">// true</span></span><br><span class="line">params.<span class="title function_">get</span>(<span class="string">&quot;sex&quot;</span>); <span class="comment">// &quot;male&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getQueryString</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;(^|&amp;)&#x27;</span> + name + <span class="string">&#x27;=([^&amp;]*)(&amp;|$)&#x27;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> r = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>.<span class="title function_">substr</span>(<span class="number">1</span>).<span class="title function_">match</span>(reg);</span><br><span class="line">  <span class="keyword">if</span> (r != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="序列化参数"><a href="#序列化参数" class="headerlink" title="序列化参数"></a>序列化参数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * object转化成url拼接样式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> obj 需要转化的参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">objToUrl</span> = obj =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> obj)&#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(i)) &#123;</span><br><span class="line">            arr.<span class="title function_">push</span>(<span class="built_in">encodeURIComponent</span>(i) + <span class="string">&quot;=&quot;</span> + <span class="built_in">encodeURIComponent</span>(obj[i]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">join</span>(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="title function_">objToUrl</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;hehe&#x27;</span>,<span class="attr">age</span>:<span class="number">10</span>&#125;)</span><br></pre></td></tr></table></figure><h5 id="反序列化参数"><a href="#反序列化参数" class="headerlink" title="反序列化参数"></a>反序列化参数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * url转化成object拼接样式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> url 需要转化的参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">urlToObj</span> = url =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> string = url.<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> res = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i&lt;string.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">let</span> str = string[i].<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(str[<span class="number">0</span>]!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            res[str[<span class="number">0</span>]]=str[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="comment">// 无法处理链接 只能先接触参数部分</span></span><br><span class="line"><span class="title function_">urlToObj</span>(<span class="string">&quot;a=1&amp;b=2&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> url = <span class="string">&quot;http://www.baidu.com?name=elephant&amp;age=25&amp;sex=male&amp;num=100&quot;</span></span><br><span class="line"><span class="comment">// 返回参数对象</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">queryURLParams</span>(<span class="params">url</span>) &#123;</span><br><span class="line"><span class="keyword">let</span> pattern = <span class="regexp">/(\w+)=(\w+)/ig</span>; <span class="comment">//定义正则表达式</span></span><br><span class="line"><span class="keyword">let</span> parames = &#123;&#125;; <span class="comment">// 定义参数对象</span></span><br><span class="line">url.<span class="title function_">replace</span>(pattern, <span class="function">(<span class="params">$, $<span class="number">1</span>, $<span class="number">2</span></span>) =&gt;</span> &#123;</span><br><span class="line">  parames[$<span class="number">1</span>] = $<span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> parames;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以获取链接上所有的参数  包括hash 不会存在返回 &#123;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">queryURLParams</span>(url))</span><br></pre></td></tr></table></figure><h5 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params">func, wait, immediate</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> timeout, result;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> context = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">var</span> args = <span class="variable language_">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span> (timeout) <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">        <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">            <span class="keyword">var</span> callNow = !timeout;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                timeout = <span class="literal">null</span></span><br><span class="line">            &#125;, wait);</span><br><span class="line">            <span class="keyword">if</span> (callNow) result = func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">func,wait</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> context, args, timeout;</span><br><span class="line">    <span class="keyword">var</span> tag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        context = <span class="variable language_">this</span>;</span><br><span class="line">        args = <span class="variable language_">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span>(!timeout)&#123;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">                func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">            &#125;, wait)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首次会执行</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throttle2</span>(<span class="params">fn,delay=<span class="number">100</span></span>)&#123;</span><br><span class="line"><span class="keyword">let</span> last = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="keyword">let</span> curr = +<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">if</span>(curr - last &gt; delay)&#123;</span><br><span class="line">fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>);</span><br><span class="line">last = curr;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="格式化金钱"><a href="#格式化金钱" class="headerlink" title="格式化金钱"></a>格式化金钱</h5><ol><li>正则</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">ThousandNum</span> = num =&gt; num.<span class="title function_">toString</span>().<span class="title function_">replace</span>(<span class="regexp">/\B(?=(\d&#123;3&#125;)+(?!\d))/g</span>, <span class="string">&quot;,&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> money = <span class="title class_">ThousandNum</span>(<span class="number">20190214</span>);</span><br><span class="line"><span class="comment">// money =&gt; &quot;20,190,214&quot;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>web API<br><code>toLocaleString</code> 返回这个数字在特定语言环境下的字符串表示</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">12345</span>;</span><br><span class="line">num.<span class="title function_">toLocaleString</span>(); <span class="comment">// &quot;12,345&quot;，注意有个千分位逗号</span></span><br><span class="line">num.<span class="title function_">toString</span>();       <span class="comment">// &quot;12345&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用locales参数 缩写的语言代码或这些代码组成的数组</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">1234567890</span>;</span><br><span class="line">num.<span class="title function_">toLocaleString</span>(<span class="string">&#x27;zh-Hans-CN-u-nu-hanidec&#x27;</span>); <span class="comment">// &quot;一,二三四,五六七,八九〇&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用options参数 指定了一些附加的样式属性</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">123456.789</span>;</span><br><span class="line">num.<span class="title function_">toLocaleString</span>(<span class="string">&#x27;de-DE&#x27;</span>, &#123; <span class="attr">style</span>: <span class="string">&#x27;currency&#x27;</span>, <span class="attr">currency</span>: <span class="string">&#x27;EUR&#x27;</span> &#125;); <span class="comment">// &quot;123.456,79 €&quot;</span></span><br></pre></td></tr></table></figure><h5 id="格式化电话号码"><a href="#格式化电话号码" class="headerlink" title="格式化电话号码"></a>格式化电话号码</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mobile = <span class="string">&#x27;18379836654&#x27;</span> </span><br><span class="line"><span class="keyword">let</span> mobileReg = <span class="regexp">/(?=(\d&#123;4&#125;)+$)/g</span> </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mobile.<span class="title function_">replace</span>(mobileReg, <span class="string">&#x27;-&#x27;</span>)) <span class="comment">// 183-7983-6654</span></span><br></pre></td></tr></table></figure><h5 id="去除前后空格"><a href="#去除前后空格" class="headerlink" title="去除前后空格"></a>去除前后空格</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">trim1</span> = (<span class="params">str</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/^\s*|\s*$/g</span>, <span class="string">&#x27;&#x27;</span>) <span class="comment">// 或者 str.replace(/^\s*(.*?)\s*$/g, &#x27;$1&#x27;)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> string = <span class="string">&#x27;   hello medium   &#x27;</span></span><br><span class="line"><span class="keyword">const</span> noSpaceString = <span class="string">&#x27;hello medium&#x27;</span></span><br><span class="line"><span class="keyword">const</span> trimString = <span class="title function_">trim1</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(string)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(trimString, trimString === noSpaceString) <span class="comment">// hello medium true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(string)</span><br></pre></td></tr></table></figure><h5 id="生成随机ID"><a href="#生成随机ID" class="headerlink" title="生成随机ID"></a>生成随机ID</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">RandomId</span> = len =&gt; <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>(<span class="number">36</span>).<span class="title function_">substr</span>(<span class="number">3</span>, len);</span><br><span class="line"><span class="keyword">const</span> id = <span class="title class_">RandomId</span>(<span class="number">10</span>);</span><br><span class="line"><span class="comment">// id =&gt; &quot;jg7zpgiqva&quot;</span></span><br></pre></td></tr></table></figure><h5 id="生成星级评分"><a href="#生成星级评分" class="headerlink" title="生成星级评分"></a>生成星级评分</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">StartScore</span> = rate =&gt; <span class="string">&quot;★★★★★☆☆☆☆☆&quot;</span>.<span class="title function_">slice</span>(<span class="number">5</span> - rate, <span class="number">10</span> - rate);</span><br><span class="line"><span class="keyword">const</span> start = <span class="title class_">StartScore</span>(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// start =&gt; &quot;★★★&quot;</span></span><br></pre></td></tr></table></figure><h5 id="精确小数"><a href="#精确小数" class="headerlink" title="精确小数"></a>精确小数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">RoundNum</span> = (<span class="params">num, decimal</span>) =&gt; <span class="title class_">Math</span>.<span class="title function_">round</span>(num * <span class="number">10</span> ** decimal) / <span class="number">10</span> ** decimal;</span><br><span class="line"><span class="keyword">const</span> num = <span class="title class_">RoundNum</span>(<span class="number">1.69</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><h5 id="生成范围随机数"><a href="#生成范围随机数" class="headerlink" title="生成范围随机数"></a>生成范围随机数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">RandomNum</span> = (<span class="params">min, max</span>) =&gt; <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (max - min + <span class="number">1</span>)) + min;</span><br><span class="line"><span class="keyword">const</span> num = <span class="title class_">RandomNum</span>(<span class="number">1</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><h5 id="判断数据类型"><a href="#判断数据类型" class="headerlink" title="判断数据类型"></a>判断数据类型</h5><blockquote><p>可判断类型：undefined、null、string、number、boolean、array、object、symbol、date、regexp、function、asyncfunction、arguments、set、map、weakset、weakmap</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isDataType</span>(<span class="params">data, type</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> dataType = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(data).<span class="title function_">replace</span>(<span class="regexp">/\[object (\w+)\]/</span>, <span class="string">&quot;$1&quot;</span>).<span class="title function_">toLowerCase</span>();</span><br><span class="line">    <span class="keyword">return</span> type ? dataType === type : dataType;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">isDataType</span>(<span class="string">&quot;young&quot;</span>); <span class="comment">// &quot;string&quot;</span></span><br><span class="line"><span class="title function_">isDataType</span>(<span class="number">20190214</span>); <span class="comment">// &quot;number&quot;</span></span><br><span class="line"><span class="title function_">isDataType</span>(<span class="literal">true</span>); <span class="comment">// &quot;boolean&quot;</span></span><br><span class="line"><span class="title function_">isDataType</span>([], <span class="string">&quot;array&quot;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="title function_">isDataType</span>(&#123;&#125;, <span class="string">&quot;array&quot;</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h5 id="过滤空值"><a href="#过滤空值" class="headerlink" title="过滤空值"></a>过滤空值</h5><blockquote><p>空值：undefined、null、””、0、false、NaN</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="literal">undefined</span>, <span class="literal">null</span>, <span class="string">&quot;&quot;</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="title class_">NaN</span>, <span class="number">1</span>, <span class="number">2</span>].<span class="title function_">filter</span>(<span class="title class_">Boolean</span>);</span><br><span class="line"><span class="comment">// arr =&gt; [1, 2]</span></span><br></pre></td></tr></table></figure><h5 id="一次性函数"><a href="#一次性函数" class="headerlink" title="一次性函数"></a>一次性函数</h5><blockquote><p>适用于运行一些只需执行一次的初始化代码</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Func</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">    <span class="title class_">Func</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;y&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Func</span>() <span class="comment">// x</span></span><br><span class="line"><span class="title class_">Func</span>() <span class="comment">// y</span></span><br><span class="line"><span class="title class_">Func</span>() <span class="comment">// y</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h5 id="惰性载入函数"><a href="#惰性载入函数" class="headerlink" title="惰性载入函数"></a>惰性载入函数</h5><blockquote><p>函数内判断分支较多较复杂时可大大节约资源开销</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Func</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;y&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 换成</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Func</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">        <span class="title class_">Func</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title class_">Func</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;y&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Func</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="优雅处理Async-x2F-Await参数"><a href="#优雅处理Async-x2F-Await参数" class="headerlink" title="优雅处理Async&#x2F;Await参数"></a>优雅处理Async&#x2F;Await参数</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">AsyncTo</span>(<span class="params">promise</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> promise.<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> [<span class="literal">null</span>, data]).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> [err]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> [err, res] = <span class="keyword">await</span> <span class="title class_">AsyncTo</span>(<span class="title class_">Func</span>());</span><br></pre></td></tr></table></figure><h5 id="过滤XSS"><a href="#过滤XSS" class="headerlink" title="过滤XSS"></a>过滤XSS</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">FilterXss</span>(<span class="params">content</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> elem = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    elem.<span class="property">innerText</span> = content;</span><br><span class="line">    <span class="keyword">const</span> result = elem.<span class="property">innerHTML</span>;</span><br><span class="line">    elem = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="显示全部DOM边框"><a href="#显示全部DOM边框" class="headerlink" title="显示全部DOM边框"></a>显示全部DOM边框</h5><blockquote><p>调试页面元素边界时使用</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[].<span class="property">forEach</span>.<span class="title function_">call</span>($$(<span class="string">&quot;*&quot;</span>), <span class="function"><span class="params">dom</span> =&gt;</span> &#123;</span><br><span class="line">    dom.<span class="property">style</span>.<span class="property">outline</span> = <span class="string">&quot;1px solid #&quot;</span> + (~~(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (<span class="number">1</span> &lt;&lt; <span class="number">24</span>))).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">[].<span class="property">forEach</span>.<span class="title function_">call</span>($$(<span class="string">&quot;*&quot;</span>), <span class="function"><span class="params">dom</span> =&gt;</span> &#123;</span><br><span class="line">    dom.<span class="property">style</span>.<span class="property">outline</span> = <span class="string">&quot;unset&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h5 id="自适应页面"><a href="#自适应页面" class="headerlink" title="自适应页面"></a>自适应页面</h5><blockquote><p>页面基于一张设计图但需做多款机型自适应，元素尺寸使用<code>rem</code>进行设置</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">AutoResponse</span>(<span class="params">width = <span class="number">750</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="property">documentElement</span>;</span><br><span class="line">    target.<span class="property">clientWidth</span> &gt;= <span class="number">600</span></span><br><span class="line">        ? (target.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&quot;80px&quot;</span>)</span><br><span class="line">        : (target.<span class="property">style</span>.<span class="property">fontSize</span> = target.<span class="property">clientWidth</span> / width * <span class="number">100</span> + <span class="string">&quot;px&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;JS-常用工具&quot;&gt;&lt;a href=&quot;#JS-常用工具&quot; class=&quot;headerlink&quot; title=&quot;JS 常用工具&quot;&gt;&lt;/a&gt;JS 常用工具&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://juejin.cn/post/684490409031342490</summary>
      
    
    
    
    <category term="JS常用工具" scheme="https://hisai3.github.io/hisai3.github.io/categories/JS%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="javascript" scheme="https://hisai3.github.io/hisai3.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>Loading 动画</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Loading%20%E5%8A%A8%E7%94%BB/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Loading%20%E5%8A%A8%E7%94%BB/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:05:38.049Z</updated>
    
    <content type="html"><![CDATA[<p>小功能</p><h3 id="Loading-动画"><a href="#Loading-动画" class="headerlink" title="Loading 动画"></a>Loading 动画</h3><h4 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    div &#123;</span><br><span class="line">      display: inline-block;</span><br><span class="line">      width: 10px;</span><br><span class="line">      height: 20px;</span><br><span class="line">      border: 1px solid #eee;</span><br><span class="line">      animation: show 2s infinite cubic-bezier(0.075, 0.82, 0.165, 1);</span><br><span class="line">    &#125;</span><br><span class="line">/* 1.关键在于延迟 */</span><br><span class="line">    div:nth-child(1) &#123;</span><br><span class="line">      animation-delay: -1.0s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    div:nth-child(2) &#123;</span><br><span class="line">      animation-delay: -0.8s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    div:nth-child(3) &#123;</span><br><span class="line">      animation-delay: -0.7s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    div:nth-child(4) &#123;</span><br><span class="line">      animation-delay: -0.6s;</span><br><span class="line">    &#125;</span><br><span class="line">/* 2.其次在于每帧 */</span><br><span class="line">    @keyframes show &#123;</span><br><span class="line">      0% &#123;</span><br><span class="line">        transform: scaleY(0.4);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      25% &#123;</span><br><span class="line">        transform: scaleY(1.0);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      50% &#123;</span><br><span class="line">        transform: scaleY(0.4);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      75% &#123;</span><br><span class="line">        transform: scaleY(0.4);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      100% &#123;</span><br><span class="line">        transform: scaleY(0.4);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div&gt;&lt;/div&gt;</span><br><span class="line">  &lt;div&gt;&lt;/div&gt;</span><br><span class="line">  &lt;div&gt;&lt;/div&gt;</span><br><span class="line">  &lt;div&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.loading3</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>:<span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>:<span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>:<span class="number">50px</span> auto;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>:relative;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.circle</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>:absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>:<span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>:<span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.circle</span> <span class="selector-tag">span</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>:<span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>:<span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>:inline-block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>:<span class="number">#67CF22</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>:absolute;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation</span>: mycircle <span class="number">1.2s</span> infinite ease-in-out;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation</span>: mycircle <span class="number">1.2s</span> infinite ease-in-out;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-fill-mode</span>:both;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-fill-mode</span>:both;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle2</span>&#123;</span></span><br><span class="line"><span class="language-css">           -webkit-<span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">45deg</span>);</span></span><br><span class="line"><span class="language-css">           <span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">45deg</span>);</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle3</span>&#123;</span></span><br><span class="line"><span class="language-css">           -webkit-<span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">90deg</span>);</span></span><br><span class="line"><span class="language-css">           <span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">90deg</span>);</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle</span>&gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle</span>&gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle</span>&gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">bottom</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle</span>&gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>)&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">bottom</span>:<span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle2</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">1.1s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">1.1s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle3</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">1.0s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">1.0s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle1</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.9s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.9s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle2</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.8s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.8s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle3</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.7s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.7s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle1</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.6s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.6s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle2</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.7s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.7s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle3</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.4s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.4s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle1</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.3s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.3s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle2</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.2s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="selector-class">.circle3</span> &gt;<span class="selector-tag">span</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>)&#123;</span></span><br><span class="line"><span class="language-css">            -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.1s</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">animation-delay</span>: -<span class="number">0.1s</span>;</span></span><br><span class="line"><span class="language-css">       &#125;</span></span><br><span class="line"><span class="language-css">       <span class="keyword">@-webkit-keyframes</span> mycircle&#123;</span></span><br><span class="line"><span class="language-css">            <span class="number">0%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">            <span class="number">40%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">1.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">            <span class="number">80%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">            <span class="number">100%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="keyword">@keyframes</span> mycircle&#123;</span></span><br><span class="line"><span class="language-css">            <span class="number">0%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">            <span class="number">40%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">1.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">            <span class="number">80%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">            <span class="number">100%</span>&#123;<span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0.0</span>);&#125;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">       </span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loading3&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;circle circle1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;circle circle2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;circle circle3&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="第三种"><a href="#第三种" class="headerlink" title="第三种"></a>第三种</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.loading4</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">150px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">margin</span>: <span class="number">50px</span> auto;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">text-align</span>: center;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.loading4</span>&gt;<span class="selector-tag">div</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">width</span>: <span class="number">18px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">height</span>: <span class="number">18px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">display</span>: inline-block;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">background-color</span>: <span class="number">#67CF22</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      -webkit-<span class="attribute">animation</span>: three <span class="number">1.4s</span> infinite ease-in-out;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">animation</span>: three <span class="number">1.4s</span> infinite ease-in-out;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      -webkit-<span class="attribute">animation-fill-mode</span>: both;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">animation-fill-mode</span>: both;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.loading4</span> <span class="selector-class">.three1</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.30s</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">animation-delay</span>: -<span class="number">0.30s</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.loading4</span> <span class="selector-class">.three2</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      -webkit-<span class="attribute">animation-delay</span>: -<span class="number">0.15s</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="attribute">animation-delay</span>: -<span class="number">0.15s</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="keyword">@-webkit-keyframes</span> three &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">0%</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">80%</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">100%</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.0</span>)</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">40%</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.0</span>)</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="keyword">@keyframes</span> three &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">0%</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">80%</span>,</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">100%</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.0</span>)</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      <span class="number">40%</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        -webkit-<span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.0</span>)</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loading4&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;three1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;three2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;three3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;小功能&lt;/p&gt;
&lt;h3 id=&quot;Loading-动画&quot;&gt;&lt;a href=&quot;#Loading-动画&quot; class=&quot;headerlink&quot; title=&quot;Loading 动画&quot;&gt;&lt;/a&gt;Loading 动画&lt;/h3&gt;&lt;h4 id=&quot;第一种&quot;&gt;&lt;a href=&quot;#第一种&quot; cl</summary>
      
    
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/categories/css/"/>
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/tags/css/"/>
    
    <category term="css3" scheme="https://hisai3.github.io/hisai3.github.io/tags/css3/"/>
    
  </entry>
  
  <entry>
    <title>Problem</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Problem/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Problem/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:01:15.760Z</updated>
    
    <content type="html"><![CDATA[<h5 id="flex布局"><a href="#flex布局" class="headerlink" title="flex布局"></a>flex布局</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span>123<span class="tag">&lt;/<span class="name">i</span>&gt;</span>电话预定<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>最终显示123在上文本在下，可以 display: flex;<br>        flex-direction: column;这就可以让a标签中的文本和img的垂直显示的效果</p><p>原因：<em><strong>在flex布局中，文本也算是子项！！！</strong></em><br>可以把 i 标签改为块级元素，用margin居中</p><h5 id="响应式布局！！的关键：媒体查询（c3支持）响应式布局为了适配pc端和移动端的"><a href="#响应式布局！！的关键：媒体查询（c3支持）响应式布局为了适配pc端和移动端的" class="headerlink" title="响应式布局！！的关键：媒体查询（c3支持）响应式布局为了适配pc端和移动端的?"></a>响应式布局！！的关键：媒体查询（c3支持）响应式布局为了适配pc端和移动端的?</h5><p>在响应式布局中不能使用flex布局<br>能根据屏幕宽度的不同，去加载对应的css代码段</p><p>语法：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span>(<span class="attribute">width</span>:<span class="number">800px</span>)&#123;</span><br><span class="line"><span class="comment">/*只有width：800px可以改，其他不变*/</span></span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">        <span class="attribute">background</span>：<span class="selector-id">#000</span>；</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span>(<span class="attribute">min-width</span>:<span class="number">800px</span>)&#123;</span><br><span class="line"><span class="comment">/*屏幕宽大于800px时执行*/</span></span><br><span class="line">    <span class="selector-tag">body</span>&#123;</span><br><span class="line">        <span class="attribute">background</span>：<span class="selector-id">#000</span>；</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span>(<span class="attribute">min-width</span>:<span class="number">800px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">900px</span>)&#123;</span><br><span class="line"><span class="comment">/*屏幕宽大于800px,小于900px时执行*/</span></span><br><span class="line">    <span class="selector-tag">body</span>&#123;</span><br><span class="line">        <span class="attribute">background</span>：<span class="selector-id">#000</span>；</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Array-高阶函数"><a href="#Array-高阶函数" class="headerlink" title="Array 高阶函数"></a>Array 高阶函数</h4><ol><li><p><strong>forEach(遍历)</strong></p><p> forEach() 方法用于调用数组的每个元素，并将元素传递给回调函数。(没有返回值，将数组遍历)</p><p> 注意: forEach() 对于空数组是不会执行回调函数的。</p><p> 回调函数参数：</p><p> currentValue  必需。当前元素；</p><p> index  可选。当前元素的索引值；</p><p> arr  可选。当前元素所属的数组对象。</p></li><li><p><strong>filter(过滤，返回新数组)</strong></p><p> filter() 方法创建一个新的数组，新数组中的元素是通过检查指定数组中符合条件的所有元素。</p><p> 注意： filter() 不会对空数组进行检测。</p><p> 注意： filter() 不会改变原始数组。</p><p> 回调函数参数：</p><p> currentValue  必需。当前元素； </p><p> index  可选。当前元素的索引值； </p><p> arr  可选。当前元素所属的数组对象。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ages = [<span class="number">32</span>, <span class="number">33</span>, <span class="number">16</span>, <span class="number">40</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ages.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> item &gt; <span class="number">18</span>;<span class="comment">//返回判断条件为真的数组元素</span></span><br><span class="line">&#125;))</span><br><span class="line"><span class="comment">//输出[32,33,40]</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p><strong>map(映射，返回新数组)</strong></p><p> map() 方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值。</p><p> map() 方法按照原始数组元素顺序依次处理元素。</p><p> 注意： map() 不会对空数组进行检测。</p><p> 注意： map() 不会改变原始数组。</p><p> 回调函数参数：</p><p> currentValue  必需。当前元素； </p><p> index  可选。当前元素的索引值； </p><p> arr  可选。当前元素所属的数组对象。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [<span class="number">65</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">4</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> item * <span class="number">10</span>;</span><br><span class="line">&#125;))</span><br><span class="line"><span class="comment">//输出[650,440,120,40]</span></span><br></pre></td></tr></table></figure><pre><code>**es5手动实现一下**</code></pre> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">myMap</span>(<span class="params">cb, obj</span>)&#123;</span><br><span class="line">    <span class="comment">// map()不会对空数组进行检测</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">length</span> == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//不改变原数组，不暴露原数组给调用者</span></span><br><span class="line">    <span class="keyword">var</span> _this = <span class="variable language_">this</span>.<span class="title function_">slice</span>();</span><br><span class="line">        <span class="keyword">var</span> arr = [];</span><br><span class="line">        <span class="comment">//如果第二个参数没传，默认是全局对象</span></span><br><span class="line">        obj ? <span class="literal">null</span> : obj = <span class="variable language_">window</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;_this.<span class="property">length</span>; i++)&#123;</span><br><span class="line">        arr.<span class="title function_">push</span>(cb.<span class="title function_">call</span>(obj, _this[i], i, _this));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myMap</span> = myMap;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="string">``</span><span class="string">`   </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">4. **every(判断是否全部元素符合条件，返回布尔值)**</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    every() 方法用于检测数组所有元素是否都符合指定条件（通过函数提供）。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    every() 方法使用指定函数检测数组中的所有元素：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    如果数组中检测到有一个元素不满足，则整个表达式返回 false ，且剩余的元素不会再进行检测。</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    如果所有元素都满足条件，则返回 true。</span></span><br><span class="line"><span class="string">    注意： every() 不会对空数组进行检测。</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    注意： every() 不会改变原始数组。</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    回调函数参数：</span></span><br><span class="line"><span class="string">    currentValue  必需。当前元素；</span></span><br><span class="line"><span class="string">    index  可选。当前元素的索引值；</span></span><br><span class="line"><span class="string">    arr  可选。当前元素所属的数组对象。</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span><span class="variable constant_">JS</span></span><br><span class="line"><span class="keyword">var</span> ages = [<span class="number">32</span>, <span class="number">33</span>, <span class="number">16</span>, <span class="number">40</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ages.<span class="title function_">every</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> item &gt; <span class="number">18</span>;</span><br><span class="line">&#125;))</span><br><span class="line"><span class="comment">//输出false</span></span><br></pre></td></tr></table></figure><ol start="5"><li><p><strong>reduce(累加)</strong><br> reduce() 方法接收一个函数作为累加器，数组中的每个值（从左到右）开始缩减，最终计算为一个值。</p><p> reduce() 可以作为一个高阶函数，用于函数的 compose。</p><p> 注意: reduce() 对于空数组是不会执行回调函数的。</p><p> 回调函数参数：<br> total  必需。初始值, 或者计算结束后的返回值；<br> currentValue  必需。当前元素；<br> index  可选。当前元素的索引值；<br> arr  可选。当前元素所属的数组对象。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [&#123;<span class="attr">price</span>:<span class="number">30</span>,<span class="attr">count</span>:<span class="number">2</span>&#125;,&#123;<span class="attr">price</span>:<span class="number">40</span>,<span class="attr">count</span>:<span class="number">3</span>&#125;,&#123;<span class="attr">price</span>:<span class="number">50</span>,<span class="attr">count</span>:<span class="number">5</span>&#125;];</span><br><span class="line"><span class="comment">//当数组元素为引用类型时需要注意</span></span><br><span class="line"><span class="keyword">var</span> sum = arr.<span class="title function_">reduce</span>(<span class="keyword">function</span>(<span class="params">x,y</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> x.<span class="property">price</span>*x.<span class="property">count</span> + y.<span class="property">price</span>*y.<span class="property">count</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(sum)</span><br><span class="line"><span class="comment">//输出NaN</span></span><br><span class="line"><span class="comment">//正确应该为</span></span><br><span class="line"><span class="keyword">var</span> sum = arr.<span class="title function_">reduce</span>(<span class="keyword">function</span>(<span class="params">x,y</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> x + y.<span class="property">price</span>*y.<span class="property">count</span>;</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(sum)</span><br><span class="line"><span class="comment">//输出430</span></span><br></pre></td></tr></table></figure><p><strong>es5手动实现一下</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">myReduce</span>(<span class="params">cb, initValue</span>)&#123;</span><br><span class="line">    <span class="comment">//不对空数组进行检测</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">length</span> == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//不改变原数组，不暴露原数组给调用者</span></span><br><span class="line">        <span class="keyword">var</span> arr = <span class="variable language_">this</span>.<span class="title function_">slice</span>();</span><br><span class="line">        <span class="keyword">var</span> startIndex = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//如果有传第二个参数，则从索引为0开始遍历，否则initValue = arr[0]从索引为1开始遍历</span></span><br><span class="line">        initValue ? startIndex = <span class="number">0</span> : initValue = arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=startIndex; i&lt;arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">            initValue = <span class="title function_">cb</span>(initValue, arr[i], i, arr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> initValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myReduce</span> = myReduce;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><ol start="6"><li><p><strong>some(判断是否含有符合条件的元素，返回布尔值)</strong></p><p> some() 方法用于检测数组中的元素是否满足指定条件（函数提供）。</p><p> some() 方法会依次执行数组的每个元素：</p><p> 如果有一个元素满足条件，则表达式返回true , 剩余的元素不会再执行检测。<br> 如果没有满足条件的元素，则返回false。</p><p> 注意： some() 不会对空数组进行检测。</p><p> 注意： some() 不会改变原始数组。</p><p> 回调函数参数：<br> currentValue  必需。当前元素；<br> index  可选。当前元素的索引值；<br> arr  可选。当前元素所属的数组对象。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ages = [<span class="number">3</span>, <span class="number">10</span>, <span class="number">18</span>, <span class="number">20</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ages.<span class="title function_">some</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> item &gt; <span class="number">28</span>;</span><br><span class="line">&#125;))</span><br><span class="line"><span class="comment">//输出false</span></span><br></pre></td></tr></table></figure><h4 id="node-一些脚本"><a href="#node-一些脚本" class="headerlink" title="node 一些脚本"></a>node 一些脚本</h4><h4 id="深度读取文件内的所有文件名"><a href="#深度读取文件内的所有文件名" class="headerlink" title="深度读取文件内的所有文件名"></a>深度读取文件内的所有文件名</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> join = path.<span class="property">join</span></span><br><span class="line"><span class="keyword">const</span> regx = <span class="regexp">/\.vue$/</span></span><br><span class="line"><span class="keyword">const</span> lessRegx = <span class="regexp">/\.less$/</span></span><br><span class="line"><span class="keyword">let</span> url = <span class="title function_">join</span>(__dirname, <span class="string">&#x27;/views&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDirs</span>(<span class="params">path</span>) &#123;</span><br><span class="line"><span class="keyword">let</span> dirs = []</span><br><span class="line"><span class="keyword">let</span> files = fs.<span class="title function_">readdirSync</span>(path)</span><br><span class="line"><span class="comment">// console.log(files);</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; files.<span class="property">length</span>; i++) &#123;</span><br><span class="line"><span class="keyword">if</span>(lessRegx.<span class="title function_">test</span>(files[i])) <span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> (!regx.<span class="title function_">test</span>(files[i])) &#123;</span><br><span class="line"><span class="keyword">let</span> nextUrl = <span class="title function_">join</span>(path, <span class="string">`/<span class="subst">$&#123;files[i]&#125;</span>`</span>)</span><br><span class="line"><span class="comment">// console.log(nextUrl, &#x27;false&#x27;);</span></span><br><span class="line">dirs = [...dirs, ...<span class="title function_">getDirs</span>(nextUrl)]</span><br><span class="line"><span class="comment">// console.log(files[i], &#x27;files============&#x27;)</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// console.log(files[i], &#x27;true&#x27;);</span></span><br><span class="line">dirs.<span class="title function_">push</span>(files[i])</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dirs</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// console.log(regx.test(&#x27;Login.vue&#x27;),&#x27;+++&#x27;)</span></span><br><span class="line"><span class="title function_">getDirs</span>(url)</span><br><span class="line"><span class="comment">// console.log(getDirs(url))</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="处理a链接下载视频，txt等文件会自动打开的问题"><a href="#处理a链接下载视频，txt等文件会自动打开的问题" class="headerlink" title="处理a链接下载视频，txt等文件会自动打开的问题"></a>处理a链接下载视频，txt等文件会自动打开的问题</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 关键部分后端设置响应头proxyResponse.headers[&#x27;Content-Disposition&#x27;] = &#x27;attachment;filename=test.mp4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用到代理是因为视频的链接是在腾讯云无法设置  需要转发一下</span></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> postData = querystring.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">  <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;你好世界&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  <span class="attr">hostname</span>: <span class="string">&#x27;1500002279.vod2.myqcloud.com&#x27;</span>,</span><br><span class="line">  <span class="attr">port</span>: <span class="number">80</span>,</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/6c9892fcvodcq1500002279/e2b9bed05285890809008953732/f0.mp4&#x27;</span>,</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">  <span class="comment">// headers: &#123;</span></span><br><span class="line">  <span class="comment">//   &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;,</span></span><br><span class="line">  <span class="comment">//   &#x27;Content-Length&#x27;: Buffer.byteLength(postData)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Method&#x27;</span>, <span class="string">&#x27;GET,POST&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">url</span>)</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">url</span> === <span class="string">&#x27;/getVideo&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> proxy = http.<span class="title function_">request</span>(options, <span class="function">(<span class="params">proxyResponse</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`状态码: <span class="subst">$&#123;res.statusCode&#125;</span>`</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`响应头: <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(res.headers)&#125;</span>`</span>);</span><br><span class="line">      <span class="comment">// res.setEncoding(&#x27;utf8&#x27;);</span></span><br><span class="line">      proxyResponse.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// console.log(`响应主体: $&#123;chunk&#125;`);</span></span><br><span class="line">        res.<span class="title function_">write</span>(chunk, <span class="string">&#x27;binary&#x27;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">      proxyResponse.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;响应中已无数据&#x27;</span>);</span><br><span class="line">        res.<span class="title function_">end</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">      proxyResponse.<span class="property">headers</span>[<span class="string">&#x27;Content-Disposition&#x27;</span>] = <span class="string">&#x27;attachment;filename=test.mp4&#x27;</span></span><br><span class="line">      res.<span class="title function_">writeHead</span>(proxyResponse.<span class="property">statusCode</span>, proxyResponse.<span class="property">headers</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    proxy.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`请求遇到问题: <span class="subst">$&#123;e.message&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//data只有当请求体数据进来时才会触发</span></span><br><span class="line">    <span class="comment">//尽管没有请求体数据进来，data还是要写，否则不会触发end事件</span></span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="keyword">function</span>(<span class="params">chunk</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;in request length:&#x27;</span>, chunk.<span class="property">length</span>);</span><br><span class="line">      proxy.<span class="title function_">write</span>(chunk, <span class="string">&#x27;binary&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">//向proxy发送求情，这里end方法必须被调用才能发起代理请求</span></span><br><span class="line">      <span class="comment">//所有的客户端请求都需要通过end来发起</span></span><br><span class="line">      proxy.<span class="title function_">end</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.<span class="property">url</span> === <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">readStaticFile</span>(res)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(req.<span class="property">url</span> === <span class="string">&#x27;/favicon.ico&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;error url&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">8090</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readStaticFile</span>(<span class="params">res</span>) &#123;</span><br><span class="line">  <span class="comment">// 读取对应路径的文件</span></span><br><span class="line">  fs.<span class="title function_">readFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;index.html&#x27;</span>), <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 找不到文件则返回404</span></span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">end</span>(<span class="string">&quot;404&quot;</span>);</span><br><span class="line">    <span class="comment">// res.end来返回上面读取的内容</span></span><br><span class="line">    res.<span class="title function_">end</span>(data)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--通过a链接直接访问接口即可--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;down&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://localhost:8090/getVideo&quot;</span>&gt;</span>下载1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="整理-node-sass-安装失败的原因及解决办法"><a href="#整理-node-sass-安装失败的原因及解决办法" class="headerlink" title="整理 node-sass 安装失败的原因及解决办法"></a>整理 node-sass 安装失败的原因及解决办法</h4><p>直接使用 <code>cnpm</code> 或者使用淘宝镜像源</p><blockquote><p>npm i node-sass –sass_binary_site&#x3D;<a href="https://npm.taobao.org/mirrors/node-sass/">https://npm.taobao.org/mirrors/node-sass/</a></p></blockquote><p>全局镜像</p><blockquote><p>npm config set sass_binary_site <a href="https://npm.taobao.org/mirrors/node-sass/">https://npm.taobao.org/mirrors/node-sass/</a></p></blockquote><p>也可以设置系统环境变量的方式。示例<br>linux、mac 下</p><blockquote><p>SASS_BINARY_SITE&#x3D;<a href="https://npm.taobao.org/mirrors/node-sass/">https://npm.taobao.org/mirrors/node-sass/</a> npm install node-sass</p></blockquote><p> window 下</p><blockquote><p>set SASS_BINARY_SITE&#x3D;<a href="https://npm.taobao.org/mirrors/node-sass/">https://npm.taobao.org/mirrors/node-sass/</a> &amp;&amp; npm install node-sass</p></blockquote><p><strong>注意：</strong> 安装失败后重装需要先 <code>uninstall</code> 再安装</p><h4 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h4><blockquote><p>使用qs  get请求传数组</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span></span><br><span class="line">request.<span class="title function_">get</span>(<span class="string">&#x27;/standingBook/workOrderPlan/pageList&#x27;</span>, &#123;</span><br><span class="line">    params,</span><br><span class="line">    <span class="attr">paramsSerializer</span>: <span class="function">(<span class="params">data</span>) =&gt;</span> qs.<span class="title function_">stringify</span>(data, &#123; <span class="attr">arrayFormat</span>: <span class="string">&#x27;repeat&#x27;</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p><code>Content-Type&#39;: &#39;application/x-www-form-urlencoded; charset=UTF-8</code> 参数格式 a&#x3D;1&amp;b&#x3D;2</p></blockquote><p><img src="https://gitee.com/hisai/image-bed/raw/master/axios-format/forn-urlcode.jpg" alt="image"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span></span><br><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;api.esac&#125;</span>/uniformExchangeDetails/getCleanTotalNum`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: qs.<span class="title function_">stringify</span>(data, &#123; <span class="attr">indices</span>: <span class="literal">false</span> &#125;)，</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">`Content-Type&#x27;: &#x27;application/x-www-form-urlencoded; charset=UTF-8`</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><blockquote><p><code>multipart/form-data</code> 参数格式 <strong>多用于文件上传使用</strong> <code>new FormData()</code><br><img src="https://gitee.com/hisai/image-bed/raw/master/axios-format/formdata.jpg" alt="image"></p></blockquote><blockquote><p><code>json</code> </p></blockquote><p><img src="https://gitee.com/hisai/image-bed/raw/master/axios-format/json.jpg" alt="image"></p><h4 id="跨页面通信"><a href="#跨页面通信" class="headerlink" title="跨页面通信"></a>跨页面通信</h4><p><strong>1. 回调函数</strong></p><p><code>index1.html</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">cb</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;回调&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;index2.html&#x27;</span>, <span class="string">&#x27;_blank&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>index2.html</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">opener</span>.<span class="property">cb</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">opener</span>.<span class="title function_">cb</span>()</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure><p><strong>2. postmessage</strong></p><p><code>index1.html</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">&#123; data, origin, source &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (origin !== <span class="variable language_">window</span>.<span class="property">loaction</span>.<span class="property">host</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;index2.html&#x27;</span>, <span class="string">&#x27;_blank&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>index2.html</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = &#123;&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">opener</span>.<span class="title function_">postMessage</span>(data, <span class="variable language_">window</span>.<span class="property">opener</span>.<span class="property">loaction</span>.<span class="property">origin</span>)</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure><p><strong>3. storage 通过监听本地存储实现</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">addEventListener</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;storage&quot;</span>, handleStorage, <span class="literal">false</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">attachEvent</span>(<span class="string">&quot;onstorage&quot;</span>, handleStorage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4. vue $bus</strong></p><ol><li>新建<code>modules.js</code></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vue</span></span><br></pre></td></tr></table></figure><p><code>index1.html</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> middleUtils <span class="keyword">from</span> <span class="string">&#x27;./middleUtil.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line">middleUtils.$on(<span class="string">&#x27;getData&#x27;</span>,  <span class="function">(<span class="params">data</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;收到消息&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>index2.html</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> middleUtils <span class="keyword">from</span> <span class="string">&#x27;./middleUtil.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line">middleUtils.$emit(<span class="string">&#x27;getData&#x27;</span>,<span class="string">&#x27;data&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="iframe-通信-（postmessage）"><a href="#iframe-通信-（postmessage）" class="headerlink" title="iframe 通信 （postmessage）"></a>iframe 通信 （postmessage）</h4><p><code>index1.html</code> 子页面</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">parent</span>.<span class="title function_">postMessage</span>(</span><br><span class="line">    &#123; <span class="attr">code</span>: <span class="number">0</span>, <span class="attr">msg</span>: <span class="string">&quot;修改成功&quot;</span>, <span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">allData</span> &#125;,</span><br><span class="line">    <span class="string">&quot;*&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>index2.html</code> 父级页面（引入iframe）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">iframe</span>.<span class="property">contentWindow</span>.<span class="property">parent</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">&#123; data &#125;</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// console.log(&#x27;onMessage--&gt;&gt;&#x27;, data)</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">随手记录js手写, axios请求, 页面通信...</summary>
    
    
    
    <category term="随记" scheme="https://hisai3.github.io/hisai3.github.io/categories/%E9%9A%8F%E8%AE%B0/"/>
    
    
    <category term="javascript" scheme="https://hisai3.github.io/hisai3.github.io/tags/javascript/"/>
    
    <category term="axios" scheme="https://hisai3.github.io/hisai3.github.io/tags/axios/"/>
    
  </entry>
  
  <entry>
    <title>Scss</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Scss/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Scss/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:02:02.198Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Scss"><a href="#Scss" class="headerlink" title="Scss"></a>Scss</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>scss定义变量很简单就是加个 $ ,可以写在{} 内也可以不写，代表着全局变量和局部变量</p><p><strong>项目中想全局使用需要配置</strong></p><blockquote><ol><li>使用 <code>sass-resources-loader</code></li><li><a href="https://github.com/staven630/vue-cli4-config#log">vue-cli中配置scss全局变量</a></li></ol></blockquote><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$width</span>:<span class="number">5px</span>;</span><br><span class="line"><span class="selector-class">.main</span>&#123;</span><br><span class="line">    <span class="variable">$heigth</span>：<span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="variable">$width</span>;</span><br><span class="line">    <span class="selector-class">.child</span>&#123;</span><br><span class="line">        heigth:heigth;</span><br><span class="line">        <span class="attribute">width</span>:<span class="variable">$width</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="插值语句"><a href="#插值语句" class="headerlink" title="插值语句"></a>插值语句</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span>: foo;</span><br><span class="line"><span class="variable">$attr</span>: border;</span><br><span class="line"><span class="selector-tag">p</span>.#&#123;<span class="variable">$name</span>&#125; &#123;</span><br><span class="line">  #&#123;<span class="variable">$attr</span>&#125;-<span class="attribute">color</span>: blue;</span><br><span class="line">  <span class="variable">$font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="variable">$line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">font</span>: #&#123;<span class="variable">$font-size</span>&#125;/#&#123;<span class="variable">$line-height</span>&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="map-get-amp-maps"><a href="#map-get-amp-maps" class="headerlink" title="map-get()  &amp; maps"></a>map-get()  &amp; maps</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// maps</span></span><br><span class="line"><span class="variable">$social-colors</span>: (</span><br><span class="line">    dribble: <span class="number">#ea4c89</span>,</span><br><span class="line">    facebook: <span class="number">#3b5998</span>,</span><br><span class="line">    github: <span class="number">#171515</span>,</span><br><span class="line">    google: <span class="number">#db4437</span>,</span><br><span class="line">    twitter: <span class="number">#55acee</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设要获取 facebook 键值对应的值 #3b5998，我们就可以使用 map-get() 函数来实现：</span></span><br><span class="line"><span class="selector-class">.btn-dribble</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">map-get</span>(<span class="variable">$social-colors</span>,facebook);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后</span></span><br><span class="line"><span class="selector-class">.btn-dribble</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#3b5998</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="extend-指令"><a href="#extend-指令" class="headerlink" title="@extend 指令"></a>@extend 指令</h3><p><strong>在编译的时候，scss会在合并样式的时候，避免重复的css</strong></p><blockquote><p> % 占位符: 编译结果 % 实际时使用 extend 继承的类</p></blockquote><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.error</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.seriousError</span> &#123;</span><br><span class="line">  <span class="keyword">@extend</span> .error;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line"><span class="selector-class">.error</span>, <span class="selector-class">.seriousError</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.seriousError</span> &#123;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果.error 只是用于extend, 可以用 % 占位符</span></span><br><span class="line">%error &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.seriousError</span> &#123;</span><br><span class="line">  <span class="keyword">@extend</span> %error;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果 .seriousError 替代了 %error</span></span><br><span class="line"><span class="selector-class">.seriousError</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.seriousError</span> &#123;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="each指令"><a href="#each指令" class="headerlink" title="@each指令"></a>@each指令</h3><p><strong>动态生成类名</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$colors</span>: (</span><br><span class="line">  blue: <span class="number">#008fff</span>,</span><br><span class="line">  grey: <span class="number">#909299</span>,</span><br><span class="line">  orange: <span class="number">#fa8c16</span>,</span><br><span class="line">  red: <span class="number">#fe5951</span>,</span><br><span class="line">  green: <span class="number">#2ac66a</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">@each</span> <span class="variable">$name</span>, <span class="variable">$color</span> in <span class="variable">$colors</span> &#123;</span><br><span class="line">     &amp;.#&#123;<span class="variable">$name</span>&#125; &#123;</span><br><span class="line">       <span class="selector-class">.label</span> &#123;</span><br><span class="line">         &amp;<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">           <span class="attribute">background-color</span>: <span class="variable">$color</span>;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.</span></span><br><span class="line"><span class="keyword">@each</span> <span class="variable">$var</span> in(left,center,right)&#123;</span><br><span class="line">    <span class="selector-class">.text-</span>#&#123;<span class="variable">$var</span>&#125;&#123;</span><br><span class="line"><span class="attribute">text-align</span>:<span class="variable">$var</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.text-left</span>&#123;</span><br><span class="line">    <span class="attribute">text-align</span><span class="selector-pseudo">:left</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.text-center</span>&#123;</span><br><span class="line">    <span class="attribute">text-align</span>:center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.text-right</span>&#123;</span><br><span class="line">    <span class="attribute">text-align</span><span class="selector-pseudo">:right</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="mixin指令"><a href="#mixin指令" class="headerlink" title="@mixin指令"></a>@mixin指令</h3><p><strong>生成不同方向的三角形</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一个三角的函数 实现不同方向的三角加兼容ie6</span></span><br><span class="line"><span class="comment">//第一个参数传入方向</span></span><br><span class="line"><span class="comment">//第二个参数传入大小</span></span><br><span class="line"><span class="comment">//第三个参数传入颜色</span></span><br><span class="line"><span class="comment">//注意:传入参数中间必须逗号分隔</span></span><br><span class="line"><span class="keyword">@mixin</span> triangle(<span class="variable">$x</span>, <span class="variable">$y</span>:<span class="number">10px</span>, <span class="variable">$z</span>:white )&#123;</span><br><span class="line">    <span class="keyword">@if</span> <span class="variable">$x</span> == <span class="string">&quot;top&quot;</span>&#123;</span><br><span class="line">        <span class="attribute">border-width</span>: <span class="variable">$y</span>;</span><br><span class="line">        <span class="attribute">border-color</span>:transparent transparent <span class="variable">$z</span> transparent;</span><br><span class="line">        <span class="attribute">border-style</span>: dashed dashed solid dashed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">@else</span> if <span class="variable">$x</span> == <span class="string">&quot;bottom&quot;</span>&#123;</span><br><span class="line">        <span class="attribute">border-width</span>: <span class="variable">$y</span>;</span><br><span class="line">        <span class="attribute">border-color</span>: <span class="variable">$z</span> transparent transparent transparent;</span><br><span class="line">        <span class="attribute">border-style</span>: solid dashed dashed dashed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">@else</span> if <span class="variable">$x</span> == <span class="string">&quot;left&quot;</span>&#123;</span><br><span class="line">        <span class="attribute">border-width</span>: <span class="variable">$y</span>;</span><br><span class="line">        <span class="attribute">border-color</span>:transparent <span class="variable">$z</span> transparent transparent;</span><br><span class="line">        <span class="attribute">border-style</span>: dashed solid dashed dashed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">@else</span> if <span class="variable">$x</span> == <span class="string">&quot;right&quot;</span>&#123;</span><br><span class="line">        <span class="attribute">border-width</span>: <span class="variable">$y</span>;</span><br><span class="line">        <span class="attribute">border-color</span>:transparent transparent transparent <span class="variable">$z</span>;</span><br><span class="line">        <span class="attribute">border-style</span>: dashed dashed dashed solid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">    <span class="keyword">@include</span> triangle(right, <span class="number">200px</span>, red);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="变量拼接"><a href="#变量拼接" class="headerlink" title="变量拼接"></a>变量拼接</h3><p><code>#&#123;$animal&#125;</code>表示变量，后面直接连接想要的字符串</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sass style</span></span><br><span class="line"><span class="comment">//-------------------------------</span></span><br><span class="line"><span class="variable">$animal-list</span>: puma, sea-slug, egret, salamander;</span><br><span class="line"><span class="keyword">@each</span> <span class="variable">$animal</span> in <span class="variable">$animal-list</span> &#123;</span><br><span class="line">  .#&#123;<span class="variable">$animal</span>&#125;-<span class="attribute">icon</span> &#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;/images/#&#123;$animal&#125;.png&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//css style</span></span><br><span class="line"><span class="comment">//-------------------------------</span></span><br><span class="line"><span class="selector-class">.puma-icon</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;/images/puma.png&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sea-slug-icon</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;/images/sea-slug.png&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.egret-icon</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;/images/egret.png&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.salamander-icon</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;/images/salamander.png&#x27;</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="主题色"><a href="#主题色" class="headerlink" title="主题色"></a>主题色</h3><blockquote><p>方案一</p></blockquote><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成主题类名</span></span><br><span class="line"><span class="keyword">@mixin</span> theme(<span class="variable">$name</span>, <span class="variable">$color</span>) &#123;</span><br><span class="line">    <span class="selector-class">.theme-</span>#&#123;<span class="variable">$name</span>&#125; &#123;</span><br><span class="line">        <span class="selector-class">.theme-color-</span>#&#123;<span class="variable">$name</span>&#125; &#123;</span><br><span class="line">            <span class="attribute">color</span>: <span class="variable">$color</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.theme-border-color-</span>#&#123;<span class="variable">$name</span>&#125; &#123;</span><br><span class="line">            <span class="attribute">border-color</span>: <span class="variable">$color</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.theme-bgcolor-</span>#&#123;<span class="variable">$name</span>&#125; &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: <span class="variable">$color</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主题色</span></span><br><span class="line"><span class="variable">$theme-list</span>: (</span><br><span class="line">  blue: <span class="variable">$theme-color-blue</span>,</span><br><span class="line">  grey: <span class="variable">$theme-color-grey</span>,</span><br><span class="line">  orange: <span class="variable">$theme-color-orange</span>,</span><br><span class="line">  red: <span class="variable">$theme-color-red</span>,</span><br><span class="line">  green: <span class="variable">$theme-color-green</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 循环生成不同主题</span></span><br><span class="line"><span class="keyword">@echo</span> <span class="variable">$name</span>, <span class="variable">$color</span> in <span class="variable">$theme-list</span> &#123;</span><br><span class="line">    <span class="keyword">@includes</span> theme(<span class="variable">$name</span>, <span class="variable">$color</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>方案二</p></blockquote><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$img_base_url</span>: <span class="string">&quot;./&quot;</span>;</span><br><span class="line"><span class="variable">$img_time</span>: <span class="string">&quot;Snipaste_2021-12-07_22-42-45.png&quot;</span>;</span><br><span class="line"><span class="variable">$themes</span>: (</span><br><span class="line">    light: (</span><br><span class="line">        //字体</span><br><span class="line">        base_color: <span class="number">#414141</span>,</span><br><span class="line">        font_color2: white,</span><br><span class="line">        </span><br><span class="line">        //背景</span><br><span class="line">        base_bg_color: <span class="number">#fff</span>,</span><br><span class="line">        background_color2: <span class="number">#f0f2f5</span>,</span><br><span class="line">        background_color3: red,</span><br><span class="line">        background_color4: <span class="number">#2674e7</span>,</span><br><span class="line">        </span><br><span class="line">        //边框</span><br><span class="line">        base_border_color: <span class="number">#3d414a</span>,</span><br><span class="line">        bgurl: <span class="built_in">url</span>(<span class="string">&#x27;./Snipaste_2021-12-07_22-42-45.png&#x27;</span>),</span><br><span class="line"></span><br><span class="line">        icon_time: <span class="built_in">url</span>(<span class="string">&#x27;#&#123;$img_base_url&#125;#&#123;$img_time&#125;&#x27;</span>)</span><br><span class="line">    ),</span><br><span class="line">    </span><br><span class="line">    dark: (</span><br><span class="line">        //字体</span><br><span class="line">        base_color: <span class="number">#a7a7a7</span>,</span><br><span class="line">        font_color2: white,</span><br><span class="line">        </span><br><span class="line">        //背景</span><br><span class="line">        base_bg_color: <span class="number">#1b2531</span>,</span><br><span class="line">        background_color2: <span class="number">#283142</span>,</span><br><span class="line">        background_color3: <span class="number">#1e6ceb</span>,</span><br><span class="line">        background_color4: <span class="number">#323e4e</span>,</span><br><span class="line">    </span><br><span class="line">        //边框</span><br><span class="line">        base_border_color: <span class="number">#3d414a</span>,</span><br><span class="line">        bgurl: <span class="built_in">url</span>(<span class="string">&#x27;./Snipaste_2021-12-07_22-42-45.png&#x27;</span>),</span><br><span class="line">        icon_time: <span class="built_in">url</span>(<span class="string">&#x27;#&#123;$img_base_url&#125;#&#123;$img_time&#125;&#x27;</span>)</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历主题map</span></span><br><span class="line"><span class="keyword">@mixin</span> themeify &#123;</span><br><span class="line">    <span class="keyword">@each</span> <span class="variable">$theme-name</span>, <span class="variable">$theme-map</span> in <span class="variable">$themes</span> &#123;</span><br><span class="line">        <span class="comment">//!global 把局部变量强升为全局变量</span></span><br><span class="line">        <span class="variable">$theme-map</span>: <span class="variable">$theme-map</span> !global;</span><br><span class="line">        <span class="comment">//判断html的data-theme的属性值  #&#123;&#125;是sass的插值表达式</span></span><br><span class="line">        <span class="comment">//&amp; sass嵌套里的父容器标识   @content是混合器插槽，像vue的slot</span></span><br><span class="line">        <span class="selector-attr">[data-theme=<span class="string">&quot;#&#123;$theme-name&#125;&quot;</span>]</span> &amp; &#123;</span><br><span class="line">            <span class="keyword">@content</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明一个根据Key获取颜色的function</span></span><br><span class="line"><span class="keyword">@function</span> themed(<span class="variable">$key</span>) &#123;</span><br><span class="line">    <span class="keyword">@return</span> map-get(<span class="variable">$theme-map</span>, <span class="variable">$key</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取背景颜色</span></span><br><span class="line"><span class="keyword">@mixin</span> background_<span class="attribute">color</span>(<span class="variable">$color</span>: <span class="string">&quot;base_bg_color&quot;</span>, <span class="variable">$important</span>: false) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="keyword">@if</span> <span class="variable">$important</span> &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>) <span class="meta">!important</span>;</span><br><span class="line">        &#125; <span class="keyword">@else</span> &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="keyword">@content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取字体颜色</span></span><br><span class="line"><span class="keyword">@mixin</span> font_<span class="attribute">color</span>(<span class="variable">$color</span>: <span class="string">&quot;base_color&quot;</span>, <span class="variable">$important</span>: false) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="keyword">@if</span> <span class="variable">$important</span> &#123;</span><br><span class="line">            <span class="attribute">color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>) <span class="meta">!important</span>;</span><br><span class="line">        &#125; <span class="keyword">@else</span> &#123;</span><br><span class="line">            <span class="attribute">color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="keyword">@content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取边框颜色</span></span><br><span class="line"><span class="keyword">@mixin</span> border_<span class="attribute">color</span>(<span class="variable">$color</span>: <span class="string">&quot;base_border_color&quot;</span>, <span class="variable">$important</span>: false) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="keyword">@if</span> <span class="variable">$important</span> &#123;</span><br><span class="line">            <span class="attribute">border-color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>) <span class="meta">!important</span>;</span><br><span class="line">        &#125; <span class="keyword">@else</span> &#123;</span><br><span class="line">            <span class="attribute">border-color</span>: <span class="built_in">themed</span>(<span class="variable">$color</span>);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="keyword">@content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取背景图</span></span><br><span class="line"><span class="keyword">@mixin</span> bg_image(<span class="variable">$url</span>, <span class="variable">$important</span>: false) &#123;</span><br><span class="line">    <span class="keyword">@include</span> themeify &#123;</span><br><span class="line">        <span class="keyword">@if</span> <span class="variable">$important</span> &#123;</span><br><span class="line">            <span class="attribute">background-image</span>: <span class="built_in">themed</span>(<span class="variable">$url</span>) <span class="meta">!important</span>;</span><br><span class="line">        &#125; <span class="keyword">@else</span> &#123;</span><br><span class="line">            <span class="attribute">background-image</span>: <span class="built_in">themed</span>(<span class="variable">$url</span>);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="keyword">@content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .box2 会替代 %bg-color</span></span><br><span class="line">%bg-<span class="attribute">color</span> &#123;</span><br><span class="line">    <span class="keyword">@include</span> background_<span class="attribute">color</span>()</span><br><span class="line">&#125;</span><br><span class="line">.bd-color &#123;</span><br><span class="line">    <span class="keyword">@include</span> bg_image(<span class="string">&#x27;icon_time&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">.box2 &#123;</span><br><span class="line">    <span class="keyword">@include</span> font_<span class="attribute">color</span>();</span><br><span class="line">    <span class="keyword">@extend</span> %bg-color;</span><br><span class="line">    <span class="keyword">@extend</span> .bd-color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="selector-class">.common-util</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 多次 include 编译会有很多重复的类（不会编译出&quot;,&quot;选择器, 最好使用 @extend）</span></span><br><span class="line">    <span class="keyword">@include</span> font_<span class="attribute">color</span>(<span class="string">&quot;font_color1&quot;</span>);</span><br><span class="line">    <span class="keyword">@include</span> background_<span class="attribute">color</span>(<span class="string">&quot;background_color1&quot;</span>);</span><br><span class="line">    <span class="keyword">@include</span> border_<span class="attribute">color</span>(<span class="string">&quot;border_color1&quot;</span>);</span><br><span class="line">    <span class="comment">// extend</span></span><br><span class="line">    <span class="comment">// @extend .bg-color;</span></span><br><span class="line">    <span class="comment">// @extend .bd-color;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.bg-color</span> &#123;</span><br><span class="line">    <span class="keyword">@include</span> background_<span class="attribute">color</span>(<span class="string">&quot;background_color1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.bd-color</span> &#123;</span><br><span class="line">    <span class="keyword">@include</span> border_<span class="attribute">color</span>(<span class="string">&quot;border_color1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方案三</p><p><code>webpack-theme-color-replacer</code></p><p><a href="https://www.npmjs.com/package/webpack-theme-color-replacer/v/1.2.17">npm</a><br><a href="https://www.cnblogs.com/jiaoshou/p/16178580.html">参考1</a><br><a href="https://blog.csdn.net/pnjtvxcp/article/details/108141255">参考2</a><br><a href="https://www.jianshu.com/p/10a9fe676145">element-ui</a><br><a href="https://blog.csdn.net/qq_39172655/article/details/123006896">ant-design-vue</a></p><blockquote><p>npm i -D webpack-theme-color-replacer</p></blockquote><p><code>vue.config.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeColorReplacer</span> = <span class="built_in">require</span>(<span class="string">&#x27;webpack-theme-color-replacer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">configureWebpack</span>: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ThemeColorReplacer</span>(&#123;</span><br><span class="line"><span class="comment">// 需要提取到css文件的颜色数组（可以传入多个颜色值），支持rgb和hsl,也就是换肤改变颜色的变量</span></span><br><span class="line"> <span class="attr">matchColors</span>: [<span class="string">&#x27;#9564ca&#x27;</span>],</span><br><span class="line"><span class="comment">//可选.输出css文件名，支持[contenthash]和[hash]</span></span><br><span class="line"><span class="attr">fileName</span>: <span class="string">&#x27;css/theme-colors-[contenthash:8].css&#x27;</span>,</span><br><span class="line"> <span class="comment">// 可选的。将 css 文本注入 js 文件，不再需要下载 `theme-colors-xxx.css`。</span></span><br><span class="line"><span class="attr">injectCss</span>: <span class="literal">true</span>, </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>模板内修改主题</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// const client = require(&#x27;webpack-theme-color-replacer/client&#x27;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> client <span class="keyword">from</span> <span class="string">&quot;webpack-theme-color-replacer/client&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 这里就直接5秒后换色了，模拟了用户点击一次换肤的过程</span></span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">changeThemeColor</span>(<span class="string">&#x27;#69af23&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="number">5000</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 设置css新值，点击换肤时候会获取到新的颜色值，然后调用这个方法就行了</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">changeThemeColor</span>(<span class="params">newColor</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// newColors必须是个数组形式，数组长度一定要和配置中的matchColors长度一致，否则缺少的颜色就会出现问题</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// sass里的lighten貌似是使用hsl颜色增加亮度。 varyColor.js   里面的lighten、darke其实是将当前颜色与白色进行混合，与element-ui的色系一致。</span></span></span><br><span class="line"><span class="language-javascript">      client.<span class="property">changer</span>.<span class="title function_">changeColor</span>(&#123; <span class="attr">newColors</span>: [<span class="string">&#x27;&#x27;</span>+newColor] &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 基础色</span><br><span class="line">$color: #9564ca;</span><br><span class="line">.item&#123;</span><br><span class="line">  height: 30px;</span><br><span class="line">  margin-top: 4px;</span><br><span class="line">&#125;</span><br><span class="line">.item-0 &#123;</span><br><span class="line">  background: $color; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Scss&quot;&gt;&lt;a href=&quot;#Scss&quot; class=&quot;headerlink&quot; title=&quot;Scss&quot;&gt;&lt;/a&gt;Scss&lt;/h2&gt;&lt;h3 id=&quot;变量&quot;&gt;&lt;a href=&quot;#变量&quot; class=&quot;headerlink&quot; title=&quot;变量&quot;&gt;&lt;/a&gt;变量&lt;/h</summary>
      
    
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/categories/css/"/>
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/tags/css/"/>
    
    <category term="Scss" scheme="https://hisai3.github.io/hisai3.github.io/tags/Scss/"/>
    
  </entry>
  
  <entry>
    <title>Vue指令 v-model</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Vue%E6%8C%87%E4%BB%A4%20v-model/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Vue%E6%8C%87%E4%BB%A4%20v-model/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:08:39.689Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Vue指令-v-model"><a href="#Vue指令-v-model" class="headerlink" title="Vue指令 v-model"></a>Vue指令 v-model</h2><p>Vue自定义组件使用 <code>v-model</code></p><ol><li>方式一 v-model 的本质 <code>value</code>属性  <code>input</code>事件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">tabs</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">value</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">onChange</span>(<span class="params">index</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;input&#x27;</span>, index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件中使用</span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">tab</span> <span class="attr">v-model</span>=<span class="string">&quot;current&quot;</span> /&gt;</span></span></span><br><span class="line">     </span><br></pre></td></tr></table></figure><ol start="2"><li>官方文档提供方法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">model</span>: &#123;</span><br><span class="line">    <span class="attr">prop</span>: <span class="string">&#x27;checked&#x27;</span>, <span class="comment">// 设置响应属性</span></span><br><span class="line">    <span class="attr">event</span>: <span class="string">&#x27;change&#x27;</span>  <span class="comment">// 必须派发一个‘event’定义的事件</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">checked</span>: <span class="title class_">Boolean</span> <span class="comment">// 必须有 model.prop 定义的属性</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">onChange</span>(<span class="params">index</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;change&#x27;</span>, index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件中使用</span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">tab</span> <span class="attr">v-model</span>=<span class="string">&quot;current&quot;</span> /&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Vue指令-v-model&quot;&gt;&lt;a href=&quot;#Vue指令-v-model&quot; class=&quot;headerlink&quot; title=&quot;Vue指令 v-model&quot;&gt;&lt;/a&gt;Vue指令 v-model&lt;/h2&gt;&lt;p&gt;Vue自定义组件使用 &lt;code&gt;v-model&lt;/</summary>
      
    
    
    
    
    <category term="Vue指令" scheme="https://hisai3.github.io/hisai3.github.io/tags/Vue%E6%8C%87%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Vue插槽</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Vue%E6%8F%92%E6%A7%BD/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Vue%E6%8F%92%E6%A7%BD/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:08:45.195Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Vue插槽"><a href="#Vue插槽" class="headerlink" title="Vue插槽"></a>Vue插槽</h2><p>定义 <code>navigation-link </code>组件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">&quot;url&quot;</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span>啦啦啦啦啦了--这是默认内容<span class="tag">&lt;/<span class="name">slot</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">navigation-link</span> <span class="attr">url</span>=<span class="string">&quot;/profile&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加一个 Font Awesome 图标 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-user&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  Your Profile</span><br><span class="line"><span class="tag">&lt;/<span class="name">navigation-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 如果 &lt;navigation-link&gt; 没有包含一个 &lt;slot&gt; 元素，则该组件起始标签和结束标签之间的任何内容都会被抛弃。 --&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>具名插槽</p><p>定义 <code>&lt;base-layout&gt;</code>  组件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 我们希望把页头放这里 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- name 默认为 default --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 我们希望把页脚放这里 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>向具名插槽提供内容，可以在一个 <code>&lt;template&gt;</code> 元素上使用 <code>v-slot</code> 指令，并以 <code>v-slot</code> 的参数的形式提供其名称</p><p><strong>v-slot 只能添加在 <template> 上</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">base-layout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Here might be a page title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 任何没有被包裹在带有 v-slot 的 &lt;template&gt; 中的内容都会被视为默认插槽的内容。 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>A paragraph for the main content.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>And another one.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">base-layout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>作用域插槽</p><p>定义<code>&lt;current-user&gt;</code> 组件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span>&#123;&#123; user.lastName &#125;&#125;<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">current-user</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- user 实在current-user 中定义的 在父组件使用时无法获取 --&gt;</span></span><br><span class="line">  &#123;&#123; user.firstName &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">current-user</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 解决： 修改子组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">v-bind:user</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; user.lastName &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 解决： 使用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">current-user</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:default</span>=<span class="string">&quot;slotProps&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; slotProps.user.firstName &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">current-user</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>v-slot</strong> 必须在template上使用</p><p><strong>slot-scope</strong> 可以不在template上使用</p><h4 id="在render-中使用slot"><a href="#在render-中使用slot" class="headerlink" title="在render 中使用slot"></a>在render 中使用slot</h4><p><strong>使用场景:</strong> 在二次封装<code>u-table组件</code>时，多表头的<strong>递归列</strong>中的<code>slot</code>只能使用到第一层</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// scopedSlots 的使用相当于在调用组件时插入插槽的实际内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// $scopedSlots 相当于作用域插槽参数即slot绑定的数据  前提时在调用组件时有使用slot</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;CusColumn&#x27;</span>,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">column</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Object</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">treeNode</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; column, treeNode &#125; = <span class="variable language_">this</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getChild</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">return</span> data.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !item.<span class="property">isShow</span> ? (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">u-table-column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">prop</span>=<span class="string">&#123;</span> <span class="attr">item.prop</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">label</span>=<span class="string">&#123;</span> <span class="attr">item.label</span> === <span class="string">&#x27;-&#x27;</span> ? &#x27;<span class="attr">完成时间</span>&#x27; <span class="attr">:</span> <span class="attr">item.label</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">align</span>=<span class="string">&#123;</span> <span class="attr">item.align</span> || &#x27;<span class="attr">center</span>&#x27; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">fixed</span>=<span class="string">&#123;</span> <span class="attr">item.fixed</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">width</span>=<span class="string">&#123;</span> <span class="attr">item.width</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">min-width</span>=<span class="string">&#123;</span> <span class="attr">item.mWidth</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">treeNode</span>=<span class="string">&#123;</span> <span class="attr">treeNode</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">show-overflow-tooltip</span>=<span class="string">&#123;</span> <span class="attr">true</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">scopedSlots</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">default:</span> (&#123; <span class="attr">row</span>, $<span class="attr">index</span>, <span class="attr">column</span> &#125;) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                return item.isTemplate &amp;&amp; this.$scopedSlots[item.prop]</span></span><br><span class="line"><span class="language-xml">                  ? this.$scopedSlots[item.prop](&#123; row, $index, column &#125;)</span></span><br><span class="line"><span class="language-xml">                  : (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&#123;item.prop&#125;</span>&gt;</span>&#123; row[item.prop] &#125;<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  )</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          &gt;</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              ...getChild(item.children || [])</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">u-table-column</span>&gt;</span></span></span><br><span class="line">        ) : <span class="literal">null</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">getChild</span>([column])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>解析</p><p>父组件设置 slot</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">const</span> slotName = <span class="string">&#x27;topbar&#x27;</span> || <span class="string">&#x27;default&#x27;</span></span><br><span class="line">   <span class="keyword">const</span> scopeSlotChild = <span class="variable language_">this</span>.<span class="property">$slots</span>[slotName]</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123; scopeSlotChild &#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">   )</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>父组件设置 slot-scope</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> scopedSlots = &#123;</span><br><span class="line">        <span class="comment">// 默认插槽</span></span><br><span class="line">        <span class="attr">default</span>: <span class="function"><span class="params">slotProps</span> =&gt;</span> [ <span class="language-xml"><span class="tag">&lt;<span class="name">Cmp</span> <span class="attr">slotprops</span>=<span class="string">&#123;slotprops&#125;</span> /&gt;</span></span> ],</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 具名插槽</span></span><br><span class="line">        <span class="attr">footer</span>:  <span class="function"><span class="params">slotProps</span> =&gt;</span> [ <span class="language-xml"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">slotprops</span>=<span class="string">&#123;slotprops&#125;</span> /&gt;</span></span> ]</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>子组件获取 slotProps</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent </span><br><span class="line">    &#123; ...&#123;</span><br><span class="line">         <span class="attr">scopedSlots</span>: &#123;</span><br><span class="line">            <span class="attr">default</span>: <span class="function"><span class="params">scope</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.scope.data&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&gt;</span><br><span class="line">&lt;/parent&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Vue插槽&quot;&gt;&lt;a href=&quot;#Vue插槽&quot; class=&quot;headerlink&quot; title=&quot;Vue插槽&quot;&gt;&lt;/a&gt;Vue插槽&lt;/h2&gt;&lt;p&gt;定义 &lt;code&gt;navigation-link &lt;/code&gt;组件&lt;/p&gt;
&lt;figure class=&quot;high</summary>
      
    
    
    
    <category term="Vue" scheme="https://hisai3.github.io/hisai3.github.io/categories/Vue/"/>
    
    
    <category term="Vue" scheme="https://hisai3.github.io/hisai3.github.io/tags/Vue/"/>
    
  </entry>
  
  <entry>
    <title>antv填坑</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/antv%E5%A1%AB%E5%9D%91/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/antv%E5%A1%AB%E5%9D%91/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T06:42:57.709Z</updated>
    
    <content type="html"><![CDATA[<h4 id="处理table固定列出现白色间隙"><a href="#处理table固定列出现白色间隙" class="headerlink" title="处理table固定列出现白色间隙"></a>处理table固定列出现白色间隙</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> w = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.ant-table-fixed-columns-in-body&#x27;</span>).<span class="property">clientWidth</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.ant-table-fixed-right .ant-table-fixed&#x27;</span>).<span class="property">style</span>.<span class="property">width</span> = w + <span class="string">&#x27;px&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> w = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.ant-table-fixed-columns-in-body&#x27;</span>).<span class="property">clientWidth</span> </span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.ant-table-fixed-right .ant-table-fixed&#x27;</span>).<span class="property">style</span>.<span class="property">width</span> = w + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;处理table固定列出现白色间隙&quot;&gt;&lt;a href=&quot;#处理table固定列出现白色间隙&quot; class=&quot;headerlink&quot; title=&quot;处理table固定列出现白色间隙&quot;&gt;&lt;/a&gt;处理table固定列出现白色间隙&lt;/h4&gt;&lt;figure class=&quot;hi</summary>
      
    
    
    
    <category term="Vue UI" scheme="https://hisai3.github.io/hisai3.github.io/categories/Vue-UI/"/>
    
    
    <category term="antV" scheme="https://hisai3.github.io/hisai3.github.io/tags/antV/"/>
    
  </entry>
  
  <entry>
    <title>Echarts Y轴配置</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/Y%E8%BD%B4%E9%85%8D%E7%BD%AE/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/Y%E8%BD%B4%E9%85%8D%E7%BD%AE/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:17:16.657Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">yAxis</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>单位, <span class="comment">// 名称</span></span><br><span class="line">    <span class="attr">show</span>: <span class="literal">true</span>,    <span class="comment">// 是否显示 y 轴</span></span><br><span class="line">    <span class="attr">position</span>: <span class="string">&#x27;top&#x27;</span>,    <span class="comment">// y 轴的位置（&#x27;top&#x27;，&#x27;bottom&#x27;） </span></span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,    <span class="comment">// 坐标轴类型</span></span><br><span class="line">    <span class="attr">nameLocation</span>: <span class="string">&#x27;end&#x27;</span>,     <span class="comment">// 坐标轴名称显示位置</span></span><br><span class="line">    <span class="attr">nameGap</span>: <span class="number">15</span>,     <span class="comment">// 坐标轴名称与轴线之间的距离</span></span><br><span class="line">    <span class="attr">nameRotate</span>: <span class="number">10</span>,    <span class="comment">// 坐标轴名字旋转，角度值</span></span><br><span class="line">    <span class="attr">inverse</span>: <span class="literal">false</span>,    <span class="comment">// 是否是反向坐标轴</span></span><br><span class="line">    <span class="attr">nameTextStyle</span>: &#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span>,     <span class="comment">// 坐标轴名称的颜色</span></span><br><span class="line">        <span class="attr">fontStyle</span>: <span class="string">&#x27;normal&#x27;</span>,    <span class="comment">// 文字字体的风格（&#x27;normal&#x27;，无样式；&#x27;italic&#x27;，斜体；&#x27;oblique&#x27;，倾斜字体） </span></span><br><span class="line">        <span class="attr">fontWeight</span>: <span class="string">&#x27;normal&#x27;</span>,    <span class="comment">// 文字字体的粗细（&#x27;normal&#x27;，无样式；&#x27;bold&#x27;，加粗；&#x27;bolder&#x27;，加粗的基础上再加粗；&#x27;lighter&#x27;，变细；数字定义粗细也可以，取值范围100至700）</span></span><br><span class="line">        <span class="attr">fontSize</span>: <span class="string">&#x27;20&#x27;</span>,    <span class="comment">// 文字字体大小</span></span><br><span class="line">        <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,     <span class="comment">// 文字水平对齐方式，默认自动（&#x27;left&#x27;，&#x27;center&#x27;，&#x27;right&#x27;）</span></span><br><span class="line">        <span class="attr">verticalAlign</span>: <span class="string">&#x27;left&#x27;</span>,    <span class="comment">// 文字垂直对齐方式，默认自动（&#x27;top&#x27;，&#x27;middle&#x27;，&#x27;bottom&#x27;</span></span><br><span class="line">        <span class="attr">lineHeight</span>: <span class="string">&#x27;50&#x27;</span>,    <span class="comment">// 行高 ）</span></span><br><span class="line">        <span class="attr">backgroundColor</span>: <span class="string">&#x27;red&#x27;</span>,    <span class="comment">// 文字块背景色，例：&#x27;#123234&#x27;, &#x27;red&#x27;, &#x27;rgba(0,23,11,0.3)&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">axisLine</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>,    <span class="comment">// 是否显示坐标轴轴线</span></span><br><span class="line">        <span class="attr">symbol</span>: [<span class="string">&#x27;none&#x27;</span>, <span class="string">&#x27;arrow&#x27;</span>],     <span class="comment">// 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头</span></span><br><span class="line">        <span class="attr">symbolSize</span>: [<span class="number">10</span>, <span class="number">15</span>],     <span class="comment">// 轴线两端箭头大小，数值一表示宽度，数值二表示高度</span></span><br><span class="line">        <span class="attr">lineStyle</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span>,    <span class="comment">// 坐标轴线线的颜色</span></span><br><span class="line">            <span class="attr">width</span>: <span class="string">&#x27;5&#x27;</span>,    <span class="comment">// 坐标轴线线宽</span></span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;solid&#x27;</span>,     <span class="comment">// 坐标轴线线的类型（&#x27;solid&#x27;，实线类型；&#x27;dashed&#x27;，虚线类型；&#x27;dotted&#x27;,点状类型）</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">axisTick</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>,    <span class="comment">// 是否显示坐标轴刻度</span></span><br><span class="line">        <span class="attr">inside</span>: <span class="literal">true</span>,     <span class="comment">// 坐标轴刻度是否朝内，默认朝外</span></span><br><span class="line">        <span class="attr">length</span>: <span class="number">5</span>,    <span class="comment">// 坐标轴刻度的长度</span></span><br><span class="line">        <span class="attr">lineStyle</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#FFF&#x27;</span>,     <span class="comment">// 刻度线的颜色</span></span><br><span class="line">            <span class="attr">width</span>: <span class="number">10</span>,    <span class="comment">// 坐标轴刻度线宽</span></span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;solid&#x27;</span>,     <span class="comment">// 坐标轴线线的类型（&#x27;solid&#x27;，实线类型；&#x27;dashed&#x27;，虚线类型；&#x27;dotted&#x27;,点状类型）</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">axisLabel</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>,     <span class="comment">// 是否显示刻度标签</span></span><br><span class="line">        <span class="attr">interval</span>: <span class="string">&#x27;0&#x27;</span>,    <span class="comment">// 坐标轴刻度标签的显示间隔，在类目轴中有效.0显示所有</span></span><br><span class="line">        <span class="attr">inside</span>: <span class="literal">true</span>,    <span class="comment">// 刻度标签是否朝内，默认朝外</span></span><br><span class="line">        <span class="attr">rotate</span>: <span class="number">90</span>,    <span class="comment">// 刻度标签旋转的角度，在类目轴的类目标签显示不下的时候可以通过旋转防止标签之间重叠；旋转的角度从 -90 度到 90 度</span></span><br><span class="line">        <span class="attr">margin</span>: <span class="number">10</span>,    <span class="comment">// 刻度标签与轴线之间的距离</span></span><br><span class="line">        <span class="comment">// formatter 刻度标签的内容格式器，支持字符串模板和回调函数两种形式</span></span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#FFF&#x27;</span>,     <span class="comment">// 刻度标签文字的颜色</span></span><br><span class="line">        <span class="attr">fontStyle</span>: <span class="string">&#x27;normal&#x27;</span>,    <span class="comment">// 文字字体的风格（&#x27;normal&#x27;，无样式；&#x27;italic&#x27;，斜体；&#x27;oblique&#x27;，倾斜字体） </span></span><br><span class="line">        <span class="attr">fontWeight</span>: <span class="string">&#x27;normal&#x27;</span>,    <span class="comment">// 文字字体的粗细（&#x27;normal&#x27;，无样式；&#x27;bold&#x27;，加粗；&#x27;bolder&#x27;，加粗的基础上再加粗；&#x27;lighter&#x27;，变细；数字定义粗细也可以，取值范围100至700）</span></span><br><span class="line">        <span class="attr">fontSize</span>: <span class="string">&#x27;20&#x27;</span>,    <span class="comment">// 文字字体大小</span></span><br><span class="line">        <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,     <span class="comment">// 文字水平对齐方式，默认自动（&#x27;left&#x27;，&#x27;center&#x27;，&#x27;right&#x27;）</span></span><br><span class="line">        <span class="attr">verticalAlign</span>: <span class="string">&#x27;left&#x27;</span>,    <span class="comment">// 文字垂直对齐方式，默认自动（&#x27;top&#x27;，&#x27;middle&#x27;，&#x27;bottom&#x27;</span></span><br><span class="line">        <span class="attr">lineHeight</span>: <span class="string">&#x27;50&#x27;</span>,    <span class="comment">// 行高 ）</span></span><br><span class="line">        <span class="attr">backgroundColor</span>: <span class="string">&#x27;red&#x27;</span>,    <span class="comment">// 文字块背景色，例：&#x27;#123234&#x27;, &#x27;red&#x27;, &#x27;rgba(0,23,11,0.3)&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">splitLine</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>,    <span class="comment">// 是否显示分隔线。默认数值轴显示，类目轴不显示</span></span><br><span class="line">        <span class="attr">interval</span>: <span class="string">&#x27;0&#x27;</span>,    <span class="comment">// 坐标轴刻度标签的显示间隔，在类目轴中有效.0显示所有</span></span><br><span class="line">        <span class="attr">color</span>: [<span class="string">&#x27;#ccc&#x27;</span>],    <span class="comment">// 分隔线颜色，可以设置成单个颜色，也可以设置成颜色数组，分隔线会按数组中颜色的顺序依次循环设置颜色</span></span><br><span class="line">        <span class="attr">width</span>: <span class="number">3</span>,    <span class="comment">// 分隔线线宽</span></span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;solid&#x27;</span>,     <span class="comment">// 坐标轴线线的类型（&#x27;solid&#x27;，实线类型；&#x27;dashed&#x27;，虚线类型；&#x27;dotted&#x27;,点状类型）</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">splitArea</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>,    <span class="comment">// 是否显示分隔区域</span></span><br><span class="line">        <span class="attr">interval</span>: <span class="string">&#x27;0&#x27;</span>,    <span class="comment">// 坐标轴刻度标签的显示间隔，在类目轴中有效.0显示所有</span></span><br><span class="line">        <span class="attr">areaStyle</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: [<span class="string">&#x27;rgba(250,250,250,0.3)&#x27;</span>,<span class="string">&#x27;rgba(200,200,200,0.3)&#x27;</span>],    <span class="comment">// 分隔区域颜色。分隔区域会按数组中颜色的顺序依次循环设置颜色。默认是一个深浅的间隔色</span></span><br><span class="line">            <span class="attr">opacity</span>: <span class="number">1</span>,    <span class="comment">// 图形透明度。支持从 0 到 1 的数字，为 0 时不绘制该图形</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">textStyle</span>: &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;#FFF&#x27;</span>,     <span class="comment">// 文字的颜色</span></span><br><span class="line">            <span class="attr">fontStyle</span>: <span class="string">&#x27;normal&#x27;</span>,    <span class="comment">// 文字字体的风格（&#x27;normal&#x27;，无样式；&#x27;italic&#x27;，斜体；&#x27;oblique&#x27;，倾斜字体） </span></span><br><span class="line">            <span class="attr">fontWeight</span>: <span class="string">&#x27;normal&#x27;</span>,    <span class="comment">// 文字字体的粗细（&#x27;normal&#x27;，无样式；&#x27;bold&#x27;，加粗；&#x27;bolder&#x27;，加粗的基础上再加粗；&#x27;lighter&#x27;，变细；数字定义粗细也可以，取值范围100至700）</span></span><br><span class="line">            <span class="attr">fontSize</span>: <span class="string">&#x27;20&#x27;</span>,    <span class="comment">// 文字字体大小</span></span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,     <span class="comment">// 文字水平对齐方式，默认自动（&#x27;left&#x27;，&#x27;center&#x27;，&#x27;right&#x27;）</span></span><br><span class="line">            <span class="attr">verticalAlign</span>: <span class="string">&#x27;left&#x27;</span>,    <span class="comment">// 文字垂直对齐方式，默认自动（&#x27;top&#x27;，&#x27;middle&#x27;，&#x27;bottom&#x27;</span></span><br><span class="line">            <span class="attr">lineHeight</span>: <span class="string">&#x27;50&#x27;</span>,    <span class="comment">// 行高 ）</span></span><br><span class="line">            <span class="attr">backgroundColor</span>: <span class="string">&#x27;red&#x27;</span>,    <span class="comment">// 文字块背景色，例：&#x27;#123234&#x27;, &#x27;red&#x27;, &#x27;rgba(0,23,11,0.3)&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;l</summary>
      
    
    
    
    <category term="Echarts" scheme="https://hisai3.github.io/hisai3.github.io/categories/Echarts/"/>
    
    
    <category term="Echarts" scheme="https://hisai3.github.io/hisai3.github.io/tags/Echarts/"/>
    
  </entry>
  
  <entry>
    <title>client,screen,page,offset的区别</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/client,screen,page,offset%E7%9A%84%E5%8C%BA%E5%88%AB%20/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/client,screen,page,offset%E7%9A%84%E5%8C%BA%E5%88%AB%20/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T07:40:23.198Z</updated>
    
    <content type="html"><![CDATA[<h4 id="offsetX-clientX-pageX-screenX"><a href="#offsetX-clientX-pageX-screenX" class="headerlink" title="offsetX, clientX, pageX, screenX"></a>offsetX, clientX, pageX, screenX</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        * &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">5000px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: chocolate;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;body&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>bb<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 如果没有滚动条 三个都一样</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// client 以页面的可视区域为参照 跟滚动条没关系</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// offset 以页面的当前点击元素的内容(content + padding)为参照</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// page 以页面的html为参照</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// screen 以电脑屏幕为参照</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;e--&gt;&gt;&gt;&gt;&#x27;</span>, e.<span class="property">pageY</span>, e.<span class="property">offsetY</span>, e.<span class="property">clientY</span>, e.<span class="property">screenY</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>图解</strong><br><img src="https://gitee.com/hisai/image-bed/raw/master/offsetX.png" alt="offsetX"></p>]]></content>
    
    
    <summary type="html">client,screen,page,offset的区别</summary>
    
    
    
    <category term="随记" scheme="https://hisai3.github.io/hisai3.github.io/categories/%E9%9A%8F%E8%AE%B0/"/>
    
    
    <category term="html" scheme="https://hisai3.github.io/hisai3.github.io/tags/html/"/>
    
  </entry>
  
  <entry>
    <title>css实现table表头和列固定功能</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/css%E5%AE%9E%E7%8E%B0table%E8%A1%A8%E5%A4%B4%E5%92%8C%E5%88%97%E5%9B%BA%E5%AE%9A%E5%8A%9F%E8%83%BD/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/css%E5%AE%9E%E7%8E%B0table%E8%A1%A8%E5%A4%B4%E5%92%8C%E5%88%97%E5%9B%BA%E5%AE%9A%E5%8A%9F%E8%83%BD/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T06:39:10.680Z</updated>
    
    <content type="html"><![CDATA[<p>核心 <code>position: sticky;</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.table</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">overflow</span>:auto;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>:<span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>:<span class="number">300px</span>; <span class="comment">/* 固定高度 */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-collapse</span>:separate;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">table-layout</span>: fixed;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/* 固定寬度 */</span></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">td</span>, <span class="selector-tag">th</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-right</span> :<span class="number">1px</span> solid <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border-bottom</span> :<span class="number">1px</span> solid <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">      <span class="comment">/* 单元格宽高 */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>:<span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">th</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>:lightblue;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 控制左边固定的核心代码 */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">td</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>),</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">th</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>:sticky;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">left</span>:<span class="number">0</span>; <span class="comment">/* 首行在左 */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">z-index</span>:<span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>:lightpink;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">td</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>),</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">th</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>:sticky;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">left</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">z-index</span>:<span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>:lightpink;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 控制表头固定的核心代码 */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">thead</span> <span class="selector-tag">tr</span> <span class="selector-tag">th</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>:sticky;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">top</span>:<span class="number">0</span>; <span class="comment">/* 第一列最上 */</span></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">th</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>),</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">th</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">z-index</span>:<span class="number">2</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>:lightblue;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;table&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头3<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头4<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头5<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>我的高度不固定我的高度不固定我的高度不固定我的高度不固定我的高度不固定我的高度不固定<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">css实现table表头和列固定功能</summary>
    
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/categories/css/"/>
    
    
    <category term="css" scheme="https://hisai3.github.io/hisai3.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>drag指令</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/drag%E6%8C%87%E4%BB%A4/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/drag%E6%8C%87%E4%BB%A4/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T06:50:47.398Z</updated>
    
    <content type="html"><![CDATA[<h5 id="方式一："><a href="#方式一：" class="headerlink" title="方式一："></a>方式一：</h5><p><strong>项目实际使用</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">directives</span>: &#123;</span><br><span class="line">    <span class="attr">drag</span>: &#123;</span><br><span class="line">        <span class="comment">// 指令的定义</span></span><br><span class="line">        <span class="attr">bind</span>: <span class="function"><span class="params">el</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> selector = binding.<span class="property">value</span></span><br><span class="line">            <span class="keyword">const</span> draggable = el.<span class="title function_">getAttribute</span>(<span class="string">&#x27;draggable&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> (draggable !== <span class="string">&#x27;true&#x27;</span>) <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">const</span> id = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">const</span> dragEl = selector ? <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(selector) : el</span><br><span class="line">              el.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;default&#x27;</span></span><br><span class="line">              el.<span class="property">onmousedown</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> rect = dragEl.<span class="title function_">getBoundingClientRect</span>()</span><br><span class="line">                <span class="comment">// el-diaglog 使用了transform 居中</span></span><br><span class="line">                <span class="keyword">const</span> minTop = selector.<span class="title function_">includes</span>(<span class="string">&#x27;el-dialog&#x27;</span>) ? <span class="number">40</span> + rect.<span class="property">height</span> / <span class="number">2</span> : <span class="number">0</span></span><br><span class="line">                <span class="keyword">const</span> disX = e.<span class="property">clientX</span> - dragEl.<span class="property">offsetLeft</span></span><br><span class="line">                <span class="keyword">const</span> disY = e.<span class="property">clientY</span> - dragEl.<span class="property">offsetTop</span></span><br><span class="line">                <span class="variable language_">document</span>.<span class="property">onmousemove</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                  <span class="keyword">const</span> left = e.<span class="property">clientX</span> - disX</span><br><span class="line">                  <span class="keyword">const</span> top = (e.<span class="property">clientY</span> - disY)</span><br><span class="line">                  dragEl.<span class="property">style</span>.<span class="property">left</span> = left + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">                  dragEl.<span class="property">style</span>.<span class="property">top</span> = <span class="string">`<span class="subst">$&#123;(minTop &amp;&amp; top &lt;= minTop) ? minTop : top&#125;</span>px`</span></span><br><span class="line">                  dragEl.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;absolute&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">document</span>.<span class="property">onmouseup</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                  <span class="variable language_">document</span>.<span class="property">onmousemove</span> = <span class="literal">null</span></span><br><span class="line">                  <span class="variable language_">document</span>.<span class="property">onmouseup</span> = <span class="literal">null</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="built_in">clearTimeout</span>(id)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v-drag 最好是放在自定义的header上，这样只有拖动头部才能移动<br><strong>注意：</strong><br>v-drag: 当前使用元素即为<strong>拖拽触发元素</strong><br>v-drag的value: 是<code>css selector</code> <strong>被拖拽移动的元素</strong>, 没有值即为当前拖拽触发元素<br>draggable: true: 可拖拽 false: 不可拖拽</p><p><strong>然后直接在需要拖拽的dialog上使用v-drag属性</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">title</span>=<span class="string">&quot;dialog&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">&quot;900px&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-drag</span>=<span class="string">&quot;.el-dialog&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    &lt;.../&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="方式二："><a href="#方式二：" class="headerlink" title="方式二："></a>方式二：</h5><p><strong>（未验证）</strong><br>这里<strong>注意</strong>，因为拖拽的坐标都是直接按px计算的，所以如果dialog宽度使用百分比，拖拽时会导致dialog发生<strong>变形</strong>，需要使用固定宽度</p><p>下面还有一个全局配置<code>dialog</code>拖拽的方式，推荐使用以下方法:<br>建立directives.js文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// v-dialogDrag: 弹窗拖拽属性</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&#x27;drag&#x27;</span>, &#123;</span><br><span class="line">  <span class="title function_">bind</span>(<span class="params">el, binding, vnode, oldVnode</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> dialogHeaderEl = el.<span class="title function_">querySelector</span>(<span class="string">&#x27;.el-dialog__header&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> dragDom = el.<span class="title function_">querySelector</span>(<span class="string">&#x27;.el-dialog&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    dialogHeaderEl.<span class="property">style</span>.<span class="property">cssText</span> += <span class="string">&#x27;;cursor:move;&#x27;</span></span><br><span class="line">    dragDom.<span class="property">style</span>.<span class="property">cssText</span> += <span class="string">&#x27;;top:0px;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取原有属性 ie dom元素.currentStyle 火狐谷歌 window.getComputedStyle(dom元素, null);</span></span><br><span class="line">    <span class="keyword">const</span> sty = (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">document</span>.<span class="property">currentStyle</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">dom, attr</span>) =&gt;</span> dom.<span class="property">currentStyle</span>[attr];</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">dom, attr</span>) =&gt;</span> <span class="title function_">getComputedStyle</span>(dom, <span class="literal">false</span>)[attr];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)()</span><br><span class="line"></span><br><span class="line">    dialogHeaderEl.<span class="property">onmousedown</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 鼠标按下，计算当前元素距离可视区的距离</span></span><br><span class="line">      <span class="keyword">const</span> disX = e.<span class="property">clientX</span> - dialogHeaderEl.<span class="property">offsetLeft</span>;</span><br><span class="line">      <span class="keyword">const</span> disY = e.<span class="property">clientY</span> - dialogHeaderEl.<span class="property">offsetTop</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> screenWidth = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>; <span class="comment">// body当前宽度</span></span><br><span class="line">      <span class="keyword">const</span> screenHeight = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>; <span class="comment">// 可见区域高度(应为body高度，可某些环境下无法获取)</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> dragDomWidth = dragDom.<span class="property">offsetWidth</span>; <span class="comment">// 对话框宽度</span></span><br><span class="line">      <span class="keyword">const</span> dragDomheight = dragDom.<span class="property">offsetHeight</span>; <span class="comment">// 对话框高度</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> minDragDomLeft = dragDom.<span class="property">offsetLeft</span>;</span><br><span class="line">      <span class="keyword">const</span> maxDragDomLeft = screenWidth - dragDom.<span class="property">offsetLeft</span> - dragDomWidth;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> minDragDomTop = dragDom.<span class="property">offsetTop</span>;</span><br><span class="line">      <span class="keyword">const</span> maxDragDomTop = screenHeight - dragDom.<span class="property">offsetTop</span> - dragDomheight;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 获取到的值带px 正则匹配替换</span></span><br><span class="line">      <span class="keyword">let</span> styL = <span class="title function_">sty</span>(dragDom, <span class="string">&#x27;left&#x27;</span>);</span><br><span class="line">      <span class="keyword">let</span> styT = <span class="title function_">sty</span>(dragDom, <span class="string">&#x27;top&#x27;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 注意在ie中 第一次获取到的值为组件自带50% 移动之后赋值为px</span></span><br><span class="line">      <span class="keyword">if</span> (styL.<span class="title function_">includes</span>(<span class="string">&#x27;%&#x27;</span>)) &#123;</span><br><span class="line">        styL = +<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> * (+styL.<span class="title function_">replace</span>(<span class="regexp">/\%/g</span>, <span class="string">&#x27;&#x27;</span>) / <span class="number">100</span>);</span><br><span class="line">        styT = +<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span> * (+styT.<span class="title function_">replace</span>(<span class="regexp">/\%/g</span>, <span class="string">&#x27;&#x27;</span>) / <span class="number">100</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        styL = +styL.<span class="title function_">replace</span>(<span class="regexp">/\px/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        styT = +styT.<span class="title function_">replace</span>(<span class="regexp">/\px/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">onmousemove</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// 通过事件委托，计算移动的距离</span></span><br><span class="line">        <span class="keyword">let</span> left = e.<span class="property">clientX</span> - disX;</span><br><span class="line">        <span class="keyword">let</span> top = e.<span class="property">clientY</span> - disY;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 边界处理</span></span><br><span class="line">        <span class="keyword">if</span> (-(left) &gt; minDragDomLeft) &#123;</span><br><span class="line">          left = -(minDragDomLeft);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (left &gt; maxDragDomLeft) &#123;</span><br><span class="line">          left = maxDragDomLeft;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (-(top) &gt; minDragDomTop) &#123;</span><br><span class="line">          top = -(minDragDomTop);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (top &gt; maxDragDomTop) &#123;</span><br><span class="line">          top = maxDragDomTop;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 移动当前元素</span></span><br><span class="line">        dragDom.<span class="property">style</span>.<span class="property">cssText</span> += <span class="string">`;left:<span class="subst">$&#123;left + styL&#125;</span>px;top:<span class="subst">$&#123;top + styT&#125;</span>px;`</span>;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">onmouseup</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmousemove</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">onmouseup</span> = <span class="literal">null</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>main.js内引入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./directives&#x27;</span></span><br></pre></td></tr></table></figure><p>在需要使用的地方，直接使用v-drag属性即可</p><pre><code class="html">&lt;el-dialog title=&quot;dialog&quot;           :visible.sync=&quot;dialogVisible&quot;           v-drag&gt;    &lt;.../&gt;&lt;/el-dialog&gt;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h5 id=&quot;方式一：&quot;&gt;&lt;a href=&quot;#方式一：&quot; class=&quot;headerlink&quot; title=&quot;方式一：&quot;&gt;&lt;/a&gt;方式一：&lt;/h5&gt;&lt;p&gt;&lt;strong&gt;项目实际使用&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;tabl</summary>
      
    
    
    
    
    <category term="Vue指令" scheme="https://hisai3.github.io/hisai3.github.io/tags/Vue%E6%8C%87%E4%BB%A4/"/>
    
    <category term="drag" scheme="https://hisai3.github.io/hisai3.github.io/tags/drag/"/>
    
  </entry>
  
  <entry>
    <title>el-table 合并单元格</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/el-table%20%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/el-table%20%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-02-27T06:35:15.281Z</updated>
    
    <content type="html"><![CDATA[<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><blockquote><ul><li>以需要合并的列属性为<code>key</code>, 用<code>children</code>收集, <code>children.length</code>即需要合并的行数, </li><li>如要将grade(层级), class(类型)两列相同值的行合并：</li><li>组装第一次结果 <code>&#123;key: grade, children: [&#123; grade: 1, name: &#39;AA&#39; &#125;, &#123; grade: 1, name: &#39;BB&#39; &#125;]&#125;</code></li><li>组装第二次结果 <code>&#123;key: grade,class, children: [&#123; grade: 1, class: 1, name: &#39;AA&#39; &#125;, &#123; grade: 1, class: 1, name: &#39;BB&#39; &#125;]&#125;</code></li><li>重复组装直到最后…</li><li>最后根据组装结果给原<code>table</code>每行数据添加<code>属性_merge: &#123;rowspan: children.length, colspan: 1&#125;</code>, 返回<code>table</code>数据</li></ul></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">    colArr,</span></span><br><span class="line"><span class="params">    list</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> allProps = [];</span><br><span class="line">    colArr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">props, index</span>) =&gt;</span> &#123;</span><br><span class="line">        allProps.<span class="title function_">push</span>(...props);</span><br><span class="line">        list = <span class="title function_">getLevel</span>(props, allProps, list);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//组装层</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getLevel</span>(<span class="params">props, allProps, list</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> rowKey = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> list) &#123;</span><br><span class="line">        <span class="keyword">let</span> propInfo = <span class="title function_">getPropStr</span>(allProps, item);</span><br><span class="line">        <span class="keyword">if</span> (rowKey[propInfo.<span class="property">key</span>]) &#123;</span><br><span class="line">            rowKey[propInfo.<span class="property">key</span>].<span class="property">children</span>.<span class="title function_">push</span>(item);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> obj = propInfo;</span><br><span class="line">            obj.<span class="property">children</span> = [item];</span><br><span class="line">            rowKey[propInfo.<span class="property">key</span>] = obj;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;propStr.toString()--&gt;&gt;&gt;&gt;&#x27;</span>, rowKey)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> info = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> rowKey) &#123;</span><br><span class="line">        rowKey[key].<span class="property">children</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">                item = <span class="title class_">Object</span>.<span class="title function_">assign</span>(</span><br><span class="line">                    item,</span><br><span class="line">                    <span class="title function_">getMergeInfo</span>(props, rowKey[key].<span class="property">children</span>.<span class="property">length</span>)</span><br><span class="line">                );</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                item = <span class="title class_">Object</span>.<span class="title function_">assign</span>(item, <span class="title function_">getMergeInfo</span>(props, <span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            info.<span class="title function_">push</span>(item);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> info;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获取合并信息</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getMergeInfo</span>(<span class="params">props, num</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">    props.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        obj[item + <span class="string">&quot;_merge&quot;</span>] = &#123;</span><br><span class="line">            <span class="attr">rowspan</span>: num,</span><br><span class="line">            <span class="attr">colspan</span>: <span class="number">1</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">RandomId</span> = len =&gt; <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>(<span class="number">36</span>).<span class="title function_">substr</span>(<span class="number">3</span>, len);</span><br><span class="line"><span class="comment">// 把属性的值拼接在⼀起,并和属性的值⼀起返回。</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getPropStr</span>(<span class="params">props, info</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">    <span class="keyword">let</span> propStr = props.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        obj[item] = info[item];</span><br><span class="line">        <span class="keyword">return</span> info[item] !== <span class="number">0</span> &amp;&amp; !info[item] ? <span class="title class_">RandomId</span>(<span class="number">8</span>) : info[item];</span><br><span class="line">    &#125;);</span><br><span class="line">    obj.<span class="property">key</span> = propStr.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// span-method合并函数：</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">objectSpanMethod</span>(<span class="params">&#123; row, column, rowIndex, columnIndex &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (row[column.<span class="property">property</span> + <span class="string">&quot;_merge&quot;</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> row[column.<span class="property">property</span> + <span class="string">&quot;_merge&quot;</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">rowspan</span>: <span class="number">1</span>, <span class="attr">colspan</span>: <span class="number">1</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// var colArr = [[&quot;id&quot;, &quot;grade&quot;], [&quot;class&quot;]];</span></span><br><span class="line"><span class="keyword">var</span> colArr = [[<span class="string">&quot;id&quot;</span>], [<span class="string">&quot;grade&quot;</span>], [<span class="string">&quot;class&quot;</span>]];</span><br><span class="line"><span class="keyword">var</span> list = [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">grade</span>: <span class="number">1</span>, <span class="attr">class</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">grade</span>: <span class="number">1</span>, <span class="attr">class</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;李四&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">grade</span>: <span class="number">1</span>, <span class="attr">class</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;王五&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">grade</span>: <span class="number">1</span>, <span class="attr">class</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;找六&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">grade</span>: <span class="number">2</span>, <span class="attr">class</span>: <span class="number">7</span>, <span class="attr">name</span>: <span class="string">&quot;张三_1&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">grade</span>: <span class="number">2</span>, <span class="attr">class</span>: <span class="number">7</span>, <span class="attr">name</span>: <span class="string">&quot;李四_1&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">grade</span>: <span class="number">2</span>, <span class="attr">class</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&quot;王五_1&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">grade</span>: <span class="number">2</span>, <span class="attr">class</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&quot;找六_1&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">grade</span>: <span class="number">2</span>, <span class="attr">class</span>: <span class="literal">null</span>, <span class="attr">name</span>: <span class="string">&quot;null1&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">grade</span>: <span class="number">2</span>, <span class="attr">class</span>: <span class="literal">null</span>, <span class="attr">name</span>: <span class="string">&quot;null2&quot;</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">tableDate</span> = <span class="title function_">merge</span>(colArr, list)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">tableDate</span>);</span><br><span class="line"><span class="comment">// 单行结果</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   &quot;id&quot;: 1,</span></span><br><span class="line"><span class="comment">//   &quot;grade&quot;: 1,</span></span><br><span class="line"><span class="comment">//   &quot;class&quot;: 1,</span></span><br><span class="line"><span class="comment">//   &quot;name&quot;: &quot;张三&quot;,</span></span><br><span class="line"><span class="comment">//   &quot;id_merge&quot;: &#123;</span></span><br><span class="line"><span class="comment">//     &quot;rowspan&quot;: 4,</span></span><br><span class="line"><span class="comment">//     &quot;colspan&quot;: 1</span></span><br><span class="line"><span class="comment">//   &#125;,</span></span><br><span class="line"><span class="comment">//   &quot;grade_merge&quot;: &#123;</span></span><br><span class="line"><span class="comment">//     &quot;rowspan&quot;: 4,</span></span><br><span class="line"><span class="comment">//     &quot;colspan&quot;: 1</span></span><br><span class="line"><span class="comment">//   &#125;,</span></span><br><span class="line"><span class="comment">//   &quot;class_merge&quot;: &#123;</span></span><br><span class="line"><span class="comment">//     &quot;rowspan&quot;: 2,</span></span><br><span class="line"><span class="comment">//     &quot;colspan&quot;: 1</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><p class="codepen" data-height="300" data-default-tab="result" data-slug-hash="MWqbvLG" data-editable="true" data-user="hisai3" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/hisai3/pen/MWqbvLG">  el-table 合并行</a> by hisai3 (<a href="https://codepen.io/hisai3">@hisai3</a>)  on <a href="https://codepen.io">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>]]></content>
    
    
    <summary type="html">el-table 合并行计算</summary>
    
    
    
    <category term="Vue UI" scheme="https://hisai3.github.io/hisai3.github.io/categories/Vue-UI/"/>
    
    
    <category term="element UI" scheme="https://hisai3.github.io/hisai3.github.io/tags/element-UI/"/>
    
    <category term="el-table" scheme="https://hisai3.github.io/hisai3.github.io/tags/el-table/"/>
    
  </entry>
  
  <entry>
    <title>el-table 合计行放在首行</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/el-table%20%E5%90%88%E8%AE%A1%E8%A1%8C%E6%94%BE%E5%9C%A8%E9%A6%96%E8%A1%8C/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/el-table%20%E5%90%88%E8%AE%A1%E8%A1%8C%E6%94%BE%E5%9C%A8%E9%A6%96%E8%A1%8C/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-02-01T01:10:18.454Z</updated>
    
    <content type="html"><![CDATA[<h4 id="el-table-合计行放在首行"><a href="#el-table-合计行放在首行" class="headerlink" title="el-table 合计行放在首行"></a>el-table 合计行放在首行</h4><p>添加以下两行CSS，即可将合计行放在第一行：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* /deep/ 为深度操作符，可以穿透到子组件 */</span></span><br><span class="line">/deep/ <span class="selector-class">.el-table</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* order默认值为0，只需将表体order置为1即可移到最后，这样合计行就上移到表体上方 */</span></span><br><span class="line">/deep/ <span class="selector-class">.el-table__body-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">order</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意表格不要设置 fixed 属性，会有样式冲突。如果确实要启用 </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*fixed 属性，需再添加以下两行CSS作为补偿修复：*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*表格启用 fixed 属性后，样式会错乱，下面2句是补偿修复*/</span></span><br><span class="line">/deep/ <span class="selector-class">.el-table__fixed-body-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">96px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">/deep/ <span class="selector-class">.el-table__fixed-footer-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 合计行点击事件</span></span><br><span class="line"><span class="keyword">let</span> self = <span class="variable language_">this</span>;</span><br><span class="line"><span class="keyword">let</span> table = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.el-table__footer-wrapper&gt;table&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">this</span>.$nextTick(<span class="function">()=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    table.<span class="property">rows</span>[<span class="number">0</span>].<span class="property">cells</span>[<span class="number">7</span>].<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">        self.<span class="property">outLog</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">el-table 合计行放在首行</summary>
    
    
    
    <category term="Vue UI" scheme="https://hisai3.github.io/hisai3.github.io/categories/Vue-UI/"/>
    
    
    <category term="element UI" scheme="https://hisai3.github.io/hisai3.github.io/tags/element-UI/"/>
    
    <category term="el-table" scheme="https://hisai3.github.io/hisai3.github.io/tags/el-table/"/>
    
  </entry>
  
  <entry>
    <title>electron-vue</title>
    <link href="https://hisai3.github.io/hisai3.github.io/2023/01/14/electron-vue/"/>
    <id>https://hisai3.github.io/hisai3.github.io/2023/01/14/electron-vue/</id>
    <published>2023-01-14T06:31:31.000Z</published>
    <updated>2023-01-15T06:46:13.999Z</updated>
    
    <content type="html"><![CDATA[<h3 id="首次运行报错"><a href="#首次运行报错" class="headerlink" title="首次运行报错"></a>首次运行报错</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Html Webpack Plugin:</span><br><span class="line">  ReferenceError: process is not defined</span><br><span class="line">  </span><br><span class="line">  - index.ejs:11 eval</span><br><span class="line">    [.]/[_html-webpack-plugin@3.2.0@html-webpack-plugin]/lib/loader.js!./src/index.ejs:11:2</span><br><span class="line">  </span><br><span class="line">  - index.ejs:16 module.exports</span><br><span class="line">    [.]/[_html-webpack-plugin@3.2.0@html-webpack-plugin]/lib/loader.js!./src/index.ejs:16:3</span><br><span class="line">  </span><br><span class="line">  - index.js:284 </span><br><span class="line">    [Electron-Vue]/[_html-webpack-plugin@3.2.0@html-webpack-plugin]/index.js:284:18</span><br><span class="line">  </span><br><span class="line">  - task_queues.js:97 processTicksAndRejections</span><br><span class="line">    internal/process/task_queues.js:97:5</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">new HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: &#x27;index.html&#x27;,</span><br><span class="line">      template: path.resolve(__dirname, &#x27;../src/index.ejs&#x27;),</span><br><span class="line">      templateParameters(compilation, assets, options) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          compilation: compilation,</span><br><span class="line">          webpack: compilation.getStats().toJson(),</span><br><span class="line">          webpackConfig: compilation.options,</span><br><span class="line">          htmlWebpackPlugin: &#123;</span><br><span class="line">            files: assets,</span><br><span class="line">            options: options</span><br><span class="line">          &#125;,</span><br><span class="line">          process,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeAttributeQuotes: true,</span><br><span class="line">        removeComments: true</span><br><span class="line">      &#125;,</span><br><span class="line">      nodeModules: false</span><br><span class="line">    &#125;),</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">electron 首次运行报错</summary>
    
    
    
    
    <category term="乱七八糟" scheme="https://hisai3.github.io/hisai3.github.io/tags/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F/"/>
    
  </entry>
  
</feed>
